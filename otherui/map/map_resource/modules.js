/**/﻿_jsload&&_jsload('glcommon', 'function aT(e,i){this.origin=e||null;this.direction=i||null}C.extend(aT.prototype,{set:function(e,i){this.origin=e;this.direction=i}});cb.Ray=aT;function eQ(hS,e,hY){hY=hY||{};var i=hY.filter||hS.LINEAR;var hW=hY.format||hS.RGBA;var hV=hY.type||hS.UNSIGNED_BYTE;var T=hY.wrap||hS.CLAMP_TO_EDGE;var hR=hY.mipmap||false;var hT=hY.testError||false;var hQ=hY.unpackAlpha||false;var hX;if(typeof hY.flipY!=="boolean"){hX=true}else{hX=hY.flipY}var hU=hS.createTexture();hS.bindTexture(hS.TEXTURE_2D,hU);hS.pixelStorei(hS.UNPACK_FLIP_Y_WEBGL,hX);if(hQ){hS.pixelStorei(hS.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true)}hS.texParameteri(hS.TEXTURE_2D,hS.TEXTURE_WRAP_S,T);hS.texParameteri(hS.TEXTURE_2D,hS.TEXTURE_WRAP_T,T);hS.texParameteri(hS.TEXTURE_2D,hS.TEXTURE_MAG_FILTER,i);hS.texParameteri(hS.TEXTURE_2D,hS.TEXTURE_MIN_FILTER,hR?hS.LINEAR_MIPMAP_LINEAR:i);if(e===null){hS.texImage2D(hS.TEXTURE_2D,0,hW,hY.width,hY.height,0,hW,hV,null)}else{hS.texImage2D(hS.TEXTURE_2D,0,hW,hW,hV,e)}if(hR){hS.generateMipmap(hS.TEXTURE_2D)}if(hT===true){if(hS.getError()===hS.INVALID_VALUE){return null}}return hU}cb.utils={createTexture:eQ};function bO(i,e){this._gl=i;e=e||{};this._ids={};this._count=0;this._width=e.width||4096;this._height=e.height||4096;this._name=e.name||"";this._textureType=e.textureType||i.UNSIGNED_BYTE;this._unpackAlpha=e.unpackAlpha||false;this._texture=null;this._currentOffsetY=0;this._currentX=0;this._nextX=0;this._usage=0;this.guid=bo.getGUID("texture_atlas_");this.isRendering=false;this._textTextureCache=[];if(e.init===true){this.initTexture()}}C.extend(bO.prototype,{initTexture:function(){var e=this._gl;this._texture=cb.utils.createTexture(e,null,{type:this._textureType,width:this._width,height:this._height,unpackAlpha:this._unpackAlpha})},getTexture:function(){if(!this._texture){this.initTexture()}return this._texture},getSize:function(){return new d9(this._width,this._height)},addTexture:function(i,e){if(i.id&&this._ids[i.id]){return this._ids[i.id]}if(!this._texture){this.initTexture()}e=e||i.height;var hS=this._height-i.height-this._currentOffsetY;if(hS<0){this._currentX=this._nextX;this._currentOffsetY=0;hS=this._height-i.height;if(this._currentX>=this._width){return null}}if(i.width>(this._nextX-this._currentX)){this._nextX=this._currentX+i.width;if(this._nextX>this._width){return null}}var hR=this._gl;hR.bindTexture(hR.TEXTURE_2D,this._texture);hR.pixelStorei(hR.UNPACK_FLIP_Y_WEBGL,true);hR.texSubImage2D(hR.TEXTURE_2D,0,this._currentX,hS,hR.RGBA,this._textureType,i);var hQ=this._currentOffsetY;this._currentOffsetY+=e;this._calcUsage();this._count++;var T={width:this._currentX/this._width,height:(this._height-hQ-e)/this._height};this._ids[i.id]=T;return T},_calcUsage:function(){this._usage=(this._currentX*this._height+(this._nextX-this._currentX)*this._currentOffsetY)/(this._height*this._width)},getUsage:function(){return this._usage},clear:function(){this._currentOffsetY=0;this._currentX=0;this._nextX=0;this._count=0;this._usage=0;this._ids={}}});cb.TextureAtlas=bO;function dp(i,e){this._gl=i;e=e||{};this._textureWidth=e.width||4096;this._textureHeight=e.height||4096;this._name=e.name||"";this._unpackAlpha=e.unpackAlpha||false;this._textureCollection=[]}C.extend(dp.prototype,{getEmptyTexture:function(){var e=null;if(this._textureCollection.length<3){e=new bO(this._gl,{width:this._textureWidth,height:this._textureHeight,name:this._name,unpackAlpha:this._unpackAlpha});this._textureCollection.push(e)}else{e=this._textureCollection.shift();while(e.inUse===true){this._textureCollection.push(e);e=this._textureCollection.shift()}e.clear();this._textureCollection.push(e)}e.inUse=true;return e},free:function(e){e.inUse=false}});cb.TextTextureManager=dp;var gU={instances:{},get:function(e,i){if(!i){throw"必须指定id"}if(!gU.instances[i]){gU.instances[i]=new fV(e)}return gU.instances[i]}};function fV(e){this._gl=e;this._attributes=new Uint8Array(16);this._enabledAttributes=new Uint8Array(16);this._capabilities={depthTest:[-1,this._gl.DEPTH_TEST],blend:[-1,this._gl.BLEND],cullFace:[-1,this._gl.CULL_FACE],stencilTest:[-1,this._gl.STENCIL_TEST],scissorTest:[-1,this._gl.SCISSOR_TEST]};this._faceCulling=-1;this._depthMask=-1;this._blendFunc=[-1,-1,-1,-1];this._colorMask=[-1,-1,-1,-1];this._depthFunc=-1;this._frontFace=-1;this._activeTexture=-1;this._clearColor=[0,0,0,0];this._fail=-1;this._zfail=-1;this._zpass=-1}C.extend(fV.prototype,{initAttribute:function(){for(var T=0,e=this._attributes.length;T<e;T++){this._attributes[T]=0}},enableAttribute:function(e){this._attributes[e]=1;if(this._enabledAttributes[e]===0){this._gl.enableVertexAttribArray(e);this._enabledAttributes[e]=1}},disableUnusedAttributes:function(){for(var T=0,e=this._enabledAttributes.length;T<e;T++){if(this._enabledAttributes[T]!==this._attributes[T]){this._gl.disableVertexAttribArray(T);this._enabledAttributes[T]=0}}},enableCap:function(e){if(this._capabilities[e][0]!==true){this._gl.enable(this._capabilities[e][1]);this._capabilities[e][0]=true}},disableCap:function(e){if(this._capabilities[e][0]!==false){this._gl.disable(this._capabilities[e][1]);this._capabilities[e][0]=false}},cullFace:function(e){if(this._faceCulling!==e){this._gl.cullFace(e);this._faceCulling=e}},blendFunc:function(){var i=arguments;var e=this._blendFunc;if(i.length===2){if(i[0]!==e[0]||i[1]!==e[1]||i[0]!==e[2]||i[1]!==e[3]){e[0]=i[0];e[1]=i[1];e[2]=i[0];e[3]=i[1];this._gl.blendFunc.apply(this._gl,arguments)}}else{if(i.length===4){if(i[0]!==e[0]||i[1]!==e[1]||i[2]!==e[2]||i[3]!==e[3]){e[0]=i[0];e[1]=i[1];e[2]=i[2];e[3]=i[3];this._gl.blendFuncSeparate.apply(this._gl,arguments)}}}},colorMask:function(){var e=arguments;var hQ=true;for(var T=0;T<e.length;T++){if(this._colorMask[T]!==e[T]){this._colorMask[T]=e[T];hQ=false}}if(!hQ){this._gl.colorMask.apply(this._gl,arguments)}},depthFunc:function(e){if(this._depthFunc!==e){this._depthFunc=e;this._gl.depthFunc(e)}},depthMask:function(e){if(this._depthMask!==e){this._gl.depthMask(e);this._depthMask=e}},frontFace:function(e){if(this._frontFace!==e){this._frontFace=e;this._gl.frontFace(e)}},activeTexture:function(e){if(this._activeTexture!==e){this._activeTexture=e;this._gl.activeTexture(e)}},clearColor:function(e){if(!e||e.length<4){return}if(this._clearColor[0]!==e[0]||this._clearColor[1]!==e[1]||this._clearColor[2]!==e[2]||this._clearColor[3]!==e[3]){this._clearColor=e.slice(0,4);this._gl.clearColor(e[0]/255,e[1]/255,e[2]/255,e[3]/255)}},stencilOp:function(i,T,e){if(this._fail!==i||this._zfail!==T||this._zpass!==e){this._fail=i;this._zfail=T;this._zpass=e;this._gl.stencilOp(i,T,e)}}});cb.WebGLState=gU;');
﻿_jsload&&_jsload('marker', 'C.extend(cV.prototype,{initialize:function(e){this.map=e;this._addDom();this._bind();if(this.domElement){this.domElement.hashCode=this.hashCode}C.BaseClass.call(this,this.hashCode);if(!this._visible){C.hide(this.domElement)}this.dispatchEvent(new bb("ondomready"));return this.domElement},_bind:function(){if(!this.domElement){return}var e=this;var T=this.map;function i(hT,hS){var hR=hT.srcElement||hT.target;var hQ=hT.clientX||hT.pageX;var hV=hT.clientY||hT.pageY;if(hT&&hS&&hQ&&hV&&hR){var hU=C.Dom.getOffset(T.container);hS.pixel=new ej(hQ-hU.left,hV-hU.top);hS.point=T.pixelToPointIn(hS.pixel);hS.latLng=T.pixelToPoint(hS.pixel);return hS}else{return hS}}C.on(this.domElement,"mouseover",function(hQ){if(!e._dragstarted){e.dispatchEvent(i(hQ,new bb("onmouseover").inherit(hQ)))}});C.on(this.domElement,"mouseout",function(hQ){if(!e._dragstarted){e.dispatchEvent(i(hQ,new bb("onmouseout").inherit(hQ)))}});if(f4()){C.on(this.domElement,"touchstart",function(hQ){e._bind._touchStartPos=new ej(hQ.changedTouches[0].clientX,hQ.changedTouches[0].clientY)});C.on(this.domElement,"touchend",function(hS){var hR=new Date().getTime();var hQ=new ej(hS.changedTouches[0].clientX,hS.changedTouches[0].clientY);if(Math.abs(hQ.x-e._bind._touchStartPos.x)>10||Math.abs(hQ.y-e._bind._touchStartPos.y)>10){e._bind._touchStartPos=null;return}e.dispatchEvent(i(hS,new bb("onclick").inherit(hS)));if(e._config&&typeof e._config.click==="function"){e._config.click()}if(e.map&&hR-e._dblclickTime<e.map.config.clickInterval){e.dispatchEvent(i(hS,new bb("ondblclick").inherit(hS)))}e._dblclickTime=hR})}C.on(this.domElement,"click",function(hR){if(window.TouchEvent&&f4()){return}var hQ=hR.srcElement||hR.target;while(hQ){if(hQ===e.domElement){if(e.toString()!=="Marker"||e.toString()==="Marker"&&(!e._lastPt||e._lastPt&&e.getPoint().equals(e._lastPt))){if(e.addStat&&typeof e.addStat==="function"){e.addStat()}e.dispatchEvent(i(hR,new bb("onclick").inherit(hR)))}break}else{if(e.map&&e.map.infoWindowDoms&&hQ===e.map.infoWindowDoms.popDom){break}}hQ=hQ.parentNode}});C.on(this.domElement,"mousedown",function(hQ){if(e.toString()==="Marker"){e._lastPt=e.getPoint()}e.dispatchEvent(i(hQ,new bb("onmousedown").inherit(hQ)))});C.on(this.domElement,"mouseup",function(hQ){e.dispatchEvent(i(hQ,new bb("onmouseup").inherit(hQ)))});C.on(this.domElement,"dblclick",function(hR){e.dispatchEvent(i(hR,new bb("ondblclick").inherit(hR)));var hQ=hR.target||hR.srcElement||{};if(hQ.tagName!=="circle"&&hQ.tagName!=="oval"){db(hR)}});C.on(this.domElement,"contextmenu",function(hQ){e.dispatchEvent(i(hQ,new bb("onrightclick").inherit(hQ)))})},hide:function(){if(this._visible===false){return false}this._visible=false;C.hide(this.domElement);if(this.infoWindow&&this.infoWindow.overlay&&this.infoWindow.overlay===this){this.closeInfoWindow();this.closeSimpleInfoWindow()}return true},show:function(){if(this._visible===true){return false}this._visible=true;if(this._visibleInternal){C.show(this.domElement);return true}else{return false}},setStyle:function(e){if(!this.domElement){return}if(this.siblingElement){this.siblingElement.style.cssText=this.siblingElement.style.cssText+";"+e}else{this.domElement.style.cssText=this.domElement.style.cssText+";"+e}},getPoint:function(T,hQ){if(!T){return this.point}else{var e=hQ?hQ.width:0;var hR=hQ?hQ.height:0;if(this.map){var i=this.map.pointToPixelIn(this.point);if(this._config&&this._config.offset){i.x=i.x+this._config.offset.width+e;i.y=i.y+this._config.offset.height+hR}else{i.x=i.x+e;i.y=i.y+hR}return this.map.pixelToPointIn(i)}}},setZIndex:function(e){var i=this;i.zIndex=e;i._updateDomZIndex()},_updateDomZIndex:function(){var i=this;var e;if(typeof i.zIndex!=="undefined"){e=i.zIndex}else{e=0;if(i.map&&i.getPoint()){var T=i.getPoint()?i.getPoint().lat:0;e=bl.getZIndex(T,i.map.config.coordType)+(i._config.baseZIndex||0)}}if(i.domElement){i.domElement.style.zIndex=e}},isVisible:function(){if(!this.map){return false}if(this.map._renderType!=="webgl"&&!this.domElement){return false}return !!this._visible},showInternal:function(){if(this._visibleInternal===true){return false}if(this.collisionDetectionFailed===true){return false}this._visibleInternal=true;if(this._visible===true){C.show(this.domElement)}return true},hideInternal:function(e){if(this._visibleInternal===false){return false}this._hideInternalReason=e;this._visibleInternal=false;C.hide(this.domElement);if(this.infoWindow&&this.infoWindow.overlay&&this.infoWindow.overlay===this){this.closeInfoWindow();this.closeSimpleInfoWindow()}return true}});dr.TOP_ZINDEX=bl.getZIndex(-90)+1000000;dr.DRAG_ZINDEX=dr.TOP_ZINDEX+1000000;window.BMAP_ANIMATION_RAISEUP=3;window.BMAP_ANIMATION_DROPDOWN=4;dr._addDragCrossImg=function(T,e){if(!dr._dragCrossImg){dr._dragCrossImg=S("img",{src:e3.imgPath+"drag_cross.png",width:13,height:9});dr._dragCrossImg.style.position="absolute";if(C.Browser.ie===6){delete dr._dragCrossImg;var hQ=dr._dragCrossImg=S("div");var i=hQ.style;i.position="absolute";i.width="13px";i.height="9px";i.filter=\'progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=image,src="\'+e3.imgPath+\'drag_cross.png")\'}}var i=dr._dragCrossImg.style;i.left=T.width-6+"px";i.top=T.height-5+"px";e.appendChild(dr._dragCrossImg)};dr._removeDragCrossImg=function(){if(dr._dragCrossImg&&dr._dragCrossImg.parentNode){dr._dragCrossImg.parentNode.removeChild(dr._dragCrossImg)}};C.extend(dr.prototype,{initialize:function(e){cV.prototype.initialize.call(this,e);if(!this._visible){if(this.siblingElement){C.hide(this.siblingElement)}}this.setPoint(this.point);this.setIcon(this._config.icon,this._config.startAnimation);this.setLabel(this._config.label);this.setTitle(this._config.title);if(this._rotation!==0){this.setRotation(this._rotation)}this._initDrag();return this.domElement},_addDom:function(){var e=this.map;if(this.domElement&&this.domElement.parentNode){this.domElement.parentNode.removeChild(this.domElement);this.domElement=null}this.domElement=dI(e.getPanes().markerMouseTarget,this._msTargetRender());if(e.getMapType()==="B_EARTH_MAP"||e._renderType==="webgl"){return}this.siblingElement=dI(e.getPanes().markerPane,this._markerRender());this.siblingElement.hashCode=this.getHashCode()},_msTargetRender:function(){var e=[\'<div class="BMap_Marker BMap_noprint" unselectable="on" \'];e.push(this._config.title?\'title="\'+this._config.title+\'"\':\'""\');e.push(\' style="position:absolute;padding:0;margin:0;border:0;width:0;height:0;-moz-user-select:none;\');e.push(this._config.clickable?"cursor:pointer;":"");e.push("width:"+this._config.icon.size.width+"px;");e.push("height:"+this._config.icon.size.height+"px;");e.push(\'"></div>\');return e.join("")},_markerRender:function(){var e=[\'<div class="BMap_Marker" unselectable="on" \'];e.push(\'style="position:absolute;padding:0;margin:0;border:0;\');e.push(\'width:0;height:0;-moz-user-select:none"></div>\');return e.join("")},draw:function(T){if(!this.domElement){return}T=T||{};var i=this._getPixPos(T.zoom,T.center);if(i.onBack||i.outOfFrustum){this.hideInternal("out-of-view");return}this.showInternal();this.domElement.style.left=i.x+"px";this.domElement.style.top=i.y+"px";if(this.siblingElement){this.siblingElement.style.left=i.x+"px";this.siblingElement.style.top=i.y+"px"}else{if(this.map.getMapType()!=="B_EARTH_MAP"&&this.map._renderType!=="webgl"){this.initialize(this.map)}}if(this.infoWindow!==null&&this.infoWindow.isOpen()){this.infoWindow.setPosition(T.center,T.zoom)}},_getPixPos:function(T,e){var hR=this._config.offset||new d9(0,0);var hQ=this._config.icon.offset||new d9(0,0);var i=this.map.pointToOverlayPixelIn(this.getPoint(),{zoom:T,center:e,fixPosition:true});i.x+=hR.width-hQ.width;i.y+=hR.height-hQ.height;return i},_draw:function(){if(this.map){this.domElement=this.initialize(this.map)}},remove:function(){if(this.siblingElement&&this.siblingElement.parentNode){this.siblingElement.parentNode.removeChild(this.siblingElement)}if(this.infoWindow&&this.infoWindow.overlay&&this.infoWindow.overlay===this){this.closeInfoWindow();this.closeSimpleInfoWindow();this.infoWindow=null}this.siblingElement=null;this.iconDom=null;if(this._config.label){var i=this._config.label;i.setMarker(null);this.map.removeOverlay(i);this._config.label=null}cV.prototype.remove.call(this);var e=new bb("onstatus_change");e.action="remove";e.overlay=this;this.fire(e)},hide:function(){if(cV.prototype.hide.call(this)===false){return false}if(this.siblingElement){C.hide(this.siblingElement)}if(this._config.label){C.hide(this._config.label.domElement)}var e=new bb("onstatus_change");e.overlay=this;e.action="hide";this.fire(e);return true},show:function(){if(cV.prototype.show.call(this)===false){if(this._hideInternalReason==="out-of-view"){var e=new bb("onstatus_change");e.overlay=this;e.action="show";this.fire(e)}return false}this.draw();if(this.siblingElement){C.show(this.siblingElement)}if(this._config.label){C.show(this._config.label.domElement)}var e=new bb("onstatus_change");e.overlay=this;e.action="show";this.fire(e);return true},showInternal:function(){if(cV.prototype.showInternal.call(this)===false){return false}if(!this._visible){return false}if(this.siblingElement){C.show(this.siblingElement)}if(this._config.label){this._config.label.showInternal()}return true},hideInternal:function(e){if(cV.prototype.hideInternal.call(this,e)===false){return false}if(this.siblingElement){C.hide(this.siblingElement)}if(this._config.label){this._config.label.hideInternal(e)}return true},setIcon:function(hT,hR){if(!hT){return}var hU=this._config.icon.getCurrentImageUrl();var hQ=hT.getCurrentImageUrl()!==hU;this._config.icon=hT;if(!this.map||!this.domElement){return}var i=this.map;if(this.iconDom&&this.siblingElement){this.siblingElement.removeChild(this.iconDom);this.iconDom=null}if(this.domElement){var hS=this.domElement.style;hS.width=hT.size.width+"px";hS.height=hT.size.height+"px";hS.transformOrigin=hT.anchor.width+"px "+hT.anchor.height+"px"}if(this.siblingElement){var T=this.iconDom=S("div",{"class":hR||""});var hV=T.style;hV.position="absolute";hV.padding=hV.margin="0";hV.width=hT.size.width+"px";hV.height=hT.size.height+"px";hV.overflow="hidden";if(hT.imageUrl){T.innerHTML=hT.getHTML()}else{if(hT.imageDom){T.appendChild(hT.imageDom);if(hT.imageSize){hT.imageDom.style.width=hT.imageSize.width+"px";hT.imageDom.style.height=hT.imageSize.height+"px"}}}T.galleryImg=false;this.siblingElement.style.transformOrigin=hT.anchor.width+"px "+hT.anchor.height+"px";this.siblingElement.appendChild(this.iconDom)}this.textureCoord=this.textureCoordGLMap=null;this.draw();var e=new bb("onstatus_change");e.overlay=this;e.action="setIcon";e.imageUrlChanged=hQ;this.fire(e)},setRotation:function(i){while(i<0){i+=360}this._rotation=i%360;var e=new bb("onstatus_change");e.overlay=this;e.action="setRotation";this.fire(e);if(!this.map||!this.domElement){return}this.domElement.style.transform="rotate("+i+"deg)";if(this.siblingElement){this.siblingElement.style.transform="rotate("+i+"deg)"}},setLabel:function(e){if(!(e instanceof aN)){return}e._config.enableMassClear=this._config.enableMassClear;this._config.label=e;var i=this;if(!this._config.label._binded){this._config.label._binded=true;this._config.label.addEventListener("remove",function(){i._config.label=null})}if(!this.map){return}e.setPoint(this.point);this.map.addOverlay(e);e.setMarker(this)},_initDrag:function(){if(!this.domElement||this.domElement._binded){return}this.domElement._binded=true;var T=this.map;var hU=this;var hS=0;var hR=0;var hQ=0;var hV={x:0,y:0};function hT(hX,hW){hW.pixel=hX.pixel;hW.point=hX.point;hW.latLng=hX.latLng;return hW}function i(hY){var hX=hY.clientX;var hW=hY.clientY;if(hY.changedTouches){hX=hY.changedTouches[0].clientX;hW=hY.changedTouches[0].clientY}return new ej(hX,hW)}var e=new ej(0,0);this.dragStart=function(hY){e=i(hY);if(!hU._config.enableDragging){return}hU._isDragging=true;var hX=T.pointToPixelIn(hU.point);var hW=i(hY);hS=hW.x-hX.x;hR=hW.y-hX.y;hQ=new Date().getTime();if(hU.map){hU.map.temp._draggingMarker=hU}C.on(document,"mousemove",hU.dragIng);C.on(document,"mouseup",hU.dragEnd);C.on(document,"touchmove",hU.dragIng);C.on(document,"touchend",hU.dragEnd);if(hU.domElement&&hU.domElement.setCapture){hU.domElement.setCapture()}};this.dragIng=function(h2){var hX=i(h2);if(hX.equals(e)){return}e=hX;if(!hU._isDragging){return}var hY=i(h2);var hZ=new ej((hY.x-hS),(hY.y-hR));hV=hZ;hU._draggingMovePixel=hZ;if((hU._config.restrictDraggingArea&&(hZ.x>15&&hZ.x<hU.map.width-15)&&(hZ.y>30&&hZ.y<hU.map.height-15))||!hU._config.restrictDraggingArea){var hW=hU.map.pixelToPointIn(hZ);var h0=hU.map.pixelToPoint(hZ);var h1={pixel:hZ,point:hW,latLng:h0};hU._panByX=hU._panByY=0;if(hZ.x<=20||hZ.x>=hU.map.width-20||hZ.y<=50||hZ.y>=hU.map.height-10){if(hZ.x<=20){hU._panByX=8}else{if(hZ.x>=hU.map.width-20){hU._panByX=-8}}if(hZ.y<=50){hU._panByY=8}else{if(hZ.y>=hU.map.height-10){hU._panByY=-8}}if(!hU._draggingMoveTimer){hU._draggingMoveTimer=setInterval(function(){T.panBy(hU._panByX,hU._panByY,{newAnimation:true});var h3=T.pixelToPointIn(hU._draggingMovePixel);hU.setPoint(h3)},30)}}else{if(hU._draggingMoveTimer){clearInterval(hU._draggingMoveTimer);hU._draggingMoveTimer=null}hU.setPoint(hW)}if(!hU._dragstarted){hU.dispatchEvent(hT(h1,new bb("ondragstart").inherit(h2)));hU._dragstarted=true;if(hU._config.raiseOnDrag){hU.setAnimation(BMAP_ANIMATION_RAISEUP);dr._addDragCrossImg(hU._config.icon.offset,hU.siblingElement)}}hU.dispatchEvent(hT(h1,new bb("ondragging").inherit(h2)))}};this.dragEnd=function(hW){if(hU.domElement&&hU.domElement.releaseCapture){hU.domElement.releaseCapture()}hU._isDragging=false;if(hU.map){hU.map.temp._draggingMarker=null}C.un(document,"mousemove",hU.dragIng);C.un(document,"mouseup",hU.dragEnd);C.un(document,"touchmove",hU.dragIng);C.un(document,"touchend",hU.dragEnd);hS=hR=0;if(hU._draggingMoveTimer){clearInterval(hU._draggingMoveTimer);hU._draggingMoveTimer=null}if(hV.x>2||hV.y>2){hU._dragstarted=false;hU.dispatchEvent(hT({pixel:hU.map.pointToPixelIn(hU.getPoint()),point:hU.getPoint(),latLng:en.convertMC2LL(hU.getPoint())},new bb("ondragend").inherit(hW)));if(hU._config.raiseOnDrag){hU.setAnimation(BMAP_ANIMATION_DROPDOWN);dr._removeDragCrossImg()}hV.x=hV.y=0}hU._updateDomZIndex()};this.delVertexMarker=function(hW){db(hW);hU.dispatchEvent(hT({pixel:hU.map.pointToPixelIn(hU.getPoint()),point:hU.getPoint(),latLng:en.convertMC2LL(hU.getPoint())},new bb("onmarkerdelvertex").inherit(hW)))};C.on(this.domElement,"mousedown",this.dragStart);C.on(this.domElement,"touchstart",this.dragStart);C.on(this.domElement,"contextmenu",this.delVertexMarker)},setPoint:function(e){if(!e){return}this.point=this._config.point=new hr(e.lng,e.lat);this.latLng=en.convertMC2LL(e);if(this._config.label){this._config.label.setPoint(this.point)}this.draw();this._updateDomZIndex();var i=new bb("onstatus_change");i.overlay=this;i.action="setPoint";this.fire(i)},_updateDomZIndex:function(){var i=this;var e;if(i._isDragging===true){e=dr.DRAG_ZINDEX}else{if(i._config.isTop===true){e=dr.TOP_ZINDEX+(i._addi||0)}else{if(typeof i.zIndex!=="undefined"){e=i.zIndex}else{e=0;if(i.map&&i.getPoint()){e=bl.getZIndex(i.getPoint().lat,i.map.config.coordType)+i._config.baseZIndex}}}}if(i.domElement){i.domElement.style.zIndex=e}if(i.siblingElement){i.siblingElement.style.zIndex=e}this._zIndex=e},setTop:function(T,i){this._config.isTop=!!T;if(T){this._addi=i||0}this._updateDomZIndex();var e=new bb("onstatus_change");e.overlay=this;e.action="setTop";this.fire(e)},setTitle:function(e){this._config.title=e||"";if(this.domElement){this.domElement.title=this._config.title}},setOffset:function(i){if(!i){return}this._config.offset=i;this.setPoint(this.getPoint());var e=new bb("onstatus_change");e.overlay=this;e.action="setOffset";this.fire(e)},setAnimation:function(i){var e=this;ea.load("markeranimation",function(){e._setAnimation(i)},true)},_setAnimation:function(i){if(!this.iconDom){return}this._clearAnimation(i!==null);var e=bB[i];if(!e){return}this._execJSAnimation(i)},_clearAnimation:function(i){if(i){if(this._aniObj){this._aniObj.stop();this._aniObj=null}this.iconDom.style.top=this.iconDom.style.left="0px";if(this.shadowDom){this.shadowDom.style.top=this.shadowDom.style.left="0px"}}else{if(this._aniObj){var e=this;this._aniObj.setFinishCallback(function(){e._aniObj=null})}}},_execJSAnimation:function(hS){var hU=this.iconDom.style;var e=false;var hR;if(this.shadowDom){e=true;hR=this.shadowDom.style}var T=bB[hS];var hW=this;var hV=T.iconAnis.length,hZ=T.options.duration,hY=hW._aniObj=new o({duration:0,delay:o.INFINITE});var hX=T.iconAnis;var hQ=T.shadowAnis;hU.top=hX[0].translate[1]+"px";if(e){hR.left=hQ[0].translate[0]+"px";hR.top=hQ[0].translate[1]+"px"}for(var hT=1;hT<hV;hT++){(function(){var h4=[hX[hT].translate[0]-hX[hT-1].translate[0],hX[hT].translate[1]-hX[hT-1].translate[1]];var h3=[hX[hT-1].translate[0],hX[hT-1].translate[1]];if(e){var h1=[hQ[hT].translate[0]-hQ[hT-1].translate[0],hQ[hT].translate[1]-hQ[hT-1].translate[1]];var h0=[hQ[hT-1].translate[0],hQ[hT-1].translate[1]]}var h2=cn[hX[hT-1].timingFunc];var i=function(){};if(hT===hV-1){if(T.options.loop!==o.INFINITE){i=function(){hW._aniObj=null}}else{i=function(){hW._aniObj.start()}}}hY.add(new o({duration:(T.iconAnis[hT].percent-hX[hT-1].percent)*hZ,fps:40,delay:o.INFINITE,transition:h2,render:function(h5){if(hW.iconDom){hW.iconDom.style.top=h3[1]+Math.round(h5*h4[1])+"px"}if(e&&hW.shadowDom){hW.shadowDom.style.left=h0[0]+Math.round(h5*h1[0])+"px";hW.shadowDom.style.top=h0[1]+Math.round(h5*h1[1])+"px"}},finish:i}))})()}hY.start()},getVertexInfoForGL:function(){var T=this._config.icon.getRenderData();var e=this.point;var hR=aF(e.lng);var i=aF(e.lat);var hQ=[];this._buildVertexForEachRender(hR,i,hQ);return{vertex:hQ,textureCoordGLMap:T.textureCoordGLMap}},_buildVertexForEachRender:function(hX,hW,hU){var hV=this._config.icon;var hQ=this._config.offset;var e=0;var hT=[];hT[0]=[-hV.offset.width+hQ.width,-(hV.size.height-hV.offset.height)-hQ.height];hT[1]=[hV.size.width-hV.offset.width+hQ.width,-(hV.size.height-hV.offset.height)-hQ.height];hT[2]=[hV.size.width-hV.offset.width+hQ.width,hV.offset.height-hQ.height];hT[3]=[-hV.offset.width+hQ.width,hV.offset.height-hQ.height];if(this._rotation!==0){for(var hR=0;hR<hT.length;hR++){var T=vec2.fromValues(hT[hR][0],hT[hR][1]);vec2.rotate(T,T,[0,0],dK(-this._rotation));hT[hR][0]=T[0];hT[hR][1]=T[1]}}while(e<6){var hS=e<3?e:(e===3?e-3:e-2);hU.push([hX[0],hW[0],hX[1],hW[1],hT[hS][0],hT[hS][1]]);e++}}});var hN=ha.prototype;hN.getHTML=function(){if(!this.imageUrl){return""}var e=[];e.push(\'<img src="\'+this.imageUrl+\'" \');if(this.srcSet){e.push(\'srcset="\'+this.srcSet+\'" \')}e.push(\'style="left:\'+(-this.imageOffset.width)+"px;");e.push("top:"+(-this.imageOffset.height)+"px;");if(this.imageSize){this.imageSize.width&&e.push("width:"+this.imageSize.width+"px;");this.imageSize.height&&e.push("height:"+this.imageSize.height+"px;")}e.push(\'position:absolute;"/>\');return e.join("")};C.extend(aN.prototype,{_addDom:function(){var i=this._config;var hQ=this.content;var e=S("label",{"class":"BMapLabel",unselectable:"on"});if(i.title){e.title=i.title}var T=e.style;T.position="absolute";T.MozUserSelect="none";if(i.width===0||i.width==="auto"){T.display="inline"}else{T.width=i.width+"px";T.display="block";T.overflow="hidden"}if(!C.Browser.ie){T.cursor="inherit"}e.innerHTML=hQ;this.map.getPanes().labelPane.appendChild(e);this.domElement=e;this.setStyle(this._config.styles);return e},setPoint:function(e){if(e){this.point=this._config.point=e.clone();this.draw()}},draw:function(T){if(this.domElement&&this.getPoint()){var hQ=this._config.offset||new d9(0,0);T=T||{};var i=this.map.pointToOverlayPixelIn(this.getPoint(),{zoom:T.zoom,center:T.center,fixPosition:true});if(i.onBack||i.outOfFrustum){this.hideInternal("out-of-view")}else{this.showInternal();this.domElement.style.left=(i.x+hQ.width)+"px";this.domElement.style.top=(i.y+hQ.height)+"px";this._updateDomZIndex()}}},_draw:function(){if(this.map){if(!this.domElement){this.domElement=this.initialize(this.map)}this.draw()}},setContent:function(e){this.content=e;if(this.domElement){this.domElement.innerHTML=e}},setOpacity:function(e){if(e>=0&&e<=1){this._config.opacity=e}if(this.domElement){this.domElement.style.opacity=e}},setOffset:function(e){if(!e){return}this._config.offset=new d9(e.width,e.height);this.draw()},setStyle:function(i){i=i||{};this._config.styles=C.extend(this._config.styles,i);if(this.domElement){for(var hQ in i){try{this.domElement.style[hQ]=i[hQ]}catch(T){}}}},setTitle:function(e){this._config.title=e||"";if(this.domElement){this.domElement.title=this._config.title}}});C.extend(bd.prototype,{initialize:function(e){cV.prototype.initialize.call(this,e);return this.domElement},_getPixPos:function(hR,i){var hQ=this.map.getZoomUnits();var e=this._config.height/hQ/2;var T=this.map.pointToPixelIn(this.getPoint(),{zoom:hR,center:i,height:e});return T},_draw:function(){if(this.map){this.domElement=this.initialize(this.map)}},_addDom:function(){var e=this.map;if(this.domElement&&this.domElement.parentNode){this.domElement.parentNode.removeChild(this.domElement);this.domElement=null}this.domElement=dI(e.getPanes().markerMouseTarget,this._msTargetRender());if(e.getMapType()==="B_EARTH_MAP"||e._renderType==="webgl"){return}},_msTargetRender:function(){var e=[\'<div class="BMap_Marker BMap_noprint" unselectable="on" \'];e.push(\' style="position:absolute;padding:0;margin:0;border:0;width:0;height:0;-moz-user-select:none;\');e.push(this._config.clickable?"cursor:pointer;":"");e.push("width:"+this._config.size+"px;");e.push("height:"+this._config.size+"px;");e.push(\'"></div>\');return e.join("")},draw:function(hR){if(!this.domElement){return}hR=hR||{};if(hR.currentTarget){var hQ=hR.currentTarget.zoomLevel;var i=hR.currentTarget.centerPoint}var T=this._getPixPos(hQ,i);this.showInternal();this.domElement.style.left=T.x-this._config.size/2+"px";this.domElement.style.top=T.y-this._config.size/2+"px";if(this.map.getMapType()!=="B_EARTH_MAP"&&this.map._renderType!=="webgl"){this.initialize(this.map)}if(this.infoWindow!==null&&this.infoWindow.isOpen()){this.infoWindow.setPosition(hR.center,hR.zoom)}},showInternal:function(){if(cV.prototype.showInternal.call(this)===false){return false}if(!this._visible){return false}return true},hideInternal:function(e){if(cV.prototype.hideInternal.call(this,e)===false){return false}return true},getVertexInfoForGL:function(){var e=this.point;var hQ=aF(e.lng);var i=aF(e.lat);var T=[];this._buildVertexForEachRender(hQ,i,T);return{vertex:T}},_buildVertexForEachRender:function(hQ,e,T){var i=gZ.parseHexAndOpacityToRgbaArray(this._config.fillColor,this._config.fillOpacity);T.push([hQ[0],e[0],hQ[1],e[1],this._config.height,i[0]/255,i[1]/255,i[2]/255,i[3],this._config.size*a6(),this._config.shape])}});');
﻿_jsload&&_jsload('poly', 'w.DOM_ATTRS={strokecolor:1,strokeweight:1,strokeopacity:1,fillcolor:1,fillopacity:1,strokelinecap:1,strokelinejoin:1,strokestyle:1,topfillcolor:1,topfillopacity:1,sidefillcolor:1,sidefillopacity:1};C.extend(w.prototype,{initialize:function(T){if(T&&this._graphMouseEvent){T.addEventListener("onmousemove",this._graphMouseEvent)}if(T&&this._graphClickEvent){T.addEventListener("onclick",this._graphClickEvent);T.addEventListener("ondblclick",this._graphClickEvent);T.addEventListener("onrightclick",this._graphClickEvent);T.addEventListener("onrightdblclick",this._graphClickEvent)}if((this._config.strokeStyle==="dashed"||this._config.strokeStyle==="dotted")&&T.getRenderType()==="webgl"&&!this._config.texture){this._generateTexture()}var e=cV.prototype.initialize.call(this,T);if(this._config.enableEditing===true&&!this._config.geodesic){var i=this;setTimeout(function(){i.clearVertexs();i.addVertexs()},0)}return e},_generateTexture:function(){var hS=this._config;var T=hS.dashArray;var hR=document.createElement("canvas");var e;var hQ;if(hS.strokeStyle==="dashed"){e=16;hQ=e*8}else{if(hS.strokeStyle==="dotted"){e=32;hQ=e*2}}hR.width=e;hR.height=hQ;var i=hR.getContext("2d");i.fillStyle=hS.strokeColor;i.globalAlpha=hS.strokeOpacity;if(hS.strokeStyle==="dashed"){this._drawDashArrayTexture(i,e,hQ)}else{if(hS.strokeStyle==="dotted"){this._drawDottedTexture(i,e,hQ)}}this._config.texture=hR;this._config.textureSize=[e,hQ]},_drawDashArrayTexture:function(hW,hQ,hS){var T=this._config;var hU=T.dashArray;if(!hU){hW.fillRect(0,0,hQ,hS/2);this._totalDashLen=T.strokeWeight*4}else{var hV=0;if(hU.length%2!==0){hU=hU.concat(hU)}for(var hR=0;hR<hU.length;hR++){hV+=hU[hR]}var e=0;for(var hR=0;hR<hU.length;hR++){var hT=hU[hR]/hV*hS;if(hR%2===0){hW.fillRect(0,e,hQ,hT)}e+=hT}this._totalDashLen=hV}},_drawDottedTexture:function(i,e,T){i.beginPath();i.arc(e/2,e/2,e/2,0,2*Math.PI);i.fill();i.closePath();this._totalDashLen=this._config.strokeWeight*2},_addDom:function(){if(this.map._renderType==="webgl"){return}var e=this._drawer=bw.getDrawer(this.map);this.domElement=e.addLine()},_bind:function(){var e=this.domElement;var hQ=this;function hS(hY,hW){var hV=hY.srcElement||hY.target;var hU=fJ();var i=hY.pageX?hY.pageX:(hY.clientX+hU[1]);var h0=hY.pageY?hY.pageY:(hY.clientY+hU[0]);if(hY&&hW&&i&&h0&&hV){var hX=C.I(hV.hashCode).map;var hZ=C.Dom.getOffset(hX.container);hW.pixel=new ej(i-hZ.left,h0-hZ.top);hW.point=hX.pixelToPointIn(hW.pixel);hW.latLng=hX.pixelToPoint(hW.pixel);return hW}else{return hW}}if(e&&bw.getDrawer(this.map).getType()!=="canvas"){C.on(e,"click",function(i){hQ.dispatchEvent(hS(i,new bb("onclick").inherit(i)))});C.on(e,"mousedown",function(i){hQ.dispatchEvent(hS(i,new bb("onmousedown").inherit(i)))});C.on(e,"mouseup",function(i){hQ.dispatchEvent(hS(i,new bb("onmouseup").inherit(i)))});C.on(e,"dblclick",function(i){hQ.dispatchEvent(hS(i,new bb("ondblclick").inherit(i)))})}e=null;if(!this._binded){this._binded=true;this.enableEventListen=true;this._graphMouseEvent=function(hX){if(!hQ.map){return}if(hQ.map.getMapType()==="B_EARTH_MAP"){return}if(hQ instanceof bo.PolylineMultipart||hQ instanceof bo.Marker3D){return}if(hQ.map.temp._draggingMarker){return}if(!hQ.enableEventListen){return}var hU;if(hX.overlay&&hX.overlay.toString()==="Marker"){if(!hX.overlay.keepWhenMousemoveOn){if(hQ._temp.ismouseout===false&&hQ._temp.ismouseover===true){hQ._temp.ismouseover=false;hQ._temp.ismouseout=true;hU=new bb("onmouseout");hQ.dispatchEvent(hU)}return}}var i=hX.point;var hW;if(hQ.toString()!=="Polyline"){hW=hQ._getInPnpoly(i)}else{hW=hQ._getProximity(i)}var hV=hW.dist;if(hV>=0&&hV<hQ._config.mouseOverTolerance){if(!hQ._temp.ismouseover){hQ._temp.ismouseover=true;hQ._temp.ismouseout=false;hU=new bb("onmouseover")}else{hU=new bb("onmousemove");hQ.map.platform.style.cursor="pointer"}}else{if(!hQ._temp.ismouseout&&hQ._temp.ismouseover){hQ._temp.ismouseover=false;hQ._temp.ismouseout=true;hU=new bb("onmouseout");hQ.map.platform.style.cursor=hQ.map.config.defaultCursor}}if(hU){if(hQ.toString()!=="Polyline"&&hU.type==="onmousemove"&&hQ._temp.ismouseover===true&&(hV===0||hV>hQ._config.mouseOverTolerance)){hU.pixel=hX.pixel;hU.point=hX.point;hU.latLng=this.overlayPixelToPoint(hX.pixel)}else{hU.point=this.overlayPixelToPointIn(hW.pixel);hU.pixel=this.pointToPixelIn(hU.point);hU.latLng=this.overlayPixelToPoint(hW.pixel)}hQ.dispatchEvent(hU)}};this._graphClickEvent=function(hX){if(!hQ.map){return}if(hQ.map.getMapType()==="B_EARTH_MAP"){return}if(hQ instanceof bo.PolylineMultipart||hQ instanceof bo.Marker3D){return}if(hQ.map.temp._draggingMarker){return}if(!hQ.enableEventListen){return}var hU;var i=hX.point;var hW;if(hQ.toString()!=="Polyline"){hW=hQ._getInPnpoly(i)}else{hW=hQ._getProximity(i)}var hV=hW.dist;if(hV>=0&&hV<hQ._config.mouseOverTolerance){hU=new bb(hX.type)}if(hU){if(hQ.toString()!=="Polyline"&&hU.type==="onmousemove"&&hQ._temp.ismouseover===true&&(hV===0||hV>hQ._config.mouseOverTolerance)){hU.pixel=hX.pixel;hU.point=hX.point;hU.latLng=this.overlayPixelToPoint(hX.pixel)}else{hU.point=this.overlayPixelToPointIn(hW.pixel);hU.pixel=this.pointToPixelIn(hU.point);hU.latLng=this.overlayPixelToPoint(hW.pixel)}hQ.dispatchEvent(hU)}};this.map.addEventListener("onmousemove",this._graphMouseEvent);var hR=["onclick","dblclick","onrightclick","onrightdblclick"];for(var T=0;T<hR.length;T++){var hT=hR[T];this.map.addEventListener(hT,this._graphClickEvent)}this.addEventListener("mouseover",function(i){if(!this.map){return}});this.addEventListener("mouseout",function(i){if(!this.map){return}});this.map.addEventListener("movestart",function(){hQ.enableEventListen=false;hQ._mouseEventPixels=null});this.map.addEventListener("moveend",function(){hQ.enableEventListen=true});this.map.addEventListener("zoomstart",function(){hQ.enableEventListen=false;hQ._mouseEventPixels=null});this.map.addEventListener("zoomend",function(){hQ.enableEventListen=true});this.map.on("center_changed",function(){hQ._mouseEventPixels=null});this.map.on("zoom_changed",function(){hQ._mouseEventPixels=null});this.map.on("load",function(){hQ._mouseEventPixels=null})}},draw:function(hR){if(!this.domElement){return}var hQ=this.map;if(hQ.getMapType()==="B_EARTH_MAP"||hQ._renderType==="webgl"){return}hR=hR||{};var T=this.points.slice(0);if(this.greatCirclePoints.length>0){T[0]=this.greatCirclePoints}var i=this._getDisplayPixels(T,hR.zoom,hR.center);if(this._drawer){this._drawer.setPath(this.domElement,i)}},_draw:function(){if(this.map){this.initialize(this.map);if(this.domElement){this.domElement.style.WebkitUserSelect="none"}this.draw()}},_getDisplayPixels:function(hU,hV,e){var hQ=this.map;var hT=[];if(hU.length==0||!this.isVisible()){return[hT]}if(hQ._renderType!=="webgl"&&!this.domElement){return[hT]}var T=hU;if(!this._config.enableEditing&&this._config.enableParse){T=this._simplification(hU)}var hS=[];if(hU[0] instanceof hr){var hW=this._toOverlayPixels(T,hV,e);hS.push(hW.pixels);hS.isOnBack=hW.isOnBack}else{hS.isOnBack=false;for(var hR=0;hR<T.length;hR++){var hW=this._toOverlayPixels(T[hR],hV,e);hS.push(hW.pixels);if(hW.isOnBack===true){hS.isOnBack=true}}}return hS},_toOverlayPixels:function(hV,hY,e){var T=this.map;var hW;var hX=[];var hU=T.pointToOverlayPixelIn(hV[0],{zoom:hY,center:e});hX.push(hU);if(hU.onBack){hW=true}for(var hS=1,hR=1,hQ=hV.length;hS<hQ;hS++){var hT=T.pointToOverlayPixelIn(hV[hS],{zoom:hY,center:e});if(hT.onBack){hW=true}if(!hT.equals(hX[hR-1])){hX.push(hT);hR++}}return{pixels:hX,isOnBack:hW}},getParseCacheIndex:function(e){e=Math.floor(e);if(this._config.getParseCacheIndex){return this._config.getParseCacheIndex(e)}if(e<6){return 0}if(e<10){return 1}if(e<15){return 2}return 3},getParseTolerance:function(i,e){i=Math.floor(i);if(this._config.getParseTolerance){return this._config.getParseTolerance(i,e)}return w.parseTolerance[e][this.getParseCacheIndex(i)]},setPoints:function(i){this._clearCache();this.points=w.getGraphPoints(i).slice(0);this._calcBounds();this.draw();var e=new bb("onlineupdate");e.overlay=this;this.dispatchEvent(e)},setPointAt:function(T,e){if(!e||!this.points[T]){return}this._clearCache();this.points[T]=new hr(e.lng,e.lat);this._calcBounds();this.draw();var i=new bb("onlineupdate");i.overlay=this;this.dispatchEvent(i)},setPositionAt:function(i,e){if(!e||!this.points[i]){return}var T=en.convertLL2MC(e);this.setPointAt(i,T);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs();this.addVertexs()}},setOptions:function(i){i=i||{};var T=this.isStyleUseTexture();for(var e in i){if(i.hasOwnProperty(e)){var hR=this._config[e];var hQ=i[e];this._config[e]=hQ;if(hQ!==hR&&(e==="strokeColor"||e==="strokeOpacity"||e==="strokeWeight")){if(this._config.texture){this._config.texture=null}if(T){this._generateTexture()}}if(this.map){this._setDomAttribute(e.toLowerCase(),i[e])}}}},isStyleUseTexture:function(){if(!this.map){return false}if(this.map.getRenderType()!=="webgl"){return false}return this._config.strokeStyle==="dashed"||this._config.strokeStyle==="dotted"},setStrokeColor:function(e){this.setOptions({strokeColor:e})},setStrokeLineCap:function(e){if(this._config){this._config.strokeLineCap=e}this._setDomAttribute("strokelinecap",e)},setStrokeLineJoin:function(e){if(this._config){this._config.strokeLineJoin=e}this._setDomAttribute("strokelinejoin",e)},setStrokeWeight:function(e){if(e>0){this._config.strokeWeight=e;if(!this.map){return}this._setDomAttribute("strokeweight",e)}},setStrokeOpacity:function(e){if(!e||e>1||e<0){return}this._config.strokeOpacity=e;if(!this.map){return}this._setDomAttribute("strokeopacity",e)},setFillOpacity:function(e){if(e>1||e<0){return}this._config.fillOpacity=e;this._setDomAttribute("fillopacity",e)},setStrokeStyle:function(e){if(e!="solid"&&e!="dashed"&&e!="dotted"){return}this._config.strokeStyle=e;this._setDomAttribute("strokestyle",e)},setFillColor:function(e){this._config.fillColor=e||"";this._setDomAttribute("fillcolor",e)},_setDomAttribute:function(i,T){if(!w.DOM_ATTRS[i]){return}if(this._drawer){if(T===false||T===null||typeof T==="undefined"){T=""}this._drawer.setAttribute(this.domElement,i,T,this._config)}var e=new bb("onlineupdate");e.overlay=this;this.dispatchEvent(e);if(i==="strokeweight"&&this.getStrokeStyle()==="dashed"&&bw.getDrawer(this.map)&&bw.getDrawer(this.map).getType()==="svg"){this._setDomAttribute("strokestyle","dashed")}},addVertexs:function(){var hU=this;if(hU.vertexMarkers.length){return}var hV=this.getVertexPoints();var hT;for(var hS=0,hQ=hV.length;hS<hQ;hS++){var e=hV[hS];if(e.t){hT=e3.imgPath+"nodeT.gif"}else{hT=e3.imgPath+"node.gif"}var T=new ha(hT,new d9(11,11),{offset:new d9(5,5)});var hR=new dr(e.p,{icon:T});hR.enableDragging(true);hR.addEventListener("ondragging",function(i){hU._onMarkerDragging(i)});hR.addEventListener("ondragstart",function(i){hU._onMarkerDragstart(i)});hR.addEventListener("ondragend",function(i){hU._onMarkerDragend(i)});hR.addEventListener("onmarkerdelvertex",function(i){hU._onMarkerDelVertex(i)});hR.index=hS;hR.t=e.t;this.vertexMarkers.push(hR);this.map?this.map.addOverlay(hR):""}},clearVertexs:function(){var e;while(e=this.vertexMarkers.pop()){this.map.removeOverlay(e);e=undefined}this.vertexMarkers.length=0},getVertexPoints:function(){var hS=[];for(var hR=0,T=this.points.length;hR<T;hR++){var hT=this.points[hR];hS.push({p:hT,t:0});if(hR<T-1){var e=this.points[hR+1];var hQ=new hr((hT.lng+e.lng)/2,(hT.lat+e.lat)/2);hS.push({p:hQ,t:1})}}this.vertexPoints=hS;return hS},delVertex:function(e){this.map.removeOverlay(this.vertexMarkers[e]);this.vertexPoints.splice(e,1);this.vertexMarkers.splice(e,1)},_onMarkerDragging:function(i){},_onMarkerDragstart:function(T){this._editstate=false;var i=new bb("oneditstart");i.pixel=T.pixel;i.point=T.point;i.latLng=T.latLng;i.overlay=this;this.dispatchEvent(i)},_onMarkerDragend:function(hU){this.vertexPoints.length=0;this._editstate=false;if(this._temp.dashedLine){this.map.removeOverlay(this._temp.dashedLine);delete this._temp.dashedLine}if(this._temp.preTNode){this.map.removeOverlay(this._temp.preTNode);delete this._temp.preTNode}if(this._temp.nexTNode){this.map.removeOverlay(this._temp.nexTNode);delete this._temp.nexTNode}var hT=hU.currentTarget;var hV=hU.point;var T=hT.index;var hS;if(T%2!=0){T=Math.ceil(T/2);hS=this.points.slice();var hR=this.points.length-T;var hQ=hS.splice(T,hR);hS[hS.length]=hV;hS=hS.concat(hQ)}else{T=T/2;this.points.splice(T,1,hV);if(this instanceof aR&&this.points.length-1==T){this.points.splice(0,1,hV)}hS=this.points}this.clearVertexs();this.setPoints(hS);this.addVertexs();var i=new bb("oneditend");i.pixel=hU.pixel;i.point=hU.point;i.latLng=hU.latLng;i.overlay=this;this.dispatchEvent(i);this._mouseEventPixels=null},_onMarkerDelVertex:function(hS){if(this.toString()!=="Polyline"&&this.toString()!=="Polygon"){return}if(hS.target.type===0||hS.target.t===0){var hR=[];if(this.vertexPoints.length<4&&this.toString()==="Polyline"){return}if(this.vertexPoints.length<8&&this.toString()==="Polygon"){return}if(this.toString()==="Polygon"&&(hS.target.index===0||hS.target.index===(this.vertexPoints.length-1))){this.delVertex(this.vertexPoints.length-1);this.delVertex(0)}else{this.delVertex(hS.target.index)}for(var hQ=0;hQ<this.vertexPoints.length;hQ++){if(this.vertexPoints[hQ].t===0){hR.push(this.vertexPoints[hQ].p)}}this.points=hR;if(this.points[0].lng===this.points[this.points.length-1].lng&&this.points[0].lat===this.points[this.points.length-1].lat){this.points.splice(this.points.length-1,1)}this.clearVertexs();this.setPoints(this.points);this.addVertexs();var T=new bb("oneditend");T.pixel=hS.pixel;T.point=hS.point;T.latLng=hS.latLng;T.overlay=this;this.dispatchEvent(T);this._mouseEventPixels=null}},_getInPnpoly:function(T){var hQ;var hU=[];var e=this.map.pointToOverlayPixelIn(T);if(this._mouseEventPixels){hU=this._mouseEventPixels}else{if(!(this.points[0] instanceof hr)){var hT=this._getDisplayPixels(this.points);for(var hS=0;hS<hT.length;hS++){hT[hS].push(hT[hS][0]);hU=hU.concat(hT[hS])}}else{hU=this._getDisplayPixels(this.points)[0]}this._mouseEventPixels=hU}var hR=this._pixelPnpoly(e,hU);hQ=hR?0:1000;return{pixel:e,dist:hQ}},_getProximity:function(h1){var T,hR,h2,hU,hT,h0,hZ,hY=[];var h3=this.map.pointToOverlayPixelIn(h1);if(this._mouseEventPixels){hY=this._mouseEventPixels}else{hY=this._getDisplayPixels(this.points)[0];this._mouseEventPixels=hY}var h6=hY.length;if(h6>1){for(var h4=1;h4<h6;h4++){var hW=hY[h4-1];var ia=hY[h4];if(!hW||!ia){continue}if(hW.x!=ia.x){var h9=(ia.y-hW.y)/(ia.x-hW.x);var h7=ia.y-h9*ia.x;hZ=Math.abs(h9*h3.x+h7-h3.y)/Math.sqrt(h9*h9+1)}else{hZ=Math.abs(h3.x-ia.x)}var h5=Math.pow(ia.y-hW.y,2)+Math.pow(ia.x-hW.x,2);var hQ=Math.pow(ia.y-h3.y,2)+Math.pow(ia.x-h3.x,2);var h8=Math.pow(hW.y-h3.y,2)+Math.pow(hW.x-h3.x,2);var hS=Math.pow(hZ,2);var e=hQ-hS+h8-hS;if(e>h5){hZ=Math.sqrt(Math.min(hQ,h8))}if((T==null)||(T>hZ)){hR=Math.sqrt(h8-hS)/Math.sqrt(h5);h2=Math.sqrt(hQ-hS)/Math.sqrt(h5);T=hZ;h0=h4}T=Math.min(T,hZ)}if(hR>1){hR=1}if(h2>1){hR=0;h2=1}var hX=hY[h0-1].x-hY[h0].x;var hV=hY[h0-1].y-hY[h0].y;hU=hY[h0-1].x-(hX*hR);hT=hY[h0-1].y-(hV*hR)}return{pixel:new ej(hU,hT),dist:T}},_pixelPnpoly:function(hR,hT){var e=hT.length;var T=0;var hS=false;for(var hQ=0;hQ<e;hQ++){T=(hQ===e-1)?0:T+1;if((hT[hQ].y!==hT[T].y)&&(((hR.y>=hT[hQ].y)&&(hR.y<hT[T].y))||((hR.y>=hT[T].y)&&(hR.y<hT[hQ].y)))&&(hR.x<(hT[T].x-hT[hQ].x)*(hR.y-hT[hQ].y)/(hT[T].y-hT[hQ].y)+hT[hQ].x)){hS=!hS}}return hS},getMinDistance:function(i){var e=this._getProximity(i);var T=this.map.overlayPixelToPointIn(e.pixel);return this.map.getDistanceIn(i,T)},buildVertex:function(hR,hX){var hU=[];var hY=[];var h0=this.points.slice(0);var h1=[];if(this.greatCirclePoints.length>0){h0[0]=this.greatCirclePoints}var T=w.JOININDEX[this._config.strokeLineJoin];var hZ=w.CAPINDEX[this._config.strokeLineCap];var hQ=this.getStrokeColorForGL();var e=this._config.strokeWeight/2;var hT=this.map.getZoom();if(h0.length>500&&h0[0] instanceof hr){if(!hX&&this._lastResult){return this._lastResult}var hW=this._getDisplayPixelsGLWithCut(h0);for(var hS=0;hS<hW.length;hS++){if(hW[hS].length<2){continue}if(hU.length/6+hR.getVertexCount(hW[hS].length)>65536){h1.push([hU,hY]);hU=[];hY=[]}hR.buildData(hW[hS],T,hZ,hU,hY,hQ,e)}h1.push([hU,hY]);h1.inCache=false;this._lastResult=h1;return h1}var hV=this.getParseCacheIndex(this.map.getZoom());if(hX!==true&&this._parseCacheGL[hV]){this._parseCacheGL[hV].inCache=true;return this._parseCacheGL[hV]}var hW=this._getDisplayPixelsGL(h0);for(var hS=0;hS<hW.length;hS++){if(hW[hS].length<2){continue}if(hU.length/6+hR.getVertexCount(hW[hS].length)>65536){h1.push([hU,hY]);hU=[];hY=[]}hR.buildData(hW[hS],T,hZ,hU,hY,hQ,e)}h1.push([hU,hY]);this._parseCacheGL[hV]=h1;this._parseCacheGL[hV].cacheIndex=hV;return h1},ifInMapView:function(){if(!this.map){return false}if(this.map.getZoom()<5){return true}if(this._config.clip===false){return true}var e=this.map.getBoundsIn();return !!e.intersects(this.getBoundsIn())},_getDisplayPixelsGLWithCut:function(e){return this._getDisplayPixelsGL(e)},_getDisplayPixelsGL:function(hQ){var hS=this.map;var hR=[];var hU=[];hR.pointsArray=hU;if(hQ.length==0||!this.isVisible()){return[hR]}var hT=hQ;if(!this._config.enableEditing&&this._config.enableParse){hT=this._simplification(hQ)}var T=[];if(!this.hasMultipleParts){T[0]=this._toOverlayPixelsGL(hT)}else{for(var e=0;e<hT.length;e++){T.push(this._toOverlayPixelsGL(hT[e]))}}return T},_toOverlayPixelsGL:function(hX){var T=this.map;var hW=[];var hT=[];hW.pointsArray=hT;var e=T._polyOverlayBasePoint;var hV=[hX[0].lng-e.lng,hX[0].lat-e.lat];hW.push(hV);hT.push(hV[0],hV[1]);for(var hS=1,hR=1,hQ=hX.length;hS<hQ;hS++){var hU=[hX[hS].lng-e.lng,hX[hS].lat-e.lat];if(hU[0]!==hW[hR-1][0]||hU[1]!==hW[hR-1][1]){hW.push(hU);hT.push(hU[0],hU[1]);hR++}}return hW},getStrokeColorForGL:function(){var T=this._config.strokeColor.substr(1);var i=this._config.strokeOpacity;var e;if(T.length===3){e=[parseInt(T.substr(0,1)+T.substr(0,1),16),parseInt(T.substr(1,1)+T.substr(1,1),16),parseInt(T.substr(2,1)+T.substr(2,1),16),Math.floor(i*255)]}else{e=[parseInt(T.substr(0,2),16),parseInt(T.substr(2,2),16),parseInt(T.substr(4,2),16),Math.floor(i*255)]}return e},show:function(){cV.prototype.show.call(this);var e=new bb("onlineupdate");e.action="show";e.overlay=this;this.dispatchEvent(e);this.draw();if(this._config.enableEditing===true&&!this._config.geodesic){this.addVertexs()}},hide:function(){cV.prototype.hide.call(this);var e=new bb("onlineupdate");e.action="hide";e.overlay=this;this.dispatchEvent(e);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs()}},remove:function(){if(this.map){this.map.removeEventListener("onmousemove",this._graphMouseEvent);this.map.removeEventListener("onclick",this._graphClickEvent);this.map.removeEventListener("ondblclick",this._graphClickEvent);this.map.removeEventListener("onrightclick",this._graphClickEvent);this.map.removeEventListener("onrightdblclick",this._graphClickEvent)}cV.prototype.remove.call(this);this._clearCache();var e=new bb("onlineupdate");e.action="remove";e.overlay=this;this.fire(e);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs()}}});function c2(hS,hQ,hZ){var hW=false,hU=false,hX=false,h1=new ej(hS.x,hS.y),h0=new ej(hQ.x,hQ.y),hR=fg(h1,hZ),T=fg(h0,hZ),hY;var h3,h2;var hV=hZ.minX,hT=hZ.minY,i=hZ.maxX,e=hZ.maxY;do{if(hR.all==0&&T.all==0){hW=true;hX=true}else{if((hR.all&T.all)!=0){hX=true}else{if(hR.all!=0){hY=hR}else{hY=T}if(hY.top){h3=h1.x+(h0.x-h1.x)*(hT-h1.y)/(h0.y-h1.y);h2=hT}else{if(hY.bottom){h3=h1.x+(h0.x-h1.x)*(e-h1.y)/(h0.y-h1.y);h2=e}else{if(hY.right){h2=h1.y+(h0.y-h1.y)*(i-h1.x)/(h0.x-h1.x);h3=i}else{if(hY.left){h2=h1.y+(h0.y-h1.y)*(hV-h1.x)/(h0.x-h1.x);h3=hV}}}}hU=true;if(hY.all==hR.all){h1.x=Math.round(h3);h1.y=Math.round(h2);hR=fg(h1,hZ)}else{h0.x=Math.round(h3);h0.y=Math.round(h2);T=fg(h0,hZ)}}}}while(!hX);if(hW){return{pixel0:new ej(h1.x,h1.y),pixel1:new ej(h0.x,h0.y),clip:hU?true:false}}}function fg(i,hR){var T={top:0,bottom:0,right:0,left:0,all:0};var e=i.x,hQ=i.y;if(hQ<hR.minY){T.top=8;T.all+=T.top}else{if(hQ>hR.maxY){T.bottom=4;T.all+=T.bottom}}if(e>hR.maxX){T.right=2;T.all+=T.right}else{if(e<hR.minX){T.left=1;T.all+=T.left}}return T}C.extend(a.prototype,{initialize:function(i){w.prototype.initialize.call(this,i);var e=this._config;this.setOptions({fillColor:"",strokeColor:e.strokeColor,strokeWeight:e.strokeWeight,strokeStyle:e.strokeStyle,strokeLineCap:e.strokeLineCap,strokeLineJoin:e.strokeLineJoin,strokeOpacity:e.strokeOpacity});return this.domElement},setPoints:function(hQ){this._clearCache();this.points=w.getGraphPoints(hQ).slice(0);if(this._config.geodesic===true){this.greatCirclePoints.length=0;for(var T=0;T<this.points.length-1;T++){this.calcGreatCirclePoints(this.points[T],this.points[T+1])}}this._calcBounds();this.draw();var e=new bb("onlineupdate");e.overlay=this;this.dispatchEvent(e)},_getDisplayPixels:function(h2,e,h7){var h8=this.map;var hS=[];if(h2.length===0||!this.isVisible()){return[hS]}if(h8._renderType!=="webgl"&&!this.domElement){return[hS]}if(!((C.Platform.ipad||C.Platform.iphone||C.Platform.android)&&h2.length>5000)&&!this._config.enableEditing){var hT=this.getParseCacheIndex(h8.getZoom());if(this._parseCache[hT]){h2=this._parseCache[hT]}else{var T=hE(h2,this.getParseTolerance(h8.getZoom(),h8.config.coordType));h2=this._parseCache[hT]=T}}var h6;var h9=h8.pointToOverlayPixelIn(h2[0],{zoom:e,center:h7});hS.push(h9);if(h9.onBack){h6=true}for(var h3=1,h0=1,hZ=h2.length;h3<hZ;h3++){var hR=h8.pointToOverlayPixelIn(h2[h3],{zoom:e,center:h7});if(hR.onBack){h6=true}if(!hR.equals(hS[h0-1])){hS.push(hR);h0++}}var h5=[];var hX=Math.round(h8.offsetX);var hW=Math.round(h8.offsetY);if(h8._renderType==="webgl"){hX=hW=0}var hV=h8.config.drawMargin;var hU={minX:-hX-hV,minY:-hW-hV,maxX:-hX+hV+h8.width,maxY:-hW+hV+h8.height};for(h3=0,hZ=hS.length-1;h3<hZ;h3++){var h4=hS[h3];var h1=hS[h3+1];var hQ=c2(h4,h1,hU);if(hQ){h5.push(hQ)}}var hY=[[]];for(h3=0,hZ=h5.length;h3<hZ;h3++){if(h5[h3].clip){hY[hY.length-1].push(h5[h3].pixel0);hY[hY.length-1].push(h5[h3].pixel1);if(h5[h3+1]&&h5[h3+1].clip){hY.push([])}}else{hY[hY.length-1].push(h5[h3].pixel0);if(h3===h5.length-1){hY[hY.length-1].push(h5[h3].pixel1)}}}hY.isOnBack=h6;return hY},_getDisplayPixelsGLWithCut:function(h0){var h5=this.map;var hS=[];if(h0.length===0||!this.isVisible()){return[hS]}if(!this._config.enableEditing){var hT=this.getParseCacheIndex(h5.getZoom());if(this._parseCache[hT]){h0=this._parseCache[hT]}else{var T=hE(h0,this.getParseTolerance(h5.getZoom(),h5.config.coordType));h0=this._parseCache[hT]=T}}var h6=h5._polyOverlayBasePoint;var e=h5.getZoomUnits();if(this._parseCacheGLRaw[hT]){hS=this._parseCacheGLRaw[hT]}else{var h7=new ej(h0[0].lng-h6.lng,h0[0].lat-h6.lat);hS.push(h7);for(var h1=1,hY=1,hX=h0.length;h1<hX;h1++){var hR=new ej(h0[h1].lng-h6.lng,h0[h1].lat-h6.lat);if(!hR.equals(hS[hY-1])){hS.push(hR);hY++}}this._parseCacheGLRaw[hT]=hS}var h4=h5.pixelToPointIn(new ej(0,h5.height));var h3=[];var hV=h5.config.drawMarginGL;var hU={minX:Math.round(-hV*e+(h4.lng-h6.lng)),minY:Math.round(-hV*e+(h4.lat-h6.lat)),maxX:Math.round((hV+h5.width)*e+(h4.lng-h6.lng)),maxY:Math.round((hV+h5.height)*e+(h4.lat-h6.lat))};for(h1=0,hX=hS.length-1;h1<hX;h1++){var h2=hS[h1];var hZ=hS[h1+1];var hQ=c2(h2,hZ,hU);if(hQ){h3.push(hQ)}}var hW=[[]];for(h1=0,hX=h3.length;h1<hX;h1++){if(h3[h1].clip){hW[hW.length-1].push([h3[h1].pixel0.x,h3[h1].pixel0.y]);hW[hW.length-1].push([h3[h1].pixel1.x,h3[h1].pixel1.y]);if(h3[h1+1]&&h3[h1+1].clip){hW.push([])}}else{hW[hW.length-1].push([h3[h1].pixel0.x,h3[h1].pixel0.y]);if(h1===h3.length-1){hW[hW.length-1].push([h3[h1].pixel1.x,h3[h1].pixel1.y])}}}return hW},_getDisplayPixelsGL:function(hW){var T=this.map;var hV=[];if(hW.length===0||!this.isVisible()){return[hV]}if(this.greatCirclePoints.length>0){hW=this.greatCirclePoints}if(!this._config.enableEditing){var hU=this.getParseCacheIndex(T.getZoom());if(this._parseCache[hU]){hW=this._parseCache[hU]}else{var hX=hE(hW,this.getParseTolerance(T.getZoom(),T.config.coordType));hW=this._parseCache[hU]=hX}}var e=T._polyOverlayBasePoint;hV.push([hW[0].lng-e.lng,hW[0].lat-e.lat]);for(var hS=1,hR=1,hQ=hW.length;hS<hQ;hS++){var hT=[hW[hS].lng-e.lng,hW[hS].lat-e.lat];if(hT[0]!==hV[hR-1][0]||hT[1]!==hV[hR-1][1]){hV.push(hT);hR++}}hV=[hV];this._addMultipleDrawPath(hV);return hV},_addMultipleDrawPath:function(T,hS,i){if(this._config.clip===true){return}var hR=this.map;hS=hS||hR.getZoom();if(hS>12&&hR.getRenderType()!=="webgl"){return}var e=i?hR.worldSize(hS):c8.WORLD_SIZE_MC;var hQ=T.slice(0);C.each(hQ,function(hT){var hU=[];C.each(hT,function(hV){if(hV.x){hU.push(new ej(hV.x-e,hV.y))}else{hU.push([hV[0]-e,hV[1]])}});T.push(hU)});C.each(hQ,function(hT){var hU=[];C.each(hT,function(hV){if(hV.x){hU.push(new ej(hV.x+e,hV.y))}else{hU.push([hV[0]+e,hV[1]])}});T.push(hU)})},getParsedPoints:function(){var hT=this.map;var i=this.points;var e=[];var T=this;var hS=i.slice(0);hS=[hS];if(this.greatCirclePoints.length>0){hS=[];hS[0]=this.greatCirclePoints}C.each(hS,function(hV){var hU=hE(hV,T.getParseTolerance(hT.getZoom(),hT.config.coordType));e.push(hU)});var hR=0;if(this._bounds.sw.lng<-c8.WORLD_SIZE_MC_HALF){hR=c8.WORLD_SIZE_MC}if(this._bounds.ne.lng>c8.WORLD_SIZE_MC_HALF){hR=-c8.WORLD_SIZE_MC}if(hR===0){return e}var hQ=e.slice(0);C.each(hQ,function(hU){var hV=[];C.each(hU,function(hW){hV.push(new hr(hW.lng+hR,hW.lat))});e.push(hV)});return e},_onMarkerDragging:function(hW){this._editstate=true;var T=hW.currentTarget;var hY=hW.point;var hX=T.index;var i=this.vertexPoints;var hZ;var hU=null;var hQ=null;if(hX===0){var hV=i[hX+2].p;hZ=[hY,hV];hU=new hr((hV.lng+hY.lng)/2,(hV.lat+hY.lat)/2);if(this.vertexMarkers[hX+1]){this.vertexMarkers[hX+1].hide()}}else{if(hX===i.length-1){var hT=i[hX-2].p;hZ=[hT,hY];hU=new hr((hT.lng+hY.lng)/2,(hT.lat+hY.lat)/2);if(this.vertexMarkers[hX-1]){this.vertexMarkers[hX-1].hide()}}else{var hT=i[hX-1].p;var hV=i[hX+1].p;hZ=[hT,hY,hV];if(!T.t){hT=i[hX-2].p;hV=i[hX+2].p;hZ=[hT,hY,hV];hU=new hr((hT.lng+hY.lng)/2,(hT.lat+hY.lat)/2);hQ=new hr((hV.lng+hY.lng)/2,(hV.lat+hY.lat)/2);if(this.vertexMarkers[hX-1]){this.vertexMarkers[hX-1].hide()}if(this.vertexMarkers[hX+1]){this.vertexMarkers[hX+1].hide()}}}}if(!this._temp.dashedLine){var hS=new a(hZ,{strokeStyle:"dashed",strokeColor:this._config.strokeColor,strokeWeight:this._config.strokeWeight,strokeOpacity:this._config.strokeOpacity});this.map.addOverlay(hS);hS.hide();this._temp.dashedLine=hS}else{this._temp.dashedLine.setPoints(hZ);this._temp.dashedLine.show()}var hR=new ha(e3.imgPath+"nodeT.gif",new d9(11,11),{offset:new d9(5,5)});if(!this._temp.preTNode&&hU){this._temp.preTNode=new dr(hU,{icon:hR});this.map.addOverlay(this._temp.preTNode)}else{if(hU){this._temp.preTNode.setPoint(hU)}}if(!this._temp.nexTNode&&hQ){this._temp.nexTNode=new dr(hQ,{icon:hR});this.map.addOverlay(this._temp.nexTNode)}else{if(hQ){this._temp.nexTNode.setPoint(hQ)}}}});C.extend(ep.prototype,{initialize:function(i){w.prototype.initialize.call(this,i);var e=this._config;this.setOptions({fillColor:"",strokeColor:e.strokeColor,strokeWeight:e.strokeWeight,strokeStyle:e.strokeStyle,strokeLineCap:e.strokeLineCap,strokeLineJoin:e.strokeLineJoin,strokeOpacity:e.strokeOpacity});return this.domElement},setPoints:function(i){this._clearCache();this.points=w.getGraphPoints(i).slice(0);this.points=this.calcBezierPoints(this.points,this._cps);this._calcBounds();this.draw();var e=new bb("onlineupdate");e.overlay=this;this.dispatchEvent(e)},_getDisplayPixels:function(h2,e,h7){var h8=this.map;var hS=[];if(h2.length===0||!this.isVisible()){return[hS]}if(h8._renderType!=="webgl"&&!this.domElement){return[hS]}if(!((C.Platform.ipad||C.Platform.iphone||C.Platform.android)&&h2.length>5000)&&!this._config.enableEditing){var hT=this.getParseCacheIndex(h8.getZoom());if(this._parseCache[hT]){h2=this._parseCache[hT]}else{var T=hE(h2,this.getParseTolerance(h8.getZoom(),h8.config.coordType));h2=this._parseCache[hT]=T}}var h6;var h9=h8.pointToOverlayPixelIn(h2[0],{zoom:e,center:h7});hS.push(h9);if(h9.onBack){h6=true}for(var h3=1,h0=1,hZ=h2.length;h3<hZ;h3++){var hR=h8.pointToOverlayPixelIn(h2[h3],{zoom:e,center:h7});if(hR.onBack){h6=true}if(!hR.equals(hS[h0-1])){hS.push(hR);h0++}}var h5=[];var hX=Math.round(h8.offsetX);var hW=Math.round(h8.offsetY);if(h8._renderType==="webgl"){hX=hW=0}var hV=h8.config.drawMargin;var hU={minX:-hX-hV,minY:-hW-hV,maxX:-hX+hV+h8.width,maxY:-hW+hV+h8.height};for(h3=0,hZ=hS.length-1;h3<hZ;h3++){var h4=hS[h3];var h1=hS[h3+1];var hQ=c2(h4,h1,hU);if(hQ){h5.push(hQ)}}var hY=[[]];for(h3=0,hZ=h5.length;h3<hZ;h3++){if(h5[h3].clip){hY[hY.length-1].push(h5[h3].pixel0);hY[hY.length-1].push(h5[h3].pixel1);if(h5[h3+1]&&h5[h3+1].clip){hY.push([])}}else{hY[hY.length-1].push(h5[h3].pixel0);if(h3===h5.length-1){hY[hY.length-1].push(h5[h3].pixel1)}}}hY.isOnBack=h6;return hY},_getDisplayPixelsGLWithCut:function(h0){var h5=this.map;var hS=[];if(h0.length===0||!this.isVisible()){return[hS]}if(!this._config.enableEditing){var hT=this.getParseCacheIndex(h5.getZoom());if(this._parseCache[hT]){h0=this._parseCache[hT]}else{var T=hE(h0,this.getParseTolerance(h5.getZoom(),h5.config.coordType));h0=this._parseCache[hT]=T}}var h6=h5._polyOverlayBasePoint;var e=h5.getZoomUnits();if(this._parseCacheGLRaw[hT]){hS=this._parseCacheGLRaw[hT]}else{var h7=new ej(h0[0].lng-h6.lng,h0[0].lat-h6.lat);hS.push(h7);for(var h1=1,hY=1,hX=h0.length;h1<hX;h1++){var hR=new ej(h0[h1].lng-h6.lng,h0[h1].lat-h6.lat);if(!hR.equals(hS[hY-1])){hS.push(hR);hY++}}this._parseCacheGLRaw[hT]=hS}var h4=h5.pixelToPointIn(new ej(0,h5.height));var h3=[];var hV=h5.config.drawMarginGL;var hU={minX:Math.round(-hV*e+(h4.lng-h6.lng)),minY:Math.round(-hV*e+(h4.lat-h6.lat)),maxX:Math.round((hV+h5.width)*e+(h4.lng-h6.lng)),maxY:Math.round((hV+h5.height)*e+(h4.lat-h6.lat))};for(h1=0,hX=hS.length-1;h1<hX;h1++){var h2=hS[h1];var hZ=hS[h1+1];var hQ=c2(h2,hZ,hU);if(hQ){h3.push(hQ)}}var hW=[[]];for(h1=0,hX=h3.length;h1<hX;h1++){if(h3[h1].clip){hW[hW.length-1].push([h3[h1].pixel0.x,h3[h1].pixel0.y]);hW[hW.length-1].push([h3[h1].pixel1.x,h3[h1].pixel1.y]);if(h3[h1+1]&&h3[h1+1].clip){hW.push([])}}else{hW[hW.length-1].push([h3[h1].pixel0.x,h3[h1].pixel0.y]);if(h1===h3.length-1){hW[hW.length-1].push([h3[h1].pixel1.x,h3[h1].pixel1.y])}}}return hW},_getDisplayPixelsGL:function(hW){var T=this.map;var hV=[];if(hW.length===0||!this.isVisible()){return[hV]}if(this.greatCirclePoints.length>0){hW=this.greatCirclePoints}if(!this._config.enableEditing){var hU=this.getParseCacheIndex(T.getZoom());if(this._parseCache[hU]){hW=this._parseCache[hU]}else{var hX=hE(hW,this.getParseTolerance(T.getZoom(),T.config.coordType));hW=this._parseCache[hU]=hX}}var e=T._polyOverlayBasePoint;hV.push([hW[0].lng-e.lng,hW[0].lat-e.lat]);for(var hS=1,hR=1,hQ=hW.length;hS<hQ;hS++){var hT=[hW[hS].lng-e.lng,hW[hS].lat-e.lat];if(hT[0]!==hV[hR-1][0]||hT[1]!==hV[hR-1][1]){hV.push(hT);hR++}}hV=[hV];this._addMultipleDrawPath(hV);return hV},_addMultipleDrawPath:function(T,hS,i){if(this._config.clip===true){return}var hR=this.map;hS=hS||hR.getZoom();if(hS>12&&hR.getRenderType()!=="webgl"){return}var e=i?hR.worldSize(hS):c8.WORLD_SIZE_MC;var hQ=T.slice(0);C.each(hQ,function(hT){var hU=[];C.each(hT,function(hV){if(hV.x){hU.push(new ej(hV.x-e,hV.y))}else{hU.push([hV[0]-e,hV[1]])}});T.push(hU)});C.each(hQ,function(hT){var hU=[];C.each(hT,function(hV){if(hV.x){hU.push(new ej(hV.x+e,hV.y))}else{hU.push([hV[0]+e,hV[1]])}});T.push(hU)})},});C.extend(fl.prototype,{setPoints:function(e){if(!e){return}this._clearCache();this.points=this._unifyArgs(e);if(this._config.geodesic===true){this.calcGreatCirclePoints(en.convertMC2LL(this.points[0][0]),en.convertMC2LL(this.points[0][1]))}this._calcBounds()},_getDisplayPixels:function(e,hT,hQ){var hS=this.map;var T=[];var i=this;var hR=e.slice(0);if(this.greatCirclePoints.length>0){hR[0]=this.greatCirclePoints}C.each(hR,function(hV,hU){var hW=i._getEachDisplayPixels(hV,hU,hT,hQ);C.each(hW,function(hX){T.push(hX)})});this._addMultipleDrawPath(T,hT,true);return T},_addMultipleDrawPath:function(T,hS,i){if(this._config.clip===true){return}var hR=this.map;hS=hS||hR.getZoom();if(hS>12&&hR.getRenderType()!=="webgl"){return}var e=i?hR.worldSize(hS):c8.WORLD_SIZE_MC;var hQ=T.slice(0);C.each(hQ,function(hT){var hU=[];C.each(hT,function(hV){if(hV.x){hU.push(new ej(hV.x-e,hV.y))}else{hU.push([hV[0]-e,hV[1]])}});T.push(hU)});C.each(hQ,function(hT){var hU=[];C.each(hT,function(hV){if(hV.x){hU.push(new ej(hV.x+e,hV.y))}else{hU.push([hV[0]+e,hV[1]])}});T.push(hU)})},_getDisplayPixelsGL:function(e){var T=[];var i=this;var hQ=e.slice(0);if(this.greatCirclePoints.length>0){hQ[0]=this.greatCirclePoints}C.each(hQ,function(hS,hR){var hT=i._getEachDisplayPixelsGL(hS,hR);C.each(hT,function(hU){T.push(hU)})});this._addMultipleDrawPath(T);return T},_getEachDisplayPixels:function(h0,hU,hT,hX){var e=this.map;var hZ=[];if(h0.length===0||!this.domElement||!this.isVisible()){return[hZ]}h0=this._simplification(h0,hU);var hY;var hW=e.pointToOverlayPixelIn(h0[0],{zoom:hT,center:hX});hZ.push(hW);if(hW.onBack){hY=true}for(var hS=1,hQ=1,T=h0.length;hS<T;hS++){var hV=e.pointToOverlayPixelIn(h0[hS],{zoom:hT,center:hX});if(hV.onBack){hY=true}if(!hV.equals(hZ[hQ-1])){hZ.push(hV);hQ++}}if(e.getZoom()<5||this._config.clip===false){return[hZ]}var hR=this._clipLine(hZ);hR.isOnBack=hY;return hR},_simplification:function(T,i){if(this._config.enableEditing){return T}var hR=this.map;var hQ=this.getParseCacheIndex(hR.getZoom());if(this._parseCache[hQ]&&this._parseCache[hQ][i]){return this._parseCache[hQ][i]}else{var e=hE(T,this.getParseTolerance(hR.getZoom(),hR.config.coordType));if(!this._parseCache[hQ]){this._parseCache[hQ]=[]}this._parseCache[hQ][i]=e;return e}},_clipLine:function(hQ){var e=this.map;var hW=[];var hZ=Math.round(e.offsetX);var hY=Math.round(e.offsetY);var h0=e.config.drawMargin;var hS={minX:-hZ-h0,minY:-hY-h0,maxX:-hZ+h0+e.width,maxY:-hY+h0+e.height};for(var hT=0,T=hQ.length-1;hT<T;hT++){var hV=hQ[hT];var hU=hQ[hT+1];var hX=c2(hV,hU,hS);if(hX){hW.push(hX)}}var hR=[[]];for(var hT=0,T=hW.length;hT<T;hT++){if(hW[hT].clip){hR[hR.length-1].push(hW[hT].pixel0);hR[hR.length-1].push(hW[hT].pixel1);if(hW[hT+1]&&hW[hT+1].clip){hR.push([])}}else{hR[hR.length-1].push(hW[hT].pixel0);if(hT===hW.length-1){hR[hR.length-1].push(hW[hT].pixel1)}}}return hR},_getEachDisplayPixelsGL:function(hW,hT){var T=this.map;var hV=[];if(hW.length===0||!this.isVisible()){return[hV]}hW=this._simplification(hW,hT);if(this._config.clip===true){return this._clipLineGL(hW,hT)}var e=T._polyOverlayBasePoint;hV.push([hW[0].lng-e.lng,hW[0].lat-e.lat]);for(var hS=1,hR=1,hQ=hW.length;hS<hQ;hS++){var hU=[hW[hS].lng-e.lng,hW[hS].lat-e.lat];if(hU[0]!==hV[hR-1][0]||hU[1]!==hV[hR-1][1]){hV.push(hU);hR++}}return[hV]},_clipLineGL:function(h0,hT){var h5=this.map;var hS=this.getParseCacheIndex(h5.getZoom());var h6=h5._polyOverlayBasePoint;var hR=[];if(this._parseCacheGLRaw[hS]&&this._parseCacheGLRaw[hS][hT]){hR=this._parseCacheGLRaw[hS][hT]}else{var h7=new ej(h0[0].lng-h6.lng,h0[0].lat-h6.lat);hR.push(h7);for(var h1=1,hY=1,hX=h0.length;h1<hX;h1++){var hQ=new ej(h0[h1].lng-h6.lng,h0[h1].lat-h6.lat);if(!hQ.equals(hR[hY-1])){hR.push(hQ);hY++}}if(!this._parseCacheGLRaw[hS]){this._parseCacheGLRaw[hS]=[]}this._parseCacheGLRaw[hS][hT]=hR}var e=h5.getZoomUnits();var h4=h5.pixelToPointIn(new ej(0,h5.height));var h3=[];var hV=h5.config.drawMarginGL;var hU={minX:Math.round(-hV*e+(h4.lng-h6.lng)),minY:Math.round(-hV*e+(h4.lat-h6.lat)),maxX:Math.round((hV+h5.width)*e+(h4.lng-h6.lng)),maxY:Math.round((hV+h5.height)*e+(h4.lat-h6.lat))};for(h1=0,hX=hR.length-1;h1<hX;h1++){var h2=hR[h1];var hZ=hR[h1+1];var T=c2(h2,hZ,hU);if(T){h3.push(T)}}var hW=[[]];for(h1=0,hX=h3.length;h1<hX;h1++){if(h3[h1].clip){hW[hW.length-1].push([h3[h1].pixel0.x,h3[h1].pixel0.y]);hW[hW.length-1].push([h3[h1].pixel1.x,h3[h1].pixel1.y]);if(h3[h1+1]&&h3[h1+1].clip){hW.push([])}}else{hW[hW.length-1].push([h3[h1].pixel0.x,h3[h1].pixel0.y]);if(h1===h3.length-1){hW[hW.length-1].push([h3[h1].pixel1.x,h3[h1].pixel1.y])}}}return hW},getParsedPoints:function(){var hT=this.map;var i=this.points;var e=[];var T=this;var hS=i.slice(0);if(this.greatCirclePoints.length>0){hS[0]=this.greatCirclePoints}C.each(hS,function(hV){var hU=hE(hV,T.getParseTolerance(hT.getZoom(),hT.config.coordType));e.push(hU)});var hR=0;if(this._bounds.sw.lng<-c8.WORLD_SIZE_MC_HALF){hR=c8.WORLD_SIZE_MC}if(this._bounds.ne.lng>c8.WORLD_SIZE_MC_HALF){hR=-c8.WORLD_SIZE_MC}if(hR===0){return e}var hQ=e.slice(0);C.each(hQ,function(hU){var hV=[];C.each(hU,function(hW){hV.push(new hr(hW.lng+hR,hW.lat))});e.push(hV)});console.log(e);return e},setPointAt:function(T,e,hQ){hQ=hQ||0;if(!e||!this.points[hQ][T]||!this.points[hQ][T]){return}this._clearCache();this.points[hQ][T]=new hr(e.lng,e.lat);if(this._config.geodesic===true){this.calcGreatCirclePoints(en.convertMC2LL(this.points[hQ][0]),en.convertMC2LL(this.points[hQ][1]))}this._calcBounds();this.draw();var i=new bb("onlineupdate");i.overlay=this;this.dispatchEvent(i)},calcGreatCirclePoints:function(hQ,T){if(hQ.equals(T)){return}var e=en.getDistance(dK(hQ.lng),dK(hQ.lat),dK(T.lng),dK(T.lat));if(e<250000){return}this.greatCirclePoints.length=0;var hU=Math.round(e/150000);var hY=this.calcAngularDistance(hQ,T);this.greatCirclePoints.push(this.points[0][0]);var hX=hQ.lng;var hW=this.points[0][0];for(var hR=0;hR<hU;hR++){var hT=this.calcMiddlePoint(hQ,T,hR/hU,hY);var hV=en.convertLL2MC(hT);var hS=hV.lng;var hZ=bP(hV,hW);if(hZ>30037726){if(hV.lng<hW.lng){hV.lng+=c8.WORLD_SIZE_MC}else{hV.lng-=c8.WORLD_SIZE_MC}}this.greatCirclePoints.push(hV);hW=hV}this.greatCirclePoints.push(this.points[0][1]);var hZ=bP(this.points[0][1],hW);if(hZ>30037726){if(this.points[0][1].lng<hW.lng){this.points[0][1].lng+=c8.WORLD_SIZE_MC}else{this.points[0][1].lng-=c8.WORLD_SIZE_MC}}},calcMiddlePoint:function(hX,hW,hY,h2){var hR=hX.lat;var hQ=hW.lat;var h1=hX.lng;var hZ=hW.lng;var h3=dK(hR);var h0=dK(hQ);var i=dK(h1);var e=dK(hZ);var h5=Math.sin((1-hY)*h2)/Math.sin(h2);var h4=Math.sin(hY*h2)/Math.sin(h2);var hU=h5*Math.cos(h3)*Math.cos(i)+h4*Math.cos(h0)*Math.cos(e);var hT=h5*Math.cos(h3)*Math.sin(i)+h4*Math.cos(h0)*Math.sin(e);var hS=h5*Math.sin(h3)+h4*Math.sin(h0);var T=Math.atan2(hS,Math.sqrt(Math.pow(hU,2)+Math.pow(hT,2)));var hV=Math.atan2(hT,hU);return new hr(de(hV),de(T))},calcAngularDistance:function(hR,i){var hS=dK(hR.lat);var hQ=dK(i.lat);var T=dK(hR.lng);var e=dK(i.lng);return Math.acos(Math.sin(hS)*Math.sin(hQ)+Math.cos(hS)*Math.cos(hQ)*Math.cos(Math.abs(e-T)))}});C.extend(aR.prototype,{initialize:function(i){w.prototype.initialize.call(this,i);var e=this._config;this.setOptions({strokeColor:e.strokeColor,strokeWeight:e.strokeWeight,strokeStyle:e.strokeStyle,fillColor:e.fillColor,strokeOpacity:e.strokeOpacity,fillOpacity:e.fillOpacity});return this.domElement},setPointAt:function(T,e){if(!this._userPoints[T]){return}this._clearCache();this._userPoints[T]=new hr(e.lng,e.lat);this.points[T]=new hr(e.lng,e.lat);if(T===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new hr(e.lng,e.lat)}this._calcBounds();this.draw();var i=new bb("onlineupdate");i.overlay=this;this.dispatchEvent(i)},setPositionAt:function(i,e){if(!this._userPoints[i]){return}var T=en.convertLL2MC(e);this.setPointAt(i,T);if(this._config.enableEditing===true&&!this._config.geodesic){this.clearVertexs();this.addVertexs()}},_onMarkerDragging:function(hX){this._editstate=true;var hQ=hX.currentTarget;var hZ=hX.point;var hY=hQ.index;var i=this.vertexPoints;var h1;var hU=i[2].p;var h0=i[i.length-2].p;var hV=null;var T=null;if(hY===0){var hW=i[hY+2].p;h1=[h0,hZ,hW];if(!hQ.t){hV=new hr((h0.lng+hZ.lng)/2,(h0.lat+hZ.lat)/2);T=new hr((hW.lng+hZ.lng)/2,(hW.lat+hZ.lat)/2)}}else{if(hY===i.length-1){var hT=i[hY-2].p;h1=[hT,hZ,hU];if(!hQ.t){hV=new hr((hT.lng+hZ.lng)/2,(hT.lat+hZ.lat)/2);T=new hr((hU.lng+hZ.lng)/2,(hU.lat+hZ.lat)/2)}}else{var hT=i[hY-1].p;var hW=i[hY+1].p;h1=[hT,hZ,hW];if(!hQ.t){hT=i[hY-2].p;hW=i[hY+2].p;h1=[hT,hZ,hW];hV=new hr((hT.lng+hZ.lng)/2,(hT.lat+hZ.lat)/2);T=new hr((hW.lng+hZ.lng)/2,(hW.lat+hZ.lat)/2);if(this.vertexMarkers[hY-1]){this.vertexMarkers[hY-1].hide()}if(this.vertexMarkers[hY+1]){this.vertexMarkers[hY+1].hide()}}}}if(!this._temp.dashedLine){var hS=new a(h1,{strokeStyle:"dashed",strokeColor:this._config.strokeColor,strokeWeight:this._config.strokeWeight,strokeOpacity:this._config.strokeOpacity});this.map.addOverlay(hS);this._temp.dashedLine=hS}else{this._temp.dashedLine.setPoints(h1)}var hR=new ha(e3.imgPath+"nodeT.gif",new d9(11,11),{offset:new d9(5,5)});if(!this._temp.preTNode&&hV){this._temp.preTNode=new dr(hV,{icon:hR});this.map.addOverlay(this._temp.preTNode)}else{if(hV){this._temp.preTNode.setPoint(hV)}}if(!this._temp.nexTNode&&T){this._temp.nexTNode=new dr(T,{icon:hR});this.map.addOverlay(this._temp.nexTNode)}else{if(T){this._temp.nexTNode.setPoint(T)}}},getFillStyleForGL:function(){var T=this._config.fillColor.substr(1);var e=this._config.fillOpacity;var i;if(T.length===3){i=[parseInt(T.substr(0,1)+T.substr(0,1),16),parseInt(T.substr(1,1)+T.substr(1,1),16),parseInt(T.substr(2,1)+T.substr(2,1),16),e]}else{i=[parseInt(T.substr(0,2),16),parseInt(T.substr(2,2),16),parseInt(T.substr(4,2),16),e]}this._fillStyleInfoForGL=i.join(",");return this._fillStyleInfoForGL},buildFillVertex:function(hT){var hX=[];var hV=this.getParseCacheIndex(this.map.getZoom());if(this._areaCacheGL[hV]){return this._areaCacheGL[hV]}var hW=this._getDisplayPixelsGL(this.points);if(hW.pointsArray&&hW.pointsArray.length<3){this._areaCacheGL[hV]=[[],hX];return this._areaCacheGL[hV]}var hR;var hS=[];var hQ=0;for(var T=0;T<hW.length;T++){if(T>0){hQ+=hW[T-1].length}hR=hT(hW[T].pointsArray,null,null,hQ);for(var e=0,hU=hR.length;e<hU;e+=3){hX.push(hR[e],hR[e+1],hR[e+2])}hS=hS.concat(hW[T].pointsArray)}var hY=[new Float32Array(hS),new Uint16Array(hX)];this._areaCacheGL[hV]=hY;return hY}});C.extend(f7.prototype,{initialize:function(e){aR.prototype.initialize.call(this,e);this.points=this._getPerimeterPoints(this.point,this.radius);this._calcBounds();return this.domElement},_addDom:function(){if(this.map._renderType==="webgl"){return}var e=this._drawer=bw.getDrawer(this.map);this.domElement=e.addStandardCircle()},draw:function(i){if(!this.domElement){return}i=i||{};var T=this.getDisplayGeometry(i.center,i.zoom);if(this._drawer){this._drawer.setStandardCircleGeometry(this.domElement,T)}},getDisplayGeometry:function(e,i){var T=this.map.pointToOverlayPixelIn(this.point,{zoom:i,center:e});var hR=Math.round(this._radiusMercator/this.map.getZoomUnits(i));var hQ={cx:T.x,cy:T.y,radius:hR};return hQ},setPoint:function(e,T){if(!e){return}this._clearCache();if(!T){this.vertexPoints=null}this.point=e;this.latLng=en.convertMC2LL(e);this.points=this._getPerimeterPoints(e,this.radius);this._calcBounds();this.draw();var i=new bb("onlineupdate");i.overlay=this;this.dispatchEvent(i)},setRadius:function(e,T){this._clearCache();if(!T){this.vertexPoints=null}this.radius=Math.abs(e);this.points=this._getPerimeterPoints(this.point,this.radius);this._calcBounds();this.draw();var i=new bb("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getParseTolerance:function(i,e){if(this._config.getParseTolerance){return this._config.getParseTolerance(i,e)}return f7.parseTolerance[e][this.getParseCacheIndex(i)]},_onMarkerDragging:function(hT){var hR;var hV;var hW;var i=this.map;this._editstate=true;var hQ=hT.currentTarget;var hU=hQ.index;var T=this.vertexPoints;var hS=T[0].p;var hX=T[T.length-1].p;if(hU==0){hV=hQ.point;hW=hX}else{hV=hS;hW=hQ.point}hR=en.getDistanceByMC(hV,hW);this.setRadius(hR,true);this.setCenterIn(hV,true)},_onMarkerDragend:function(hR){this._editstate=false;var hQ=hR.currentTarget;var T=hQ.index;this.vertexPoints[0]={p:this.point,t:0};if(T==1){this.vertexPoints[1]={p:hQ.point,t:0}}this.clearVertexs();this.addVertexs();var i=new bb("oneditend");i.pixel=hR.pixel;i.point=hR.point;i.latLng=hR.latLng;i.overlay=this;this.dispatchEvent(i)},getVertexPoints:function(){if(!this.vertexPoints){var e=[];e.push({p:this.point,t:0});e.push({p:this.points[Math.floor(this.points.length*3/4)],t:0});this.vertexPoints=e}return this.vertexPoints}});C.extend(bs.prototype,{initialize:function(i){w.prototype.initialize.call(this,i);var e=this._config;this.setOptions({topFillColor:e.topFillColor,topFillOpacity:e.topFillOpacity,sideFillColor:e.sideFillColor,sideFillOpacity:e.sideFillOpacity,altitude:e.altitude});return this.domElement},setPointAt:function(T,e){if(!this._userPoints[T]){return}this._clearCache();this._userPoints[T]=new hr(e.lng,e.lat);this.points[T]=new hr(e.lng,e.lat);if(T===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new hr(e.lng,e.lat)}this._calcBounds();this.draw();var i=new bb("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getFillStyleForGL:function(){var i=this._config.topFillColor.substr(1);var hR=this._config.topFillOpacity;var T=this._config.sideFillColor.substr(1);var hQ=this._config.sideFillOpacity;var e;var hS;if(i.length===3){e=[parseInt(i.substr(0,1)+i.substr(0,1),16),parseInt(i.substr(1,1)+i.substr(1,1),16),parseInt(i.substr(2,1)+i.substr(2,1),16),hR*255]}else{e=[parseInt(i.substr(0,2),16),parseInt(i.substr(2,2),16),parseInt(i.substr(4,2),16),hR*255]}if(T.length===3){hS=[parseInt(T.substr(0,1)+T.substr(0,1),16),parseInt(T.substr(1,1)+T.substr(1,1),16),parseInt(T.substr(2,1)+T.substr(2,1),16),hQ*255]}else{hS=[parseInt(T.substr(0,2),16),parseInt(T.substr(2,2),16),parseInt(T.substr(4,2),16),hQ*255]}return{top:e,side:hS}},buildFillVertex:function(hS,ic){var hR=this.getParseCacheIndex(this.map.getZoom());if(this._areaCacheGL[hR]&&!ic){return this._areaCacheGL[hR]}var ig=this._getDisplayPixelsGL(this.points);if(ig.pointsArray&&ig.pointsArray.length<3){this._areaCacheGL[hR]={vertex:[],index:[]};return this._areaCacheGL[hR]}var ia=this.getFillStyleForGL();var h3=ia.top;var h7=ia.side;var hW=this._config.altitude;var ik=[0,0,1];var hY=[];var T=[];var h9=0;for(var id=0;id<ig.length;id++){if(id>0){h9+=(ig[id-1].length-1)*5}var h6=ig[id].pointsArray;h6.splice(-2,2);var il=this.getClockwise(h6);if(il){h6=this.rev(h6)}for(var ih=0;ih<h6.length;ih+=2){hY.push([h6[ih],h6[ih+1],hW,ik[0],ik[1],ik[2],h3[0],h3[1],h3[2],h3[3]])}var e=hS(h6,null,null,h9);for(var ih=0,h1=e.length;ih<h1;ih+=3){T.push(e[ih],e[ih+1],e[ih+2])}for(var ih=0,h8=h6.length;ih<h8;ih+=2){var hX=h6[ih];var hV=h6[ih+1];var h5=[hX,hV,0];var h4=[hX,hV,hW];var hQ=ih+2;var hU=ih+3;if(ih===h8-2){hQ=0;hU=1}var ij=h6[hQ];var ii=h6[hU];var h2=[ij,ii,0];var h0=[ij,ii,hW];var ie=[h2[0]-h5[0],h2[1]-h5[1],h2[2]-h5[2]];var ib=[h4[0]-h5[0],h4[1]-h5[1],h4[2]-h5[2]];var ik=[];vec3.cross(ik,ie,ib);h5.push(ik[0],ik[1],ik[2]);h4.push(ik[0],ik[1],ik[2]);h2.push(ik[0],ik[1],ik[2]);h0.push(ik[0],ik[1],ik[2]);h5.push(h7[0],h7[1],h7[2],h7[3]);h4.push(h7[0],h7[1],h7[2],h7[3]);h2.push(h7[0],h7[1],h7[2],h7[3]);h0.push(h7[0],h7[1],h7[2],h7[3]);var hT=hY.length;hY.push(h5);hY.push(h4);hY.push(h2);hY.push(h0);T.push(hT,hT+2,hT+3,hT,hT+3,hT+1)}}var hZ={vertex:this.convertBuilding3dToTypedArray(hY),index:new Uint16Array(T)};this._areaCacheGL[hR]=hZ;return hZ},getClockwise:function(hW){var hS=hW.length;if(hS<6){return false}var hQ=hW[hS-2];var hV=hW[hS-1];var T=hW[0];var hU=hW[1];var e=hW[2];var hT=hW[3];for(var hR=2;hR<hS;hR+=2){if(hW[hR]>T){hQ=hW[hR-2];hV=hW[hR-1];T=hW[hR];hU=hW[hR+1];if(hR+2>=hS){e=hW[0];hT=hW[1]}else{e=hW[hR+2];hT=hW[hR+3]}}}return((T-hQ)*(hT-hU)-(hU-hV)*(e-T)<0)},rev:function(hQ){var e=[];for(var T=hQ.length-1;T>=0;T-=2){e[hQ.length-1-T]=hQ[T-1];e[hQ.length-1-T+1]=hQ[T]}return e},convertBuilding3dToTypedArray:function(hT){var T=hT.length;var hQ=new Float32Array(T*7);var hS=new DataView(hQ.buffer);var e=0;for(var hR=0;hR<hT.length;hR++){e=hR*7;hQ[e+0]=hT[hR][0];hQ[e+1]=hT[hR][1];hQ[e+2]=hT[hR][2];hQ[e+3]=hT[hR][3];hQ[e+4]=hT[hR][4];hQ[e+5]=hT[hR][5];hS.setUint8(e*4+24,hT[hR][6]);hS.setUint8(e*4+25,hT[hR][7]);hS.setUint8(e*4+26,hT[hR][8]);hS.setUint8(e*4+27,hT[hR][9])}return hQ}});C.extend(dW.prototype,{initialize:function(e){w.prototype.initialize.call(this,e);return this.domElement},getFillStyleForGL:function(){if(!this._config.url){return}switch(this._config.type){case"image":var e={type:"image",texture:this._config.url,opacity:this._config.opacity};this._fillStyleInfoForGL=e;break;case"video":var e={type:"video",texture:this._config.url,opacity:this._config.opacity};this._fillStyleInfoForGL=e;break;case"canvas":var e={type:"canvas",texture:this._config.url,opacity:this._config.opacity};this._fillStyleInfoForGL=e;break}return this._fillStyleInfoForGL},buildFillVertex:function(hT){var hW=[];var hV=this._getDisplayPixelsGL(this.points);var hR;var hS=[];var hQ=0;for(var T=0;T<hV.length;T++){if(T>0){hQ+=hV[T-1].length}hR=hT(hV[T].pointsArray,null,null,hQ);for(var e=0,hU=hR.length;e<hU;e+=3){hW.push(hR[e],hR[e+1],hR[e+2])}hS=hS.concat(hV[T].pointsArray)}var hX=[new Float32Array(hS),new Uint16Array(hW)];return hX}});function cW(e){this._map=e;this._canvasAttrName={strokeweight:"lineWidth",strokecolor:"strokeStyle",fillcolor:"fillStyle",strokeopacity:"globalAlpha",fillopacity:"globalAlpha"};this._type="canvas"}cW.prototype=new dV();var b1=cW.prototype;b1.addLine=function(){var i=S("canvas");this._map.getPanes().mapPane.appendChild(i);i.style.position="absolute";var e=i.getContext("2d");e.lineCap="round";e.lineJoin="round";e.save();return i};b1.setPath=function(T,i){if(!T){return}var e=T.getContext("2d");this._setCanvasPosition(T);this._clearCanvas(e);var hR=parseInt(T.style.top);var hQ=parseInt(T.style.left);e.beginPath();C.each(i,function(hU){if(hU.length===0){return}e.moveTo(hU[0].x-hQ,hU[0].y-hR);for(var hT=1,hS=hU.length;hT<hS;hT++){e.lineTo(hU[hT].x-hQ,hU[hT].y-hR)}});this._drawCanvas(T)};b1.setAttribute=function(hQ,i,hR){if(!hQ){return}var e=hQ.getContext("2d");var T=this._getAttributeName(i);if(T){e[T]=hR}hQ.setAttribute("_"+i,hR||"");e.save();this._clearCanvas(e);this._drawCanvas(hQ)};b1._getAttributeName=function(e){return this._canvasAttrName[e]||e};b1._setCanvasPosition=function(hR){var i=this._map;var hW=i.config.drawMargin;var T=i.width+2*hW;var hT=i.height+2*hW;var hQ=-i.offsetX-hW;var hS=-i.offsetY-hW;var hV=hR.getContext("2d");var hU={strokeStyle:hV.strokeStyle,fillStyle:hV.fillStyle,globalAlpha:hV.globalAlpha,lineWidth:hV.lineWidth,lineCap:"round",lineJoin:"round"};hR.setAttribute("width",T);hR.setAttribute("height",hT);for(var e in hU){hV[e]=hU[e]}hV.save();var hX=hR.style;hX.top=hS+"px";hX.left=hQ+"px"};b1._clearCanvas=function(e){e.clearRect(0,0,9999,9999)};b1._drawCanvas=function(i){var e=i.getContext("2d");e.globalAlpha=i.getAttribute("_fillopacity");if(e.globalAlpha!=0&&i.getAttribute("_fillcolor")){e.fill()}e.globalAlpha=i.getAttribute("_strokeopacity");if(e.globalAlpha!==0&&i.getAttribute("_strokecolor")){e.stroke()}};b1.addStandardCircle=function(){var i=S("canvas");this._map.getPanes().mapPane.appendChild(i);i.style.position="absolute";var e=i.getContext("2d");e.lineCap="round";e.lineJoin="round";e.save();return i};b1.setStandardCircleGeometry=function(hQ,hT){if(!hQ){return}var T=hQ.getContext("2d");this._setCanvasPosition(hQ);this._clearCanvas(T);var hS=parseInt(hQ.style.top);var hR=parseInt(hQ.style.left);var i=hT.cx-hR;var hU=hT.cy-hS;var e=hT.radius;T.beginPath();T.arc(i,hU,e,0,Math.PI*2);this._drawCanvas(hQ)};function dV(){}DrawerPrototype=dV.prototype;DrawerPrototype.setPalette=function(){};DrawerPrototype.addLine=function(){throw"addLine接口没有实现"};DrawerPrototype.setAttribute=function(){throw"setAttribute接口没有实现"};DrawerPrototype.setPath=function(){throw"setPath接口没有实现"};DrawerPrototype.getType=function(){return this._type};var bw={getDrawer:function(e){if(e._renderType==="webgl"){return null}if(!bw["_"+e.hashCode]){bw["_"+e.hashCode]={}}switch(e.config.drawer){case BMAP_SVG_DRAWER:return bw.getSvgDrawer(e);case BMAP_VML_DRAWER:return bw.getVmlDrawer(e);case BMAP_CANVAS_DRAWER:return bw.getCanvasDrawer(e);default:break}if(bw.isSupportSvg()){return bw.getSvgDrawer(e)}if(bw.isSupportVml()){return bw.getVmlDrawer(e)}if(bw.isSupportCanvas()){return bw.getCanvasDrawer(e)}},getSvgDrawer:function(e){if(!bw["_"+e.hashCode]._svgDrawer){bw["_"+e.hashCode]._svgDrawer=new fU(e)}return bw["_"+e.hashCode]._svgDrawer},getVmlDrawer:function(e){if(!bw["_"+e.hashCode]._vmlDrawer){bw["_"+e.hashCode]._vmlDrawer=new hw(e)}return bw["_"+e.hashCode]._vmlDrawer},getCanvasDrawer:function(e){if(!bw["_"+e.hashCode]._canvasDrawer){bw["_"+e.hashCode]._canvasDrawer=new cW(e)}return bw["_"+e.hashCode]._canvasDrawer},isSupportVml:function(){if(typeof bw.supportVml!="undefined"){return bw.supportVml}var T=document.body.appendChild(S("div"));T.innerHTML=\'<v:shape id="vml_tester1" adj="1" />\';var i=T.firstChild;if(!i.style){return false}i.style.behavior="url(#default#VML)";var e=i?typeof i.adj=="object":true;T.parentNode.removeChild(T);bw.supportVml=e;return e},isSupportSvg:function(){if(typeof bw.supportSvg=="undefined"){bw.supportSvg=!!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.1")}return bw.supportSvg},isSupportCanvas:function(){if(typeof bw.supportCanvas=="undefined"){bw.supportCanvas=!!S("canvas").getContext}return bw.supportCanvas}};bo.DrawerSelector=bw;function fU(e){this._map=e;this.SVG_NS="http://www.w3.org/2000/svg";this._svgAttrName={strokeweight:"stroke-width",strokecolor:"stroke",fillcolor:"fill",strokeopacity:"stroke-opacity",fillopacity:"fill-opacity",strokestyle:"stroke-dasharray",strokelinecap:"stroke-linecap",strokelinejoin:"stroke-linejoin"};this._svg=this._createSvg();this._type="svg"}fU.prototype=new dV();var bD=fU.prototype;bD._createSvg=function(){var e=this._svg=S("svg",{},this.SVG_NS);e.setAttribute("version","1.1");e.setAttribute("type","system");var i=e.style;i.position="absolute";i.MozUserSelect="none";this.setPalette();this._map.getPanes().mapPane.appendChild(e);return e};bD.setPalette=function(){if(!this._svg){return}var T=this._svg;var hU=this._map;var i=hU.config.drawMargin;var hR=hU.width+2*i;var e=hU.height+2*i;var hT=-hU.offsetX-i;var hS=-hU.offsetY-i;this.setAttribute(T,"x",hR+"px");this.setAttribute(T,"y",e+"px");this.setAttribute(T,"viewBox",hT+" "+hS+" "+hR+" "+e);var hQ=T.style;hQ.top=hS+"px";hQ.left=hT+"px";hQ.width=hR+"px";hQ.height=e+"px"};bD.getPalette=function(){return this._svg};bD.setAttribute=function(hR,T,hS,hQ,i){if(!hR){return}if(T==="strokestyle"){i=i||{};var hQ=i.strokeWeight||4;var e=i.dashArray||null;switch(hS){case"dashed":if(e){hS=e.join(",")}else{hS=hQ*2}break;case"dotted":if(i.strokeLineCap==="round"){hS="1,"+2*hQ}else{hS=hQ}break;default:hS=0;break}}var hT=hS||"none";if(hS===0){hT=0}hR.setAttributeNS(null,this._getAttributeName(T),hT);return hR};bD._getAttributeName=function(e){return this._svgAttrName[e]||e};bD.addLine=function(){var e=S("path",{},this.SVG_NS);this.setAttribute(e,"fill-rule","evenodd");this._svg.appendChild(e);return e};bD.setPath=function(T,e){var i=this._getPathString(e)||"M -9999,-9999";this.setAttribute(T,"d",i)};bD._getPathString=function(e){if(e.length===0){return""}var i=[];C.each(e,function(hR){if(hR.length<2){return}i.push("M "+hR[0].x+" "+hR[0].y+" L");for(var hQ=1,T=hR.length;hQ<T;hQ++){i.push(hR[hQ].x);i.push(hR[hQ].y)}});return i.join(" ")};bD.addStandardCircle=function(){var e=S("circle",{},this.SVG_NS);this._svg.appendChild(e);return e};bD.setStandardCircleGeometry=function(T,hQ){var i=hQ.cx;var hR=hQ.cy;var e=hQ.radius;this.setAttribute(T,"cx",i);this.setAttribute(T,"cy",hR);this.setAttribute(T,"r",e)};function hw(e){this._map=e;this._vmlAttrName={strokeweight:"weight",strokecolor:"color",fillcolor:"color",strokeopacity:"opacity",fillopacity:"opacity",strokestyle:"dashstyle"};this._type="vml"}hw.prototype=new dV();var bi=hw.prototype;bi.setAttribute=function(T,e,hQ){if(T){if(e.indexOf("stroke")==0){T=T.getElementsByTagName("stroke")[0]}else{if(e.indexOf("fill")==0){T=T.getElementsByTagName("fill")[0]}}if(e.indexOf("color")>0){if(!hQ){T.on=false}else{T.on=true}}if(e=="strokestyle"){switch(hQ){case"dashed":hQ="4 2 1 2";break;case"dotted":hQ="1 1";break;default:hQ="solid";break}}if(e=="strokeweight"){hQ=hQ+"px"}var i=this._getAttributeName(e);T[i]=hQ||""}};bi._getAttributeName=function(e){return this._vmlAttrName[e]||e};bi.addLine=function(){var e=[\'<v:shape style="behavior:url(#default#VML);z-index:1;width:1px;height:1px;position:absolute;left:0;top:0;"\',\'coordsize="1,1" coordorigin="0,0" filled="t" fillcolor="white">\',\'<v:stroke style="behavior:url(#default#VML);" endcap="round" oned="true" />\',\'<v:fill style="behavior:url(#default#VML);" />\',"</v:shape>"].join("");return dI(this._map.getPanes().mapPane,e)};bi.setPath=function(i,e){this.setAttribute(i,"path",this._getPathString(e));if(C.Browser.ie==6){i.style.display="none";i.style.display=""}};bi._getPathString=function(e){if(e.length==0){return""}var i=[];C.each(e,function(hR){if(hR.length<2){return}i.push("m "+hR[0].x+" "+hR[0].y+" l");for(var hQ=1,T=hR.length;hQ<T;hQ++){i.push(hR[hQ].x);i.push(hR[hQ].y)}i.push("e")});return i.join(" ")||" "};bi.addStandardCircle=function(){var e=[\'<v:oval style="behavior:url(#default#VML);z-index:1;width:1px;height:1px;position:absolute;left:0;top:0;">\',\'<v:stroke style="behavior:url(#default#VML);" endcap="round" oned="true" />\',\'<v:fill style="behavior:url(#default#VML);" />\',"</v:oval>"].join("");return dI(this._map.getPanes().mapPane,e)};bi.setStandardCircleGeometry=function(T,hQ){var i=hQ.cx;var hR=hQ.cy;var e=hQ.radius;T.style.left=(i-e)+"px";T.style.top=(hR-e)+"px";T.style.width=(e*2)+"px";T.style.height=(e*2)+"px";if(C.Browser.ie===6){T.style.display="none";T.style.display=""}};');
﻿_jsload&&_jsload('mapgl', 'bo.register(function(T){if(T._renderType!=="webgl"||T._destroyed){return}T._webglMapCamera=new gf(T);var e=new cj(T,T._webglMapCamera);T._webglPainter=e;T._webglMapScene=new x(T,e);var i=new n(T);if(T.config.showControls===true){this._navigationCtrl=new eU(T)}T.fire(new bb("onglmoduleloaded"))});function gf(i){this._map=i;this._fovy=35;this._fovyRadian=this._fovy*Math.PI/180;this._projectionMatrix=mat4.create();this._modelViewMatrix=mat4.create();this._projectionMatrix3D=mat4.create();this._projectionMatrix3DInverse=mat4.create();this._projectionMatrix3D64=mat4.create(Float64Array);this._projectionMatrix3DInverse64=mat4.create(Float64Array);this._projectionMatrixLabel3D64=mat4.create(Float64Array);this._modelViewMatrix3D=mat4.create();this._modelViewMatrixLineLabel=mat4.create();this._modelViewMatrixMCPlane64=mat4.create(Float64Array);this._modelViewMatrixMCPlaneInverse64=mat4.create(Float64Array);this._modelViewMatrixMCPlane=mat4.create();this._modelViewMatrixMC3D=mat4.create();this._modelViewMatrixPoly=mat4.create();this._ray=new cb.Ray();this._tempV4=vec4.create(Float64Array);this._tempRes=vec4.create();this._tempNdc=vec4.create();this._near=10;this._far=4000;this._farLabel=2800;if(!this._map.config.restrictCenter){this._far=3000;var e=this._map.getSize();if(e.height>1500){this._far=e.height*2}this._farLabel=2000}this._frustumSideLen=this._far/Math.cos(this._fovyRadian);this._init()}C.extend(gf.prototype,{_init:function(){var e=this;e._renderTilt=e._getRenderTilt();e._updateSize();e._updateProjectionMatrix();e._updatePolyMatrix();e._updatePlaneMatrix();this._map.on("updateoverlaymatrix",function(i){e._updatePolyMatrix()})},update:function(T){var i=this;i._renderTilt=i._getRenderTilt();if("onsize_changed" in T.changedStatus){i._updateSize();i._updateProjectionMatrix()}i._updatePolyMatrix();i._updatePlaneMatrix()},_getRenderTilt:function(){var T=this._map;var e=T.getTilt();var i=T.getZoom();if(e!==0&&i<T._enableTiltZoom){if(i>=T._enableTiltZoom-2){e=(1-(T._enableTiltZoom-i)/2)*e}else{e=0}}return e},_updateSize:function(){var e=this._map.getSize();this._width=e.width;this._height=e.height;this._widthHeightRatio=this._width/this._height;this._translateZ=Math.round(-this._height/(2*Math.tan(this._fovyRadian/2)));this._farLabel=Math.abs(this._translateZ)+1400},_updateProjectionMatrix:function(){var i=this._map;var e=i.getSize();mat4.ortho(this._projectionMatrix,0,e.width,0,e.height,this._near,this._far);mat4.perspective(this._projectionMatrix3D64,this._fovyRadian,this._widthHeightRatio,this._near,this._far);mat4.invert(this._projectionMatrix3DInverse64,this._projectionMatrix3D64);this._projectionMatrix3D=mat4.clone(this._projectionMatrix3D64);this._projectionMatrix3DInverse=mat4.clone(this._projectionMatrix3DInverse64);mat4.perspective(this._projectionMatrixLabel3D64,this._fovyRadian,this._widthHeightRatio,this._near,this._farLabel)},getProjectionMatrix:function(){return this._projectionMatrix},getProjectionMatrix3D:function(){return this._projectionMatrix3D},getMCPlaneMVMatrix:function(){return this._modelViewMatrixMCPlane},getMC3DMVMatrix:function(){return this._modelViewMatrixMC3D},getModelViewMatrix3D:function(hQ){var e=hQ.col;var h3=hQ.row;var h0=hQ.zoom;var hW=hQ.loopOffsetX;var h2=hQ.baseTileSize;var T=this._map;var hU=T.getZoom();mat4.identity(this._modelViewMatrix3D);var h1=T.getCenterIn();var hY=Math.pow(2,h0-18);var hV=hW*hY;var hZ=h1.lng*hY;var hX=h1.lat*hY;var hR=Math.pow(2,hU-h0);var hS=new ej(e*h2,h3*h2);var hT=this._modelViewMatrix3D;var i=this._translateZ;if(this._renderTilt!==0){mat4.translate(hT,hT,[0,0,i]);mat4.rotate(hT,hT,dK(this._renderTilt),[-1,0,0]);mat4.translate(hT,hT,[0,0,-i])}if(T._heading%360!==0){mat4.rotate(hT,hT,dK(T._heading),[0,0,-1])}mat4.translate(hT,hT,[0,0,i]);mat4.scale(hT,hT,[hR,hR,hR]);mat4.translate(hT,hT,[0,0,-i]);mat4.translate(hT,hT,[hS.x-hZ+hV,hS.y-hX,i]);return this._modelViewMatrix3D},getModelViewMatrixForLineLabel:function(hQ){var i=this._map;if(!i.loaded){return}var hT=this._modelViewMatrixLineLabel;mat4.identity(hT);var T=this._translateZ;var hW=i.centerPoint;var hV=i.zoomLevel;var hX=i.getZoomUnits();var e=hQ.col;var h0=hQ.row;var hZ=hQ.baseTileSize;var hR=Math.pow(2,hV-hQ.zoom);var hS={x:e*hZ*hR,y:h0*hZ*hR};var hU=[hS.x-hW.lng/hX,hS.y-hW.lat/hX,T];if(this._renderTilt!==0){mat4.translate(hT,hT,[0,0,T]);mat4.rotate(hT,hT,dK(this._renderTilt),[-1,0,0]);mat4.translate(hT,hT,[0,0,-T])}if(i._heading%360!==0){mat4.rotate(hT,hT,dK(i._heading),[0,0,-1])}mat4.translate(hT,hT,hU);var hY=Math.pow(2,hV-18);mat4.scale(hT,hT,[hY,hY,Math.pow(2,hV-20)]);return this._modelViewMatrixLineLabel},_updatePlaneMatrix:function(){var hU=this._map;if(!hU.loaded){return}var hR=this._modelViewMatrixMCPlane64;mat4.identity(hR);var hQ=this._translateZ;var T=hU.centerPoint;var hT=hU.zoomLevel;var hS=hU.getZoomUnits();var i=[-T.lng/hS,-T.lat/hS,hQ];if(this._renderTilt!==0){mat4.translate(hR,hR,[0,0,hQ]);mat4.rotate(hR,hR,dK(this._renderTilt),[-1,0,0]);mat4.translate(hR,hR,[0,0,-hQ])}if(hU._heading%360!==0){mat4.rotate(hR,hR,dK(hU._heading),[0,0,-1])}mat4.translate(hR,hR,i);var e=Math.pow(2,hT-18);mat4.scale(hR,hR,[e,e,Math.pow(2,hT-20)]);mat4.invert(this._modelViewMatrixMCPlaneInverse64,hR);this._modelViewMatrixMCPlane=mat4.clone(this._modelViewMatrixMCPlane64)},_updatePolyMatrix:function(){if(!this._map._polyOverlayBasePoint){return}var hU=this._map;var hT=hU.getZoom();mat4.identity(this._modelViewMatrixPoly);var hS=hU.getCenterIn();var i=Math.pow(2,hT-18);var e=hS.sub(hU._polyOverlayBasePoint).mult(i);var hQ=this._translateZ;var T=this._modelViewMatrixPoly;if(this._renderTilt!==0){mat4.translate(T,T,[0,0,hQ]);mat4.rotate(T,T,dK(this._renderTilt),[-1,0,0]);mat4.translate(T,T,[0,0,-hQ])}if(hU._heading%360!==0){mat4.rotate(T,T,dK(hU._heading),[0,0,-1])}mat4.translate(T,T,[-e.lng,-e.lat,hQ]);var hR=i;mat4.scale(T,T,[hR,hR,hR])},getModelViewMatrixPoly:function(){return this._modelViewMatrixPoly},castRay:function(T,hR){var i=this._ray;var e=T.x;var hU=T.y;var hQ=vec3.create(Float64Array);var hS=vec4.set(this._tempV4,e,hU,-1,1);this._calcV4InCastRay(hS,hR);vec3.scale(hQ,hS,1/hS[3]);var hT=vec3.create(Float64Array);hS=vec4.fromValues(e,hU,1,1,Float64Array);this._calcV4InCastRay(hS,hR);vec3.scale(hS,hS,1/hS[3]);vec3.sub(hT,hS,hQ);vec3.normalize(hT,hT);i.set(hQ,hT);return i},_calcV4InCastRay:function(hS,T){if(!T||!T.matrixInfo){mat4.multiply(hS,this._projectionMatrix3DInverse64,hS);mat4.multiply(hS,this._modelViewMatrixMCPlaneInverse64,hS)}else{if(T.matrixInfo){var e=T.matrixInfo.projectionMatrix;var hQ=mat4.create(Float64Array);if(e){mat4.invert(hQ,e)}else{hQ=this._projectionMatrix3DInverse64}var i=T.matrixInfo.modelViewMatrix;var hR=mat4.create(Float64Array);if(i){mat4.invert(hR,i)}else{hR=this._projectionMatrix3DInverse64}mat4.multiply(hS,hQ,hS);mat4.multiply(hS,hR,hS)}}},fromXYZToNDC:function(hT,hR,T,hV){var hQ=vec4.set(this._tempV4,hT,hR,T,1);var i=this._tempRes;hV=hV||{};var e=this._modelViewMatrixMCPlane64;var hS=this._projectionMatrix3D64;if(hV.matrixInfo){e=hV.matrixInfo.modelViewMatrix||e;hS=hV.matrixInfo.projectionMatrix||hS}mat4.multiply(i,e,hQ);mat4.multiply(i,hS,i);var hU=vec4.set(this._tempNdc,i[0]/i[3],i[1]/i[3],i[2]/i[3],1);hU.outOfFrustum=false;if(hV.frustumTest){if(i[0]<-i[3]||i[0]>i[3]||i[1]<-i[3]||i[1]>i[3]||i[2]<-i[3]||i[2]>i[3]){hU.outOfFrustum=true}}hU.w=i[3];return hU},fromMCToScreenPixel:function(hR,hQ,hX){hX=hX||{};var T={matrixInfo:{}};if(hX.center||hX.zoom||typeof hX.heading==="number"||typeof hX.tilt==="number"){var hU=hX.zoom||this._map.zoomLevel;var e=hX.center||this._map.centerPoint;var hW=typeof hX.heading==="number"?hX.heading:this._map.getHeading();var hV=typeof hX.tilt==="number"?hX.tilt:this._renderTilt;T.matrixInfo.modelViewMatrix=this.generateMVMatrix(e,hU,hW,hV)}T.frustumTest=hX.frustumTest;if(hX.forLabel){T.matrixInfo.projectionMatrix=this._projectionMatrixLabel3D64}var hT=hX.height||0;var hS=this.fromXYZToNDC(hR,hQ,hT,T);if(!hS){return null}var i=new ej(((hS[0]+1)*this._map.width/2),((1-hS[1])*this._map.height/2));i.depth=(hS[2]+1)*0.5;i.w=hS.w;i.outOfFrustum=hS.outOfFrustum;return i},fromScreenPixelToMC:function(hX,hT,h3){var hW=hX*2/this._map.width-1;var hU=1-hT*2/this._map.height;h3=h3||{};var T=null;if(h3.zoom||h3.center||typeof h3.heading==="number"||typeof h3.tilt==="number"){var i=this._map;var h0=h3.zoom||i.zoomLevel;var e=h3.center||i.centerPoint;var h2=typeof h3.heading==="number"?h3.heading:i.getHeading();var hZ=typeof h3.tilt==="number"?h3.tilt:this._renderTilt;T={matrixInfo:{modelViewMatrix:this.generateMVMatrix(e,h0,h2,hZ)}}}var hV=this.castRay(new ej(hW,hU),T);var hQ=vec3.fromValues(0,0,1,Float64Array);var hS=vec3.dot(hQ,hV.origin);var hR=vec3.dot(hQ,hV.direction);var hY=-hS/hR;var h1=vec3.create(Float64Array);vec3.scaleAndAdd(h1,hV.origin,hV.direction,hY);h1[0]=Math.round(h1[0]*100000)/100000;h1[1]=Math.round(h1[1]*100000)/100000;return new hr(h1[0],h1[1])},generateMVMatrix:function(e,hU,hW,hV){var i=this._map;if(!i.loaded){return}e=e||i.centerPoint;hU=hU||i.zoomLevel;hW=typeof hW==="number"?hW:i._heading;hV=typeof hV==="number"?hV:this._renderTilt;var hQ=mat4.create(Float64Array);mat4.identity(hQ);var T=this._translateZ;var hS=i.getZoomUnits(hU);var hR=[-e.lng/hS,-e.lat/hS,T];if(hV!==0){mat4.translate(hQ,hQ,[0,0,T]);mat4.rotate(hQ,hQ,dK(hV),[-1,0,0]);mat4.translate(hQ,hQ,[0,0,-T])}if(hW%360!==0){mat4.rotate(hQ,hQ,dK(hW),[0,0,-1])}mat4.translate(hQ,hQ,hR);var hT=Math.pow(2,hU-18);mat4.scale(hQ,hQ,[hT,hT,1]);return hQ},getPosition:function(e){e=e||this._modelViewMatrixMCPlaneInverse64;return vec3.transformMat4(vec3.create(Float64Array),vec3.fromValues(0,0,0,Float64Array),e)}});function x(i,e){this._map=i;this._camera=i._webglMapCamera;this._painter=e;this._changedStatus={};this._statusChanged=false;this._rAFStarted=false;this._enabled=true;if(i.getMapType()==="B_EARTH_MAP"){this._enabled=false}this._onEachFrame=(function(T){return function(){T._updateFrame()}})(this);this._init()}C.extend(x.prototype,{_init:function(){this._fpsStarted=false;this._mapStatusIdle=true;this._bind();this._statusChanged=true;this.startRenderThread();var e=new cs();var T=this;var hQ=this._map;hQ.on("movestart",function(){if(T._fpsStarted){return}T._fpsStarted=true;e.startFPS()});hQ.on("moveend",function(){if(!T._fpsStarted){return}T._fpsStarted=false;e.stopFPS()});hQ.on("zoomstart",function(){if(T._fpsStarted){return}T._fpsStarted=true;e.startFPS()});hQ.on("zoomend",function(){if(!T._fpsStarted){return}T._fpsStarted=false;e.stopFPS()});function i(){if(!e.fpsStarted){return}if(hQ.getMapType()!=="B_NORMAL_MAP"){return}var hT=e.getAverageFPS();var hS=e.getHigherAverageFPS();var hR=new bb("onfpsdata_ready");hR.fps=hT;hR.fpsH=hS;hQ.fire(hR);e.clearFPSData()}setTimeout(i,5000);setInterval(i,10000)},_bind:function(){var hQ=this._map;var e=this;function hS(hT){e._changedStatus[hT.type]=hT||true;e._statusChanged=true;e.startRenderThread()}hQ.on("zoom_changed",hS);hQ.on("center_changed",hS);hQ.on("heading_changed",hS);hQ.on("tilt_changed",hS);hQ.on("size_changed",hS);hQ.on("displayoptions_changed",hS);hQ.on("mapglidle_inner",function(){cancelAnimationFrame(e.renderTimer);e._rAFStarted=false;this.fire(new bb("onrenderthreadstop"));this.fire(new bb("onmapglidle"));e.renderTimer=null});var T=function(hT){e.startRenderThread()};hQ.on("refresh",T);function hR(){if(this.mapType==="B_EARTH_MAP"){e._enabled=false;cancelAnimationFrame(e.renderTimer);e._rAFStarted=false;hQ.fire(new bb("onrenderthreadstop"));e.renderTimer=null}else{e._enabled=true;e.startRenderThread()}}hQ.on("maptypechange",hR);function i(){if(document.hidden){cancelAnimationFrame(e.renderTimer)}else{e.startRenderThread()}}document.addEventListener("visibilitychange",i,false);hQ.on("destroy",function(){this.off("zoom_changed",hS);this.off("center_changed",hS);this.off("heading_changed",hS);this.off("tilt_changed",hS);this.off("size_changed",hS);this.off("displayoptions_changed",hS);this.off("refresh",T);this.off("maptypechange",hR);document.removeEventListener("visibilitychange",i,false);cancelAnimationFrame(this.renderTimer)})},startRenderThread:function(){if(!this._enabled){return}var T=this;if(T.idleTimer){clearTimeout(T.idleTimer)}T.idleTimer=setTimeout(function i(){T._map.fire(new bb("onmapglidle_inner"));T.idleTimer=null},200);if(T._statusChanged===true){if(T._mapStatusIdle===true){T._mapStatusIdle=false;T._map.fire(new bb("onmapstatusbusy_inner"))}if(T.statusIdleTimer){clearTimeout(T.statusIdleTimer)}T.statusIdleTimer=setTimeout(function e(){T._mapStatusIdle=true;T._map.fire(new bb("onmapstatusidle_inner"));T.statusIdleTimer=null},100)}if(this._rAFStarted===true){return}this._rAFStarted=true;this.renderTimer=requestAnimationFrame(this._onEachFrame)},_updateFrame:function(){this.renderTimer=requestAnimationFrame(this._onEachFrame);this._map.fire(new bb("onbeforeupdateframe"));if(this._rAFStarted===false){cancelAnimationFrame(this.renderTimer);return}var T=fB();if(this._statusChanged){this._statusChanged=false;var e=new bb("onupdate");e.changedStatus=this._changedStatus;if(this._changedStatus.onsize_changed){this._resizeMap(this._changedStatus.onsize_changed.oldSize)}this._camera.update(e);this._map.fire(e);this._changedStatus={}}this._painter.draw({idle:this._mapStatusIdle});var hQ=fB()-T;var i=new bb("onupdateframe");i.frameTime=hQ;this._map.fire(i)},_resizeMap:function(e){var T=this._map;var hQ=T.getSize();var hV=(hQ.width-e.width)/2;var hS=(hQ.height-e.height)/2;var i=hV;var hT=hS;if(T._heading!==0){var hX=dK(T._heading);i=Math.abs(Math.cos(hX)*hV)+Math.abs(Math.sin(hX)*hS);hT=Math.abs(Math.sin(hX)*hV)+Math.abs(Math.cos(hX)*hS)}var hU=T.getZoomUnits();var hW=T.centerPoint;if(hW&&!T.config.enableResizeOnCenter){if(T._heading%360!==0||T._tilt>0){var hR=new ej(hQ.width/2,hQ.height/2);T.centerPoint=T.restrictCenter(T.pixelToPointIn(hR))}else{T.centerPoint=T.restrictCenter(new hr(hW.lng+i*hU,hW.lat-hT*hU))}}}});function cs(){this._fps=0;this.preFrameTimeStamp=Date.now();this.currentTime=null;this.fpsArr=[];this.averageFPS=0;this.higherAverageFPS=0;this.averageTimeInterval=20;this.fpsStarted=false}cs.prototype.startFPS=function(){this.fpsStarted=true;this.preFrameTimeStamp=Date.now();this.initFPS()};cs.prototype.initFPS=function(){this._fps++;this.currentTime=Date.now();if(this.currentTime-this.preFrameTimeStamp>500){var i=this._fps*2;i=i>60?60:i;this.fpsArr.push(i);if(this.fpsArr.length===this.averageTimeInterval){this._calcAverageFPS()}this._fps=0;this.preFrameTimeStamp=this.currentTime}var e=this;this.timer=requestAnimationFrame(function(){e.initFPS()})};cs.prototype._calcAverageFPS=function(){if(this.fpsArr.length===0){return}var hQ=0;var e=0;this.fpsArr.sort(function(hS,i){return i-hS});var hR=Math.round(this.fpsArr.length*0.8);for(var T=0;T<this.fpsArr.length;T++){if(T===hR){e=hQ}hQ+=this.fpsArr[T]}this.averageFPS=Math.round(hQ/this.fpsArr.length);this.higherAverageFPS=Math.round(e/hR);this.fpsArr=[]};cs.prototype.getAverageFPS=function(){if(this.averageFPS===0){this._calcAverageFPS()}return this.averageFPS};cs.prototype.getHigherAverageFPS=function(){if(this.higherAverageFPS===0){this._calcAverageFPS()}return this.higherAverageFPS};cs.prototype.stopFPS=function(){if(this.timer){cancelAnimationFrame(this.timer);this.timer=null;if(this._fps!==0){var e=this.currentTime-this.preFrameTimeStamp;var i=this._fps*1000/e;i=i>60?60:i;this.fpsArr.push(i);this._fps=0}}};cs.prototype.clearFPSData=function(){this.averageFPS=0;this.higherAverageFPS=0;this.fpsStarted=false};var hL=(function(){var e={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],\'"\':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],"$":[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],"0":[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],"1":[20,[6,17,8,18,11,21,11,0]],"2":[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],"3":[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],"4":[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],"5":[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],"6":[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],"7":[20,[17,21,7,0,-1,-1,3,21,17,21]],"8":[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],"9":[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]};return function(h1,T,hX,hR){hR=hR||1;var hT=[];var hV;var hW;var hU;var hS;var hY;var h0;var hZ;var hQ;for(hV=0,hW=h1.length;hV<hW;hV++){hY=e[h1[hV]];if(!hY){continue}hQ=null;for(hU=0,hS=hY[1].length;hU<hS;hU+=2){if(hY[1][hU]===-1&&hY[1][hU+1]===-1){hQ=null}else{h0=T+hY[1][hU]*hR;hZ=hX-hY[1][hU+1]*hR;if(hQ){hT.push(hQ.x,hQ.y,h0,hZ)}hQ={x:h0,y:hZ}}}T+=hY[0]*hR}return hT}})();var J={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Float32:"FLOAT"};var N={Int8:1,Uint8:1,Int16:2,Uint16:2,Float32:4};function fi(hQ,hS,T,hR){this.arrayBuffer=hQ;this.attributes=hS.members;this.bytesPerElement=0;if(this.attributes){for(var e=0;e<this.attributes.length;e++){this.bytesPerElement+=N[this.attributes[e].type]*this.attributes[e].components}}else{this.bytesPerElement=hQ.BYTES_PER_ELEMENT*hS.components}this.length=hR||hQ.byteLength/this.bytesPerElement;this.type=T;this.arrayType=hS}fi.prototype.bind=function(i){var e=i[this.type];if(!this.buffer){this.buffer=i.createBuffer();i.bindBuffer(e,this.buffer);i.bufferData(e,this.arrayBuffer,i.STATIC_DRAW);this.arrayBuffer=null}else{i.bindBuffer(e,this.buffer)}};fi.prototype.setVertexAttribPointers=function(hQ,e){for(var i=0;i<this.attributes.length;i++){var hR=this.attributes[i];var T=e.attributes[hR.name];hQ.vertexAttribPointer(T,hR.components,hQ[J[hR.type]],hR.normalize,this.bytesPerElement,hR.offset)}};fi.prototype.updateVertexData=function(hQ,i,T){this.arrayBuffer=i;if(!this.buffer){return this.bind(hQ)}if(T<=this.length){var e=hQ[this.type];hQ.bindBuffer(e,this.buffer);hQ.bufferData(e,this.arrayBuffer,hQ.STATIC_DRAW)}else{this.destroy(hQ);this.bind(hQ)}this.length=T};fi.prototype.destroy=function(e){if(this.buffer){e.deleteBuffer(this.buffer);this.buffer=null}};fi.BufferType={VERTEX:"ARRAY_BUFFER",ELEMENT:"ELEMENT_ARRAY_BUFFER"};fi.ELEMENT_ATTRIBUTE_TYPE="Uint16";fi.VERTEX_ATTRIBUTE_ALIGNMENT=4;function hq(){this.boundProgram=null;this.boundVertexBuffer=null;this.boundElementBuffer=null;this.vao=null}hq.prototype.bind=function(hU,e,hQ,hT){var hR=hU.extVertexArrayObject;if(hR===undefined){hR=hU.extVertexArrayObject=hU.getExtension("OES_vertex_array_object")}if(hR){if(!this.vao){this.vao=hR.createVertexArrayOES()}hR.bindVertexArrayOES(this.vao)}else{}if(!this.boundProgram){var hV=hR?0:(hU.currentNumAttributes||0);var hS=e.numAttributes;var T;for(T=hV;T<hS;T++){hU.enableVertexAttribArray(T)}if(!hR){for(T=hS;T<hV;T++){hU.disableVertexAttribArray(T)}hU.currentNumAttributes=hS}hQ.bind(hU);hQ.setVertexAttribPointers(hU,e);if(hT){hT.bind(hU)}if(hR){this.boundProgram=e;this.boundVertexBuffer=hQ;this.boundElementBuffer=hT}}};hq.prototype.update=function(hU,hQ,T,hT,e,i,hS){var hR=hU.extVertexArrayObject;if(hR===undefined){hR=hU.extVertexArrayObject=hU.getExtension("OES_vertex_array_object")}if(hR){hR.bindVertexArrayOES(this.vao);if(this.boundVertexBuffer){this.boundVertexBuffer.updateVertexData(hU,T,hT);this.boundVertexBuffer.setVertexAttribPointers(hU,this.boundProgram)}if(e&&this.boundElementBuffer){this.boundElementBuffer.updateVertexData(hU,i,hS)}}else{hQ.updateVertexData(hU,T,hT);if(e){e.updateVertexData(hU,i,hS)}}};hq.prototype.unbind=function(i){var e=i.extVertexArrayObject;if(e){e.bindVertexArrayOES(null);this.boundProgram=null;this.boundVertexBuffer=null;this.boundElementBuffer=null}};hq.prototype.destroy=function(i){var e=i.extVertexArrayObject;if(e&&this.vao){e.deleteVertexArrayOES(this.vao);this.vao=null;this.boundProgram=null;this.boundVertexBuffer=null;this.boundElementBuffer=null}};function hz(i,hS,e,hR,hQ){var hT=i.gl;var T=i.programMgr.useProgram("block");e.vao1.bind(hT,T,e.vertex,e.element1);hT.uniformMatrix4fv(T.uniforms.u_mv_matrix,false,hS.mvMatrix);if(hR){mat4.invert(i.normalMatrix,hS.mvMatrix);mat4.transpose(i.normalMatrix,i.normalMatrix)}hT.uniformMatrix4fv(T.uniforms.u_normal_matrix,false,i.normalMatrix);hT.drawElements(hT.TRIANGLES,e.element1.length,hT.UNSIGNED_SHORT,0)}function eg(e,T,hQ){var hR=e.gl;var i=e.programMgr.useProgram("block");hR.uniform3fv(i.uniforms.u_side_light_dir,T);hR.uniform1i(i.uniforms.u_is_normal,hQ);if(!i.lastState.projMatrix){hR.uniformMatrix4fv(i.uniforms.u_proj_matrix,false,e.projMatrix);i.lastState.projMatrix=true}var hS=e._camera._far||4000;if(i.lastState.cameraFar!==hS){hR.uniform1f(i.uniforms.u_camera_far,hS);i.lastState.cameraFar=hS}}function aa(hU,hT,e,hV){var hS=hU.gl;var hR=hU.programMgr.useProgram("shadow");hS.uniformMatrix4fv(hR.uniforms.u_mv_matrix,false,hT.mvMatrix);if(typeof e.length==="number"){for(var hQ=0;hQ<e.length;hQ++){var hW=e[hQ];var T=hV[hQ];if(T.type==="fill"){hW.vao1.bind(hS,hR,hW.vertex,hW.element1);hS.drawElements(hS.TRIANGLES,hW.element1.length,hS.UNSIGNED_SHORT,0)}}}else{e.vao1.bind(hS,hR,e.vertex,e.element1);hS.drawElements(hS.TRIANGLES,e.element1.length,hS.UNSIGNED_SHORT,0)}}function cA(i,e){var hQ=i.gl;var T=i.programMgr.useProgram("shadow");hQ.uniform3fv(T.uniforms.u_light_dir,e);if(!T.lastState.projMatrix){hQ.uniformMatrix4fv(T.uniforms.u_proj_matrix,false,i.projMatrix);T.lastState.projMatrix=true}var hR=i._camera._far||4000;if(T.lastState.cameraFar!==hR){hQ.uniform1f(T.uniforms.u_camera_far,hR);T.lastState.cameraFar=hR}}var cC=(function(){var i=new Image();var e=false;i.onload=function(){e=true};i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAUdJREFUeNrs2sENwyAQRcE4ckf0RBv04Z7ck30wFXBi/4wU5bScXhQk9hhj9B+xzu/7WjijvZ/b/Jbz/e83kE0AAkAACAABIAAEgAAQAAJAAAgAAVDYfA5ui+eY33R+BuA9PXO++QtwB0AACAABIAAEgAAQAAJAAAgAASAAqrIPED5vH8A+AO4ACAABIAAEgAAQAAJAAAgAASAABEBJ9gHC5+0D2AfAHQABIAAEgAAQAAJAAAgAASAABIAAKMk+QPi8fQD7ALgDIAAEgAAQAAJAAAgAASAABIAAEAAl2QcIn7cPYB8AdwAEgAAQAAJAAAgAASAABIAAEAACoCT7AOHz9gHsA+AOgAAQAAJAAAgAASAABIAAEAACQACUZB8gfN4+gH0A3AEQAAJAAAgAASAABIAAEAACQABUNV8D++I5nmM3nX8EGADa0U/2xPbBVwAAAABJRU5ErkJggg==";function T(hQ,hR){if(!hQ._gridTexture){hQ._gridTexture=hR.createTexture();hR.bindTexture(hR.TEXTURE_2D,hQ._gridTexture);hR.texParameteri(hR.TEXTURE_2D,hR.TEXTURE_WRAP_S,hR.REPEAT);hR.texParameteri(hR.TEXTURE_2D,hR.TEXTURE_WRAP_T,hR.REPEAT);hR.texParameteri(hR.TEXTURE_2D,hR.TEXTURE_MIN_FILTER,hR.LINEAR_MIPMAP_LINEAR);hR.texParameteri(hR.TEXTURE_2D,hR.TEXTURE_MAG_FILTER,hR.LINEAR);hR.texImage2D(hR.TEXTURE_2D,0,hR.RGBA,hR.RGBA,hR.UNSIGNED_BYTE,i);hR.generateMipmap(hR.TEXTURE_2D)}else{hR.bindTexture(hR.TEXTURE_2D,hQ._gridTexture)}}return function(hQ,hS,hT){if(!e){return}var hU=hQ.gl;var hR=hQ.programMgr.useProgram("grid");if(!hR.lastState.projMatrix){hU.uniformMatrix4fv(hR.uniforms.u_proj_matrix,false,hQ.projMatrix);hR.lastState.projMatrix=true}hU.uniformMatrix4fv(hR.uniforms.u_mv_matrix,false,hS);hQ._state.activeTexture(hU.TEXTURE0);T(hQ,hU);if(hR.uniforms.lastSampler!==0){hU.uniform1i(hR.uniforms.u_image,0);hR.uniforms.lastSampler=0}if(hR.uniforms.lastTexScale!==hT){hU.uniform1f(hR.uniforms.u_tex_scale,hT);hR.uniforms.lastTexScale=hT}hQ.gridVAO.bind(hU,hR,hQ.gridBuffer);hU.drawArrays(hU.TRIANGLE_STRIP,0,hQ.gridBuffer.length)}})();var cx=(function(){var hQ={};function i(hS,hW,hV,hR,hU){var hX=hS.gl;var hT=hS.programMgr.useProgram("overlayfill");hX.uniform4fv(hT.uniforms.u_color,hU);hR.vao1.bind(hX,hT,hR.vertex,hR.element1);if(!hT.lastState.projMatrix){hX.uniformMatrix4fv(hT.uniforms.u_proj_matrix,false,hS.projMatrix);hT.lastState.projMatrix=true}hX.uniformMatrix4fv(hT.uniforms.u_mv_matrix,false,hW);hX.drawElements(hX.TRIANGLES,hR.element1.length,hX.UNSIGNED_SHORT,0);if(window.global_lines){hX.uniform4fv(hT.uniforms.u_color,[1,0,0,1]);hX.drawElements(hX.LINE_STRIP,hV[2].length,hX.UNSIGNED_SHORT,0)}}function e(hT,hW,hV,hS,hR){var hX=hT.gl;var hU=hT.programMgr.useProgram("fill");hS.vao1.bind(hX,hU,hS.vertex,hS.element1);if(!hU.lastState.projMatrix){hX.uniformMatrix4fv(hU.uniforms.u_proj_matrix,false,hT.projMatrix);hU.lastState.projMatrix=true}if(hU.lastState.isFlat!==hT.isFlat){hX.uniform1i(hU.uniforms.u_flat,hT.isFlat);hU.lastState.isFlat=hT.isFlat}if(hU.lastState.drawPart!==hR){hX.uniform1i(hU.uniforms.u_draw_part,hR);hU.lastState.drawPart=hR}var hY=hT._camera._far||4000;if(hU.lastState.cameraFar!==hY){hX.uniform1f(hU.uniforms.u_camera_far,hY);hU.lastState.cameraFar=hY}hX.uniformMatrix4fv(hU.uniforms.u_mv_matrix,false,hW);hX.drawElements(hX.TRIANGLES,hS.element1.length,hX.UNSIGNED_SHORT,0)}return function T(hW,hV,hU,hS,hY,h0){h0=h0||{};if(!hY){var hX=h0.drawPart||0;e(hW,hV.mvMatrix,hU,hS,hX);return}var hT=hW.gl;var hZ=hW._state;if(h0.usePolygonStencil&&h0.drawPolygonPass===1){hR=[1,1,1,255];hT.clear(hT.STENCIL_BUFFER_BIT);hT.stencilFunc(hT.NEVER,0,255);hZ.stencilOp(hT.INVERT,hT.INVERT,hT.INVERT);hT.stencilMask(255);hZ.colorMask(false,false,false,false);i(hW,hV.mvMatrix,hU,hS,hR);return}if(h0.usePolygonStencil&&h0.drawPolygonPass===2){hT.stencilFunc(hT.EQUAL,255,255);hT.stencilMask(0);hZ.stencilOp(hT.KEEP,hT.KEEP,hT.KEEP);hZ.colorMask(true,true,true,true)}var hR=hQ[hU[0]];if(!hR){hR=hU[0].split(",");hR=[hR[0]/255,hR[1]/255,hR[2]/255,parseFloat(hR[3])];hQ[hU[0]]=hR}i(hW,hV.mvMatrix,hU,hS,hR);if(h0.usePolygonStencil){hT.clear(hT.STENCIL_BUFFER_BIT);hT.stencilMask(255);hT.stencilFunc(hT.ALWAYS,1,255)}}})();var bu=(function(){function i(hW,hQ,hV,hZ,hX,hY){if(hQ.element1&&hQ.element1.length===0){return}var hS=hW.gl;var hR=hW.programMgr.useProgram("line");if(!hR.lastState.projMatrix){hS.uniformMatrix4fv(hR.uniforms.u_proj_matrix,false,hW.projMatrix);hR.lastState.projMatrix=true}hS.uniformMatrix4fv(hR.uniforms.u_mv_matrix,false,hV);var T;if(hZ){T=hW.polyZoomRatio}else{T=hW.tileScale}if(hR.lastState.scale!==T){hS.uniform1f(hR.uniforms.u_scale,T);hR.lastState.scale=T}var hT=hY?false:hW.isFlat;if(hR.lastState.isFlat!==hT){hS.uniform1i(hR.uniforms.u_flat,hT);hR.lastState.isFlat=hT}if(hR.lastState.drawPart!==hX){hS.uniform1i(hR.uniforms.u_draw_part,hX);hR.lastState.drawPart=hX}var hU=hW._camera._far||4000;if(hR.lastState.cameraFar!==hU){hS.uniform1f(hR.uniforms.u_camera_far,hU);hR.lastState.cameraFar=hU}hQ.vao1.bind(hS,hR,hQ.vertex,hQ.element1);hS.drawElements(hS.TRIANGLES,hQ.element1.length,hS.UNSIGNED_SHORT,0)}function e(ia,ic,id,h2,h3,h6,h4,h9,hV){var h5=ia.gl;var hU=ia.programMgr.useProgram("dash");var h1=id.texture;if(!ia._dashLineTextures){ia._dashLineTextures={}}var hY;var hR=h5.REPEAT;var h7;if(h6&&id.overlay){h7=id.overlay}if(h1 instanceof HTMLCanvasElement){if(!id.glTexture){if(h7&&h7._config.textureRepeat===false){hR=h5.CLAMP_TO_EDGE}id.glTexture=cb.utils.createTexture(h5,h1,{flipY:false,wrap:hR,mipmap:true,unpackAlpha:true})}hY=id.glTexture}else{var hQ=ia._dashLineTextures;if(!hQ[h1]){hQ[h1]={status:"init"};var ie=new Image();ie.crossOrigin="anonymous";if(h7&&h7._config.textureRepeat===false){hR=h5.CLAMP_TO_EDGE}ie.onload=function(){hQ[h1].texture=cb.utils.createTexture(h5,this,{flipY:false,wrap:hR,mipmap:true,unpackAlpha:true});hQ[h1].status="done";ia._map.fire(new bb("onrefresh"))};if(!h6){ie.src=e3.getIconSetPath(ia._map.config.style)+h1}else{ie.src=h1}}if(hQ[h1].status!=="done"){return}hY=hQ[h1].texture}if(!hU.lastState.projMatrix){h5.uniformMatrix4fv(hU.uniforms.u_proj_matrix,false,ia.projMatrix);hU.lastState.projMatrix=true}var hX=h9?false:ia.isFlat;if(hU.lastState.isFlat!==hX){h5.uniform1i(hU.uniforms.u_flat,hX);hU.lastState.isFlat=hX}h5.uniformMatrix4fv(hU.uniforms.u_mv_matrix,false,h3);ia._state.activeTexture(h5.TEXTURE6);h5.bindTexture(h5.TEXTURE_2D,hY);if(hU.uniforms.lastSampler!==6){h5.uniform1i(hU.uniforms.u_image,6);hU.uniforms.lastSampler=6}var hS=id.textureSize;var T=id.lineWidth;var hT=id.isSingle?true:false;var ib;if(hT){ib=1}else{var h8;ia._state.blendFunc(h5.ONE,h5.ONE_MINUS_SRC_ALPHA);if((!id.zoomWithMap&&!h6)||h6){ib=ia.tileScale;var hZ=1;if(/ditie/.test(h1)){hZ=1}if(/shengjie/.test(h1)){hZ=1.2;if(hV<=7){hZ=0.8}}if(h6){ia._state.blendFunc(h5.ONE,h5.ONE_MINUS_SRC_ALPHA);ib=ia.polyZoomRatio;h8=h7._totalDashLen;var h0=18;if(!id.zoomWithMap){h0=ia._map.getZoom()}if(hU.lastState.stepZoom!==h0){h5.uniform1f(hU.uniforms.u_step_zoom,h0);hU.lastState.stepZoom=h0}}else{ib=ia.tileScale;h8=hS[1]*hZ/ia.tileScaleFromStart;if(hU.lastState.stepZoom!==ia.stepZoom){h5.uniform1f(hU.uniforms.u_step_zoom,ia.stepZoom);hU.lastState.stepZoom=ia.stepZoom}}}else{ib=0.5;h8=hS[1]/hS[0]*T/2;if(hU.lastState.stepZoom!==ic.tileInfo.useZoom){h5.uniform1f(hU.uniforms.u_step_zoom,ic.tileInfo.useZoom);hU.lastState.stepZoom=ic.tileInfo.useZoom}}if(hU.lastState.dash!==h8){h5.uniform1f(hU.uniforms.u_dash,h8);hU.lastState.dash=h8}if(!h6){if(hU.lastState.tileZoom!==ic.tileInfo.useZoom){h5.uniform1f(hU.uniforms.u_tile_zoom,ic.tileInfo.useZoom);hU.lastState.tileZoom=ic.tileInfo.useZoom}}else{if(hU.lastState.tileZoom!==18){h5.uniform1f(hU.uniforms.u_tile_zoom,18);hU.lastState.tileZoom=18}}}if(hU.lastState.scale!==ib){h5.uniform1f(hU.uniforms.u_scale,ib);hU.lastState.scale=ib}if(hU.lastState.isSingle!==hT){h5.uniform1f(hU.uniforms.u_is_single,hT);hU.lastState.isSingle=hT}if(hU.lastState.drawPart!==h4){h5.uniform1i(hU.uniforms.u_draw_part,h4);hU.lastState.drawPart=h4}var hW=ia._camera._far||4000;if(hU.lastState.cameraFar!==hW){h5.uniform1f(hU.uniforms.u_camera_far,hW);hU.lastState.cameraFar=hW}h2.vao1.bind(h5,hU,h2.vertex,h2.element1);h5.drawElements(h5.TRIANGLES,h2.element1.length,h5.UNSIGNED_SHORT,0);ia._state.blendFunc(h5.SRC_ALPHA,h5.ONE_MINUS_SRC_ALPHA,h5.ONE,h5.ONE_MINUS_SRC_ALPHA)}return function(hT,hS,hR,T,hW,hX){if(!T){return}if(hW){for(var hQ=0;hQ<T.length;hQ++){if(hR[hQ].texture){e(hT,hS,hR[hQ],T[hQ],hS.mvMatrix,true)}else{i(hT,T[hQ],hS.mvMatrix,true)}}}else{hX=hX||{};var hU=hX.drawPart||0;var hV=hX.force3D||false;if(hR.texture){e(hT,hS,hR,T,hS.mvMatrix,false,hU,hV,hS.tileInfo.zoom)}else{i(hT,T,hS.mvMatrix,false,hU,hV)}}}})();var ca=(function(){var T=mat4.create();var i=vec3.create();function e(h6,h5,h9,h2,hY,hR,h8,hT,hQ,h0,hZ,hW,h1,h3,hS,hV){var h4=h6.gl;var hX=h6.programMgr.useProgram("symbol");hT=hT||0;hQ=hQ||0;hZ=hZ||0;h3=h3||T;h4.uniformMatrix4fv(hX.uniforms.uOrthoPMatrix,false,h3);if(!hX.lastState.projMatrix){h4.uniformMatrix4fv(hX.uniforms.uPMatrix,false,h8);h4.uniform2fv(hX.uniforms.uMapHalfSize,h0);hX.lastState.projMatrix=true}h4.uniformMatrix4fv(hX.uniforms.uMVMatrix,false,h2);h4.uniform3fv(hX.uniforms.uCameraPosHigh,hW);h4.uniform3fv(hX.uniforms.uCameraPosLow,h1);h4.uniform1f(hX.uniforms.uCameraFar,h6._camera._farLabel);if(hV){var h7=h6._map;var hU=aF(c8.WORLD_SIZE_MC);h4.uniform3fv(hX.uniforms.uFixPositionInfo,[1,hU[0],hU[1]])}else{h4.uniform3fv(hX.uniforms.uFixPositionInfo,i)}if(typeof hS!=="number"){hS=7}h6._state.activeTexture(h4.TEXTURE0+hS);h4.bindTexture(h4.TEXTURE_2D,hY);if(hX.uniforms.lastSamper!==hS){h4.uniform1i(hX.uniforms.uSampler,hS);hX.uniforms.lastSamper=hS}h4.uniform1i(hX.uniforms.uHighlight,hT);h4.uniform1i(hX.uniforms.uForRenderPNG8Text,hR);h4.uniform1i(hX.uniforms.uUseRound,hQ);if(hX.uniforms.lastMapZoom!==hZ){h4.uniform1f(hX.uniforms.uMapZoom,hZ);hX.uniforms.lastMapZoom=hZ}h9.bind(h4,hX,h5);h4.drawArrays(h4.TRIANGLES,0,h5.length)}return function(h2,hW,hR,h1,hY,hV,h0,hS,h5,hQ,hU,hZ,hT,h3,h4,hX){e(h2,hW,hR,h1,hY,hV,h0,hS,h5,hQ,hU,hZ,hT,h3,h4,hX)}})();var gb=(function(){var T=mat4.create();var e=vec3.create();function i(h0,hW,hR,hZ,hX,hV,hY,h3,hQ,hU,h2,h1){var hT=h0.gl;var hS=h0.programMgr.useProgram("symbolline");h3=h3||0;hU=hU||0;if(!hS.lastState.projMatrix){hT.uniformMatrix4fv(hS.uniforms.uPMatrix,false,hY);hT.uniform2fv(hS.uniforms.uMapHalfSize,hQ);hS.lastState.projMatrix=true}hT.uniformMatrix4fv(hS.uniforms.uMVMatrix,false,hZ);hT.uniform1f(hS.uniforms.uCameraFar,h0._camera._farLabel);if(typeof h1!=="number"){h1=7}h0._state.activeTexture(hT.TEXTURE0+h1);hT.bindTexture(hT.TEXTURE_2D,hX);if(hS.uniforms.lastSamper!==h1){hT.uniform1i(hS.uniforms.uSampler,h1);hS.uniforms.lastSamper=h1}hT.uniform1i(hS.uniforms.uForRenderPNG8Text,hV);hT.uniform1i(hS.uniforms.uUseRound,h3);if(hS.lastState.isFlat!==h0.isFlat){hT.uniform1i(hS.uniforms.u_flat,h0.isFlat);hS.lastState.isFlat=h0.isFlat}if(hS.uniforms.lastMapZoom!==hU){hT.uniform1f(hS.uniforms.uMapZoom,hU);hS.uniforms.lastMapZoom=hU}hR.bind(hT,hS,hW);hT.drawArrays(hT.TRIANGLES,0,hW.length)}return function(hZ,hU,hR,hY,hW,hT,hX,h2,hQ,hS,h1,h0,hV){i(hZ,hU,hR,hY,hW,hT,hX,h2,hQ,hS,h1,h0,hV)}})();var g9=(function(){function e(i,hU,hS,hQ,hR,hT){var hV=i.gl;var T=i.programMgr.useProgram("raster");hV.uniformMatrix4fv(T.uniforms.uPMatrix,false,hT);hV.uniformMatrix4fv(T.uniforms.uMVMatrix,false,hQ);i._state.activeTexture(hV.TEXTURE7);hV.bindTexture(hV.TEXTURE_2D,hR);hV.uniform1i(T.uniforms.uSampler,7);hS.bind(hV,T,hU);hV.drawArrays(hV.TRIANGLES,0,hU.length)}return function(i,hT,hR,T,hQ,hS){e(i,hT,hR,T,hQ,hS)}})();var fu=(function(){var i=new Image();var e=false;i.onload=function(){e=true};i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ5JREFUeNrsllEKgCAMhp14rsqT1X08Q6VdbDmYLxGUoO5lg72J+9i/3wmIaCTDGuFQAAVQANfyshCCSkBx5pwlAZackUEmSQkIJH2BjJiBAnK8gQBtwzy9I1cidWTLeUm5wHNHduqIlXagEyhMDlmLBNDyR8QvIf4pPNIFkZ3gn8V7SxB52tOwZVRTuCeArzkM+i1XAAVQAGmAW4ABAOOjKXrLR4xWAAAAAElFTkSuQmCC";function T(hR,hQ){if(!hQ._arrowTexture){hQ._arrowTexture=cb.utils.createTexture(hR,i,{wrap:hR.REPEAT})}else{hR.bindTexture(hR.TEXTURE_2D,hQ._arrowTexture)}}return function(hW,hV,hU,hR,hY,hZ){if(!e){return}var hX=hZ.drawPart||0;var hT=hW.gl;var hS=hW.programMgr.useProgram("arrow");if(!hS.lastState.projMatrix){hT.uniformMatrix4fv(hS.uniforms.u_proj_matrix,false,hW.projMatrix);hS.lastState.projMatrix=true}if(hS.lastState.drawPart!==hX){hT.uniform1i(hS.uniforms.u_draw_part,hX);hS.lastState.drawPart=hX}if(hS.lastState.isFlat!==hW.isFlat){hT.uniform1i(hS.uniforms.u_flat,hW.isFlat);hS.lastState.isFlat=hW.isFlat}hT.uniformMatrix4fv(hS.uniforms.u_mv_matrix,false,hV.mvMatrix);var hQ=hW.tileScale;if(hW.mapZoom>=19){hQ*=1.8}else{hQ*=1.2}if(hS.lastState.scale!==hQ){hT.uniform1f(hS.uniforms.u_scale,hQ);hS.lastState.scale=hQ}hW._state.activeTexture(hT.TEXTURE4);T(hT,hW);if(!hS.uniforms.lastSampler){hT.uniform1i(hS.uniforms.u_image,4);hS.uniforms.lastSampler=true}hR.vao1.bind(hT,hS,hR.vertex,hR.element1);hT.drawElements(hT.TRIANGLES,hR.element1.length,hT.UNSIGNED_SHORT,0)}})();var L=(function(){return function(e,hQ,T,hT,hS){var hU=e.gl;var i=e.programMgr.useProgram("sky");hU.depthMask(false);hU.uniformMatrix4fv(i.uniforms.uPMatrix,false,e.projMatrix2D);hU.uniformMatrix4fv(i.uniforms.uMVMatrix,false,hQ);hU.uniform4fv(i.uniforms.uGroundColor,hS[0]);hU.uniform4fv(i.uniforms.uSkyColor,hS[1]||hS[0]);var hR=hT-T;hR=hR<0?0:hR;hU.uniform1f(i.uniforms.uHorizonY,hR);e.skyVAO.bind(hU,i,e.skyBuffer);hU.drawArrays(hU.TRIANGLES,0,e.skyBuffer.length);hU.depthMask(true)}})();function bK(hU,hQ){var T=hU.gl;var i=hU.programMgr.useProgram("debug");T.uniform4fv(i.uniforms.u_color,[1,0,0,1]);T.uniform1f(i.uniforms.u_opacity,1);T.uniformMatrix4fv(i.uniforms.u_proj_matrix,false,hU.projMatrix);T.uniformMatrix4fv(i.uniforms.u_mv_matrix,false,hQ.mvMatrix);hU.debugVAO.bind(T,i,hU.debugBuffer);T.drawArrays(T.LINE_STRIP,0,hU.debugBuffer.length);hU.debugVAO.unbind(T);var hT=mat4.create();hT=mat4.scale(hT,hT,[1,-1,1]);hT=mat4.multiply(hT,hQ.mvMatrix,hT);T.uniformMatrix4fv(i.uniforms.u_mv_matrix,false,hT);var e=hQ.tileInfo;var hW=hQ.tileInfo.col+"-"+hQ.tileInfo.row+"-"+hQ.tileInfo.zoom;var hR=hL(hW,10,-10,0.5);var hS=new fi(new Float32Array(hR),{alignment:1,components:2,members:[{name:"a_pos",components:2,offset:0,type:"Float32"}]},fi.BufferType.VERTEX);var hV=new hq();hV.bind(T,i,hS);T.drawArrays(T.LINES,0,hS.length)}var b4=(function(){function hR(hZ,hX,hY,hW,hS,hU,hT){var hV=hZ.createTexture();hZ.bindTexture(hZ.TEXTURE_2D,hV);hZ.pixelStorei(hZ.UNPACK_FLIP_Y_WEBGL,true);hZ.texImage2D(hZ.TEXTURE_2D,0,hY||hZ.RGBA,hY||hZ.RGBA,hZ.UNSIGNED_BYTE,hX);hZ.texParameteri(hZ.TEXTURE_2D,hZ.TEXTURE_MAG_FILTER,hW||hZ.LINEAR);hZ.texParameteri(hZ.TEXTURE_2D,hZ.TEXTURE_MIN_FILTER,hS||hZ.LINEAR);hZ.texParameteri(hZ.TEXTURE_2D,hZ.TEXTURE_WRAP_S,hU||hZ.CLAMP_TO_EDGE);hZ.texParameteri(hZ.TEXTURE_2D,hZ.TEXTURE_WRAP_T,hT||hZ.CLAMP_TO_EDGE);hZ.bindTexture(hZ.TEXTURE_2D,null);return hV}function T(hT,hV){var hS=new Image();hS.onload=function(){hT._smaaInfo.areaTexture=hR(hV,this,hV.RGB,hV.LINEAR,hV.LINEAR,null,null);if(hT._smaaInfo.areaTexture&&hT._smaaInfo.searchTexture){hT._smaaInfo.glDrawSMAAReady=true}};hS.src=i();var hU=new Image();hU.onload=function(){hT._smaaInfo.searchTexture=hR(hV,this,null,hV.NEAREST,hV.NEAREST,null,null);if(hT._smaaInfo.areaTexture&&hT._smaaInfo.searchTexture){hT._smaaInfo.glDrawSMAAReady=true}};hU.src=e()}function hQ(hS,hT){if(!hS._smaaInfo.textureBeginToLoad){T(hS,hT);hS._smaaInfo.textureBeginToLoad=true}}return{init:function(hS){hS._smaaInfo={areaTexture:null,searchTexture:null,textureBeginToLoad:false,glDrawSMAAReady:false}},loadTexture:hQ,draw:function(hV,hU,hX,hT,hY,hS){var hZ=hV.gl;if(hV._smaaInfo.glDrawSMAAReady===false){return}hV._state.disableCap("blend");hZ.bindFramebuffer(hZ.FRAMEBUFFER,hT[1].framebuffer);var hW=hV.programMgr.useProgram("smaa1");hU.vao1.bind(hZ,hW,hU.vertex);hZ.uniform2fv(hW.uniforms.resolution,[1/hY,1/hS]);hZ.uniformMatrix4fv(hW.uniforms.projectionMatrix,false,hV.projMatrix2D);hZ.uniformMatrix4fv(hW.uniforms.modelViewMatrix,false,hX);hV._state.activeTexture(hZ.TEXTURE1);hZ.bindTexture(hZ.TEXTURE_2D,hT[0].texture);hZ.uniform1i(hW.uniforms.tDiffuse,1);hZ.drawArrays(hZ.TRIANGLES,0,hU.vertex.length);hZ.bindFramebuffer(hZ.FRAMEBUFFER,null);hZ.bindFramebuffer(hZ.FRAMEBUFFER,hT[2].framebuffer);hW=hV.programMgr.useProgram("smaa2");hU.vao2.bind(hZ,hW,hU.vertex);hZ.uniform2fv(hW.uniforms.resolution,[1/hY,1/hS]);hZ.uniformMatrix4fv(hW.uniforms.projectionMatrix,false,hV.projMatrix2D);hZ.uniformMatrix4fv(hW.uniforms.modelViewMatrix,false,hX);hV._state.activeTexture(hZ.TEXTURE1);hZ.bindTexture(hZ.TEXTURE_2D,hT[1].texture);hZ.uniform1i(hW.uniforms.tDiffuse,1);hV._state.activeTexture(hZ.TEXTURE2);hZ.bindTexture(hZ.TEXTURE_2D,hV._smaaInfo.areaTexture);hZ.uniform1i(hW.uniforms.tArea,2);hV._state.activeTexture(hZ.TEXTURE3);hZ.bindTexture(hZ.TEXTURE_2D,hV._smaaInfo.searchTexture);hZ.uniform1i(hW.uniforms.tSearch,3);hZ.drawArrays(hZ.TRIANGLES,0,hU.vertex.length);hZ.bindFramebuffer(hZ.FRAMEBUFFER,null);hW=hV.programMgr.useProgram("smaa3");hU.vao3.bind(hZ,hW,hU.vertex);hZ.uniform2fv(hW.uniforms.resolution,[1/hY,1/hS]);hZ.uniformMatrix4fv(hW.uniforms.projectionMatrix,false,hV.projMatrix2D);hZ.uniformMatrix4fv(hW.uniforms.modelViewMatrix,false,hX);hV._state.activeTexture(hZ.TEXTURE1);hZ.bindTexture(hZ.TEXTURE_2D,hT[2].texture);hZ.uniform1i(hW.uniforms.tDiffuse,1);hV._state.activeTexture(hZ.TEXTURE2);hZ.bindTexture(hZ.TEXTURE_2D,hT[0].texture);hZ.uniform1i(hW.uniforms.tColor,2);hZ.drawArrays(hZ.TRIANGLES,0,hU.vertex.length);hV._state.enableCap("blend")}};function i(){return"data:image/png;base64,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"}function e(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAIAAADiVupLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFZJREFUeNrs00EKgAAIRNEZ739mTQoiwmhRi4L/FiKiu9ERISkzbXdTVV3H4WhfOG6ehl1rNR7qDSF8hwkVcJXt+3A//I0Nv0GoCBUAAAAAAMA/LAIMAB+Dcg2OE2zsAAAAAElFTkSuQmCC"}})();var dl=(function(){function e(T,hR,i){var hS=T.gl;var hQ=T.programMgr.useProgram("overlayblock");i.vao1.bind(hS,hQ,i.vertex,i.element1);if(!hQ.lastState.projMatrix){hS.uniformMatrix4fv(hQ.uniforms.u_proj_matrix,false,T.projMatrix);hQ.lastState.projMatrix=true}var hT=T._camera._far||4000;if(hQ.lastState.cameraFar!==hT){hS.uniform1f(hQ.uniforms.u_camera_far,hT);hQ.lastState.cameraFar=hT}hS.uniformMatrix4fv(hQ.uniforms.u_mv_matrix,false,hR);hS.uniformMatrix4fv(hQ.uniforms.u_normal_matrix,false,T.normalMatrix);hS.drawElements(hS.TRIANGLES,i.element1.length,hS.UNSIGNED_SHORT,0)}return function(T,hR,i,hQ){hQ=hQ||{};e(T,hR.mvMatrix,i)}})();var fw=(function(){function e(T,hR,hT,hV,i,hS){if(i.length<=0){return}var hU=T.gl;var hQ=T.programMgr.useProgram("marker3d");i.vao.bind(hU,hQ,i.vertex);if(!hQ.lastState.projMatrix){hU.uniformMatrix4fv(hQ.uniforms.u_proj_matrix,false,T.projMatrix);hQ.lastState.projMatrix=true}hU.uniform1i(hQ.uniforms.u_use_texture,!!i.texture);if(i.texture){T._state.activeTexture(hU.TEXTURE7);hU.bindTexture(hU.TEXTURE_2D,i.texture);if(hQ.uniforms.lastSamper!==7){hU.uniform1i(hQ.uniforms.u_Sampler,7);hQ.uniforms.lastSamper=7}}hU.uniform3fv(hQ.uniforms.u_camera_pos_high,hT);hU.uniform3fv(hQ.uniforms.u_camera_pos_low,hV);hU.uniform3fv(hQ.uniforms.u_camera_pos_low,hV);hU.uniformMatrix4fv(hQ.uniforms.u_mv_matrix,false,hR);hU.drawArrays(hU.POINTS,0,i.vertex.length)}return function(T,hR,hS,hT,i,hQ){hQ=hQ||{};e(T,hR.mvMatrix,hS,hT,i,hQ)}})();var d7=(function(){function e(hQ,hU,hS,T,hT){var hV=hQ.gl;var hR=hQ.programMgr.useProgram("groundoverlay");if(hR.lastState.opacity!==hS.opacity){hV.uniform1f(hR.uniforms.u_opacity,hS.opacity);hR.lastState.opacity=hS.opacity}if(!hR.lastState.projMatrix){hV.uniformMatrix4fv(hR.uniforms.u_proj_matrix,false,hQ.projMatrix);hR.lastState.projMatrix=true}T.vao1.bind(hV,hR,T.vertex,T.element1);hQ._state.activeTexture(hV.TEXTURE2);hV.bindTexture(hV.TEXTURE_2D,hT);if(hR.uniforms.lastSamper!==2){hV.uniform1i(hR.uniforms.u_Sampler,2);hR.uniforms.lastSamper=2}hV.uniformMatrix4fv(hR.uniforms.u_mv_matrix,false,hU);hV.drawElements(hV.TRIANGLES,T.element1.length,hV.UNSIGNED_SHORT,0)}return function i(hQ,hU,hS,T,hT,hR){hR=hR||{};e(hQ,hU.mvMatrix,hS,T,hT)}})();function eS(hV,h0,i5){var ix=new hV.Int8Array(i5);var iw=new hV.Int16Array(i5);var iv=new hV.Int32Array(i5);var iu=new hV.Uint8Array(i5);var ir=new hV.Uint16Array(i5);var iq=new hV.Uint32Array(i5);var ip=new hV.Float32Array(i5);var io=new hV.Float64Array(i5);var il=h0.DYNAMICTOP_PTR|0;var ik=h0.tempDoublePtr|0;var ij=h0.ABORT|0;var ii=h0.STACKTOP|0;var ih=h0.STACK_MAX|0;var ie=h0.gb|0;var id=h0.fb|0;var ic=0;var ib=0;var h9=0;var h8=0;var h7=hV.NaN,h6=hV.Infinity;var h5=0,h4=0,h3=0,h2=0,h1=0;var i2=0;var i1=hV.Math.floor;var i0=hV.Math.abs;var iZ=hV.Math.sqrt;var iX=hV.Math.pow;var iW=hV.Math.cos;var iV=hV.Math.sin;var iU=hV.Math.tan;var iT=hV.Math.acos;var iR=hV.Math.asin;var iQ=hV.Math.atan;var iP=hV.Math.atan2;var iO=hV.Math.exp;var iN=hV.Math.log;var iM=hV.Math.ceil;var iK=hV.Math.imul;var iJ=hV.Math.min;var iI=hV.Math.max;var iH=hV.Math.clz32;var iG=h0.abort;var iF=h0.assert;var iE=h0.enlargeMemory;var iD=h0.getTotalMemory;var iC=h0.abortOnCannotGrowMemory;var iB=h0.setTempRet0;var iA=h0.getTempRet0;var iz=0;function jb(i){i=i|0;var e=0;e=ii;ii=ii+i|0;ii=ii+15&-16;return e|0}function i6(){return ii|0}function iL(e){e=e|0;ii=e}function ig(i,e){i=i|0;e=e|0;ii=i;ih=e}function hW(i,e){i=i|0;e=e|0;if(!ic){ic=i;ib=e}}function hR(){return ie+1892368|0}function je(){return ie+1990672|0}function i7(){return ie+0|0}function iS(){return ie+4374544|0}function im(){return ie+1998864|0}function hX(){return ie+1998864+(iv[ie+32768>>2]<<1)|0}function hS(){return ie+2523152|0}function jg(){return ie+2523152+((iv[ie+32772>>2]|0)*20|0)|0}function i9(){return iv[ie+32772>>2]|0}function iY(){iv[ie+32768>>2]=0;iv[ie+32772>>2]=0;return}function it(){return ie+32776|0}function hY(){return ie+3833872|0}function hT(){iv[ie+40968>>2]=0;iv[ie+40972>>2]=0;return}function jh(){return ie+3842064|0}function jc(){return ie+3842064+(iv[ie+40968>>2]<<1)|0}function i3(){return ie+40976|0}function iy(){return ie+40976+((iv[ie+40972>>2]|0)*28|0)|0}function hZ(){return iv[ie+40972>>2]|0}function hU(){return ie+1875984|0}function hQ(T,i){T=T|0;i=i|0;var jj=0,ji=0,ja=0,ia=0;ji=(i|0)>0;if(ji){jj=0;do{ja=ie+1875984+(jj<<2)|0;ip[ja>>2]=+ip[ja>>2]/100;jj=jj+1|0}while((jj|0)!=(i|0))}if((i|0)>=(T|0)|ji^1){return}else{jj=i}do{ji=0;do{ia=ji+jj|0;ja=ie+1875984+(ia<<2)|0;ip[ja>>2]=+ip[ie+1875984+(ia-i<<2)>>2]+ +ip[ja>>2]/100;ji=ji+1|0}while((ji|0)!=(i|0));jj=jj+i|0}while((jj|0)<(T|0));return}function jd(jI,jH,jG,jF,jE,jD,jC,jB,jA,jz,jy,jx,jv){jI=jI|0;jH=jH|0;jG=jG|0;jF=jF|0;jE=jE|0;jD=+jD;jC=jC|0;jB=jB|0;jA=jA|0;jz=jz|0;jy=jy|0;jx=jx|0;jv=jv|0;var jt=0,jr=0,jq=0,jo=0,jm=0,jk=0,ji=0,ia=0,T=0,jw=0,ju=0,js=0,jp=0,jn=0,jl=0,jj=0,ja=0;jn=(jI|0)/2|0;jl=jy<<24>>24==1;if(jl){iw[ie+4366352>>1]=0;if((jz|0)>2){jt=0;jr=2;do{ja=+(iv[ie+0+(jr<<2)>>2]|0);jj=+(iv[ie+0+((jr|1)<<2)>>2]|0);jt=(~~(+iZ(+(ja*ja+jj*jj))/10)<<16>>16)+(jt<<16>>16)|0;iw[ie+4366352+(((jr|0)/2|0)<<1)>>1]=jt;jr=jr+2|0}while((jr|0)<(jz|0));jt=4}}else{jt=4}if((jt|0)==4?(jz|0)>2:0){jt=2;jr=iv[ie+0>>2]|0;do{js=ie+0+(jt<<2)|0;jr=(iv[js>>2]|0)+jr|0;iv[js>>2]=jr;js=jt|1;jp=ie+0+(js<<2)|0;iv[jp>>2]=(iv[jp>>2]|0)+(iv[ie+0+(js+-2<<2)>>2]|0);jt=jt+2|0}while((jt|0)<(jz|0))}if(jA<<24>>24){iw[ie+1892368>>1]=iw[ie+1892368+8>>1]|0;iw[ie+1892368+2>>1]=iw[ie+1892368+10>>1]|0;iw[ie+1892368+4>>1]=iw[ie+1892368+12>>1]|0;iw[ie+1892368+6>>1]=iw[ie+1892368+14>>1]|0;jp=jn<<1;iw[ie+1892368+(jp+-2<<1)>>1]=iw[ie+1892368+(jp+-6<<1)>>1]|0;iw[ie+1892368+(jp+-1<<1)>>1]=iw[ie+1892368+(jp+-5<<1)>>1]|0;iw[ie+1892368+(jp+-4<<1)>>1]=iw[ie+1892368+(jp+-8<<1)>>1]|0;iw[ie+1892368+(jp+-3<<1)>>1]=iw[ie+1892368+(jp+-7<<1)>>1]|0}js=jv-jx|0;jp=iv[ie+32772>>2]|0;if((jI|0)<=1){i4(js,jp);return}jw=(jC|0)==0;ju=jn+-2|0;jk=jy<<24>>24==2;ji=jn+-1|0;ia=jn+-4|0;T=jx+1|0;jm=jv+-1|0;jq=0;jt=0;jo=jp;do{if((jq|0)>=4){if((ia|0)>(jq|0)){jz=T+((jq+-4|0)/5|0)|0}else{jz=jm}}else{jz=jx}if(!jw){jt=iw[ie+1990672+(jz<<1)>>1]|0}jI=jz<<1;jv=((iv[ie+0+(jI<<2)>>2]|0)/10|0)&65535;jI=((iv[ie+0+((jI|1)<<2)>>2]|0)/10|0)&65535;jy=jq<<1;jC=~~(+(iw[ie+1892368+(jy<<1)>>1]|0)*jD/10);jy=~~(+(iw[ie+1892368+((jy|1)<<1)>>1]|0)*jD/10);ix:do{if(!((jq|0)==0|(jq|0)==(ju|0))){if((jq|0)==1|(jq|0)==(ji|0)){jA=-1}else{jr=jq+-2|0;switch((jr|0)%5|0|2|0){case 2:jA=1;break ix;case 3:jA=-1;break ix;default:jA=ix[((jr|0)/5|0)+(ie+4374544)>>0]|0;break ix}}}else{jA=1}}while(0);if(jl){jr=iw[ie+4366352+(jz<<1)>>1]|0}else{jr=jk?((jz|0)==0?0:10):0}jz=jo;jo=jo+1|0;iw[ie+2523152+(jz*20|0)>>1]=jv;iw[ie+2523152+(jz*20|0)+2>>1]=jI;iw[ie+2523152+(jz*20|0)+4>>1]=jC;iw[ie+2523152+(jz*20|0)+6>>1]=jy;ix[ie+2523152+(jz*20|0)+8>>0]=jH;ix[ie+2523152+(jz*20|0)+9>>0]=jG;ix[ie+2523152+(jz*20|0)+10>>0]=jF;ix[ie+2523152+(jz*20|0)+11>>0]=jE;iw[ie+2523152+(jz*20|0)+12>>1]=jA;iw[ie+2523152+(jz*20|0)+14>>1]=jt;iw[ie+2523152+(jz*20|0)+16>>1]=jB;iw[ie+2523152+(jz*20|0)+18>>1]=jr;jq=jq+1|0}while((jq|0)<(jn|0));iv[ie+32772>>2]=jo;i4(js,jp);return}function i4(js,jr){js=js|0;jr=jr|0;var jq=0,jp=0,jo=0,jn=0,jm=0,jl=0,jk=0,jj=0,ji=0,ja=0,ia=0,T=0;jj=js+-1|0;jk=js+-2|0;jl=0;jq=1;jp=1;jm=iv[ie+32768>>2]|0;while(1){js=jq+1|0;ja=js+jr|0;js=(js&1|0)==0;jn=jp<<24>>24!=0;ia=ja+-2|0;ji=jq+jr|0;jo=jn?ia:ji;ia=jn?ji:ia;iw[ie+1998864+(jm<<1)>>1]=js?jo:ia;iw[ie+1998864+(jm+1<<1)>>1]=js?ia:jo;iw[ie+1998864+(jm+2<<1)>>1]=ja;ja=jq+2|0;jo=ja+jr|0;ja=(ja&1|0)==0;ia=jo+-1|0;js=jn?ji:ia;ji=jn?ia:ji;iw[ie+1998864+(jm+3<<1)>>1]=ja?js:ji;iw[ie+1998864+(jm+4<<1)>>1]=ja?ji:js;js=jm+6|0;iw[ie+1998864+(jm+5<<1)>>1]=jo;if((jl|0)>=(jj|0)){break}ja=jq+3|0;jo=ja+jr|0;ja=(ja&1|0)==0;ji=jo+-2|0;T=jo+-1|0;ia=jn?ji:T;ji=jn?T:ji;iw[ie+1998864+(js<<1)>>1]=ja?ia:ji;iw[ie+1998864+(jm+7<<1)>>1]=ja?ji:ia;iw[ie+1998864+(jm+8<<1)>>1]=jo;jo=jq+4|0;ia=jo+jr|0;ji=(jo&1|0)==0;ja=ia+-2|0;T=ia+-1|0;js=jn?ja:T;ja=jn?T:ja;iw[ie+1998864+(jm+9<<1)>>1]=ji?js:ja;iw[ie+1998864+(jm+10<<1)>>1]=ji?ja:js;js=jm+12|0;iw[ie+1998864+(jm+11<<1)>>1]=ia;if((jl|0)==(jk|0)){jq=jo}else{jq=jq+5|0;T=jq+jr|0;ji=(jq&1|0)==0;ja=T+-2|0;jo=T+-1|0;ia=jn?ja:jo;ja=jn?jo:ja;iw[ie+1998864+(js<<1)>>1]=ji?ia:ja;iw[ie+1998864+(jm+13<<1)>>1]=ji?ja:ia;iw[ie+1998864+(jm+14<<1)>>1]=T;jp=jp<<24>>24==0&1;js=jm+15|0}jl=jl+1|0;jm=js}iv[ie+32768>>2]=js;return}function jf(jD,jC,jB,jA,jz,jy,jx,jw,jv,ju,js){jD=jD|0;jC=jC|0;jB=+jB;jA=jA|0;jz=jz|0;jy=jy|0;jx=jx|0;jw=jw|0;jv=jv|0;ju=ju|0;js=js|0;var jq=0,jo=0,jm=0,jk=0,ji=0,ja=0,ia=0,T=0,e=0,jt=0,jr=0,jp=0,jn=0,jl=0,jj=0;if((jD|0)>2){jq=2;jo=iv[ie+32776>>2]|0;do{jk=ie+32776+(jq<<2)|0;jo=(iv[jk>>2]|0)+jo|0;iv[jk>>2]=jo;jk=jq|1;ji=ie+32776+(jk<<2)|0;iv[ji>>2]=(iv[ji>>2]|0)+(iv[ie+32776+(jk+-2<<2)>>2]|0);jq=jq+2|0}while((jq|0)<(jD|0))}jk=iv[ie+40972>>2]|0;ji=(jD|0)>0;if(ji){jo=jk+((jD+-1|0)>>>1)|0;jq=0;jm=jk;while(1){ja=+(iv[ie+32776+((jq|1)<<2)>>2]|0)/100;ip[ie+40976+(jm*28|0)>>2]=+(iv[ie+32776+(jq<<2)>>2]|0)/100;ip[ie+40976+(jm*28|0)+4>>2]=ja;ip[ie+40976+(jm*28|0)+8>>2]=jB;ip[ie+40976+(jm*28|0)+12>>2]=0;ip[ie+40976+(jm*28|0)+16>>2]=0;ip[ie+40976+(jm*28|0)+20>>2]=1;ix[ie+40976+(jm*28|0)+24>>0]=jA;ix[ie+40976+(jm*28|0)+25>>0]=jz;ix[ie+40976+(jm*28|0)+26>>0]=jy;ix[ie+40976+(jm*28|0)+27>>0]=jx;jq=jq+2|0;if((jq|0)>=(jD|0)){break}else{jm=jm+1|0}}jq=jo+1|0;iv[ie+40972>>2]=jq}else{jq=jk}if((jC|0)>0){jA=iv[ie+40968>>2]|0;jo=0;jm=jA;while(1){iw[ie+3842064+(jm<<1)>>1]=(ir[ie+3833872+(jo<<1)>>1]|0)+jk;jo=jo+1|0;if((jo|0)==(jC|0)){break}else{jm=jm+1|0}}iv[ie+40968>>2]=jA+jC}if(!ji){return}jA=jD+-2|0;jm=iv[ie+40968>>2]|0;jy=(jD+-1|0)>>>1;jz=jq+(jy<<2)|0;jy=jm+(jy*6|0)|0;jo=0;while(1){jp=+(iv[ie+32776+(jo<<2)>>2]|0)/100;jr=+(iv[ie+32776+((jo|1)<<2)>>2]|0)/100;jC=jo;jo=jo+2|0;jx=(jC|0)==(jA|0);jt=+(iv[ie+32776+((jx?0:jo)<<2)>>2]|0)/100;e=+(iv[ie+32776+((jx?1:jC+3|0)<<2)>>2]|0)/100;jl=jt-jp;ja=e-jr;jn=jp-jp;jj=jr-jr;T=ja*jB-jj*0;ia=jn*0-jl*jB;ja=jj*jl-jn*ja;jC=jq+1|0;ip[ie+40976+(jq*28|0)>>2]=jp;ip[ie+40976+(jq*28|0)+4>>2]=jr;ip[ie+40976+(jq*28|0)+8>>2]=0;ip[ie+40976+(jq*28|0)+12>>2]=T;ip[ie+40976+(jq*28|0)+16>>2]=ia;ip[ie+40976+(jq*28|0)+20>>2]=ja;ix[ie+40976+(jq*28|0)+24>>0]=jw;ix[ie+40976+(jq*28|0)+25>>0]=jv;ix[ie+40976+(jq*28|0)+26>>0]=ju;ix[ie+40976+(jq*28|0)+27>>0]=js;jx=jq+2|0;ip[ie+40976+(jC*28|0)>>2]=jp;ip[ie+40976+(jC*28|0)+4>>2]=jr;ip[ie+40976+(jC*28|0)+8>>2]=jB;ip[ie+40976+(jC*28|0)+12>>2]=T;ip[ie+40976+(jC*28|0)+16>>2]=ia;ip[ie+40976+(jC*28|0)+20>>2]=ja;ix[ie+40976+(jC*28|0)+24>>0]=jw;ix[ie+40976+(jC*28|0)+25>>0]=jv;ix[ie+40976+(jC*28|0)+26>>0]=ju;ix[ie+40976+(jC*28|0)+27>>0]=js;ji=jq+3|0;ip[ie+40976+(jx*28|0)>>2]=jt;ip[ie+40976+(jx*28|0)+4>>2]=e;ip[ie+40976+(jx*28|0)+8>>2]=0;ip[ie+40976+(jx*28|0)+12>>2]=T;ip[ie+40976+(jx*28|0)+16>>2]=ia;ip[ie+40976+(jx*28|0)+20>>2]=ja;ix[ie+40976+(jx*28|0)+24>>0]=jw;ix[ie+40976+(jx*28|0)+25>>0]=jv;ix[ie+40976+(jx*28|0)+26>>0]=ju;ix[ie+40976+(jx*28|0)+27>>0]=js;ip[ie+40976+(ji*28|0)>>2]=jt;ip[ie+40976+(ji*28|0)+4>>2]=e;ip[ie+40976+(ji*28|0)+8>>2]=jB;ip[ie+40976+(ji*28|0)+12>>2]=T;ip[ie+40976+(ji*28|0)+16>>2]=ia;ip[ie+40976+(ji*28|0)+20>>2]=ja;ix[ie+40976+(ji*28|0)+24>>0]=jw;ix[ie+40976+(ji*28|0)+25>>0]=jv;ix[ie+40976+(ji*28|0)+26>>0]=ju;ix[ie+40976+(ji*28|0)+27>>0]=js;jk=jq&65535;iw[ie+3842064+(jm<<1)>>1]=jk;iw[ie+3842064+(jm+1<<1)>>1]=jx;ji=ji&65535;iw[ie+3842064+(jm+2<<1)>>1]=ji;iw[ie+3842064+(jm+3<<1)>>1]=jk;iw[ie+3842064+(jm+4<<1)>>1]=ji;iw[ie+3842064+(jm+5<<1)>>1]=jC;if((jo|0)>=(jD|0)){break}else{jm=jm+6|0;jq=jq+4|0}}iv[ie+40972>>2]=jz+4;iv[ie+40968>>2]=jy+6;return}function i8(){}return{_reset_line:iY,_get_block_index_start:jh,setThrew:hW,_get_line_turnings_address:iS,_get_block_triangle_indices_address:hY,_get_line_vertex_count:i9,stackAlloc:jb,_get_block_vertex_count:hZ,_get_block_vertex_start:i3,_get_line_vertex_end:jg,_get_feature_points_address:hU,stackRestore:iL,_get_block_index_end:jc,_get_line_altitudes_address:je,_get_block_vertex_end:iy,stackSave:i6,runPostSets:i8,_get_line_vertex_start:hS,_parse_points:hQ,_get_line_points_address:i7,establishStackSpace:ig,_get_line_index_end:hX,_append_line_data:jd,_get_line_index_start:im,_append_block_data:jf,_get_block_points_address:it,_reset_block:hT,_get_line_data_address:hR}}var b3;var fr;var gq;var hh;var ef;var eP;var ds;var gR;var fX;var e5;var ew;var dB;var fM;var gC;var bF;var eO;var cZ;var eo;if(!ArrayBuffer.prototype.slice){ArrayBuffer.prototype.slice=function(T,i){if(T===undefined){T=0}if(i===undefined){i=this.byteLength}T=Math.floor(T);i=Math.floor(i);if(T<0){T+=this.byteLength}if(i<0){i+=this.byteLength}T=Math.min(Math.max(0,T),this.byteLength);i=Math.min(Math.max(0,i),this.byteLength);if(i-T<=0){return new ArrayBuffer(0)}var e=new ArrayBuffer(i-T);var hR=new Uint8Array(e);var hQ=new Uint8Array(this,T,i-T);hR.set(hQ);return e}}function gX(i){var e=70;if(b3){i&&i();return}b3=new ArrayBuffer(e*65536);gq=new Float32Array(b3);hh=new Int32Array(b3);fr=new Int8Array(b3);ef=new Int16Array(b3);eP=new Uint16Array(b3);ds=self.createWasmModule(self,{DYNAMICTOP_PTR:0,tempDoublePtr:0,ABORT:0,STACKTOP:0,STACK_MAX:0,gb:0,fb:0},b3);i&&i()}function bk(e){if(!gR){gR=ds._get_line_data_address()>>1}ef.set(e,gR)}function M(e){if(!fX){fX=ds._get_line_altitudes_address()>>1}ef.set(e,fX)}function aK(e){if(!e5){e5=ds._get_line_points_address()>>2}hh.set(e,e5)}function ho(e){if(!ew){ew=ds._get_line_turnings_address()}fr.set(e,ew)}function gp(e){if(!gC){gC=ds._get_block_points_address()>>2}hh.set(e,gC)}function e7(e){if(!bF){bF=ds._get_block_triangle_indices_address()>>1}eP.set(e,bF)}var fp={parseFeature:function(i,T){var e=i.length;T=T||2;if(!eo){eo=ds._get_feature_points_address()>>2}gq.set(i,eo);ds._parse_points(e,T);return new Float32Array(b3.slice(eo<<2,(eo+e)<<2))},getBlockVertices:function(){if(!cZ){cZ=ds._get_block_vertex_start()}return new Float32Array(b3.slice(cZ,ds._get_block_vertex_end()))},getBlockIndices:function(){if(!eO){eO=ds._get_block_index_start()}return new Uint16Array(b3.slice(eO,ds._get_block_index_end()))},getBlockVertexCount:function(){return ds._get_block_vertex_count()},getLineVertices:function(){if(!fM){fM=ds._get_line_vertex_start()}return new Float32Array(b3.slice(fM,ds._get_line_vertex_end()))},getLineIndices:function(){if(!dB){dB=ds._get_line_index_start()}return new Uint16Array(b3.slice(dB,ds._get_line_index_end()))},getLineVertexCount:function(){return ds._get_line_vertex_count()},appendLineData:function(hT,hS,hQ,i,hW,e,hY,hU,hX,T,hR){var hV=0;if(i){hV=i.length;M(i)}if(hU&&hU.length){ho(hU)}hW=hW||0;T=T||0;hR=hR||hY.length/2;bk(hT);aK(hY);ds._append_line_data(hT.length,hS[0],hS[1],hS[2],hS[3],hQ,hV,hW,e?1:0,hY.length,hX,T,hR)},resetLine:function(){ds._reset_line()},appendBlockData:function(hX,hV,hT,hS,hW,e,T,hU,i,hQ,hR){gp(hX);e7(hV);return ds._append_block_data(hX.length,hV.length,hT,hS,hW,e,T,hU,i,hQ,hR)},resetBlock:function(){ds._reset_block()},initWasmModule:gX};var bW={block:[["precision highp float;attribute vec4 a_pos;attribute vec4 a_normal;attribute vec4 a_color;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform mat4 u_normal_matrix;uniform vec3 u_side_light_dir;uniform bool u_is_normal;varying vec4 _;varying float a;const vec3 b=vec3(0.06,0.06,0.06);vec3 c=vec3(0.1,0.1,0.1);void main(){vec4 d=u_proj_matrix*u_mv_matrix*a_pos;gl_Position=d;a=-1./500.-a_pos.z/100.;gl_Position.z=gl_Position.z+a;if(!u_is_normal){c=vec3(0.2,0.2,0.2);}if(u_is_normal&&a_normal==vec4(0.,0.,1.,1.)){_=a_color;}else{vec3 e=a_color.rgb;vec3 f=normalize(vec3(u_normal_matrix*a_normal));vec4 g=u_mv_matrix*vec4(0,1,0,0);vec3 h=normalize(g.xyz);float i=max(0.,dot(f,-h));vec4 j=u_mv_matrix*vec4(u_side_light_dir,0);vec3 k=normalize(j.xyz);float l=max(0.,dot(f,-k));if(a_pos.z<2.){float m=(2.-a_pos.z)/5.;l=l-m;}_=vec4(e+e*c*l+e*b*i,a_color.a);}}",""].join("\\n"),["precision highp float;varying vec4 _;varying float a;uniform float u_camera_far;float b=500.0;void main(){float c=(gl_FragCoord.z/gl_FragCoord.w-a);float d=_.a;if(c>u_camera_far-b){d=d*(u_camera_far-c)/b;if(d<=0.){discard;}}gl_FragColor=vec4(_.rgb,d);}",""].join("\\n")],shadow:[["precision highp float;attribute vec3 a_pos;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform vec3 u_light_dir;varying vec4 _;varying float a;const vec4 b=vec4(153.0/255.0,157.0/255.0,170.0/255.0,.15);void main(){float c=u_light_dir.x/u_light_dir.z*a_pos.z;float d=u_light_dir.y/u_light_dir.z*a_pos.z;vec2 e=vec2(a_pos.x+c,a_pos.y+d);a=a_pos.z;gl_Position=u_proj_matrix*u_mv_matrix*vec4(e,0,1);_=b;}",""].join("\\n"),["precision highp float;varying vec4 _;varying float a;uniform float u_camera_far;float b=500.0;void main(){if(a<1.){discard;}else{float c=gl_FragCoord.z/gl_FragCoord.w;float d=_.a;if(c>u_camera_far-b){d=d*(u_camera_far-c)/b;if(d<=0.){discard;}}gl_FragColor=vec4(_.rgb,d);}}",""].join("\\n")],arrow:[["precision highp float;attribute vec3 a_pos;attribute vec2 a_diff;attribute vec2 a_normal;attribute vec2 a_tex;attribute float a_layer_index;varying vec2 _;varying float a;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform float u_scale;uniform bool u_flat;void main(){float b=a_pos.z;vec2 c=(a_pos.xy+a_diff*u_scale)+normalize(a_normal)*2.5*u_scale;float d=-a_layer_index/500.-b/100.;if(u_flat){a=0.;gl_Position=u_proj_matrix*u_mv_matrix*vec4(c,0.,1);vec4 e=u_proj_matrix*u_mv_matrix*vec4(c,b/10.,1);gl_Position.z=e.z+d;}else{a=b;gl_Position=u_proj_matrix*u_mv_matrix*vec4(c,b,1);gl_Position.z=gl_Position.z+d;}_=a_tex;}",""].join("\\n"),["precision mediump float;uniform sampler2D u_image;uniform int u_draw_part;varying vec2 _;varying float a;void main(){if(u_draw_part==1){if(a>0.){discard;}}else if(u_draw_part==2){if(a==0.){discard;}}gl_FragColor=texture2D(u_image,_);}",""].join("\\n")],grid:[["precision highp float;attribute vec2 a_pos;attribute vec2 a_tex;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform float u_tex_scale;varying vec2 _;void main(){vec4 a=u_proj_matrix*u_mv_matrix*vec4(a_pos,0,1);gl_Position=a;_=a_tex*u_tex_scale;}",""].join("\\n"),["precision mediump float;uniform sampler2D u_image;varying vec2 _;void main(){gl_FragColor=texture2D(u_image,_);}",""].join("\\n")],line:[["attribute vec2 a_pos;attribute vec2 a_normal;attribute vec4 a_color;attribute vec4 a_data;uniform mat4 u_mv_matrix;uniform mat4 u_proj_matrix;uniform float u_scale;uniform bool u_flat;varying float _;varying vec4 a;varying float b;varying float c;varying float d;const float e=0.5;void main(){vec2 f=a_normal/10.;_=a_data.x;float g=a_data.y/100.;float h=a_data.z;float i=length(f);float j=1.+e/i;b=1.-(2.*e/(i+e));a=a_color;d=-h/500.-g/100.;vec2 k=a_pos/10.+f*j*u_scale;if(u_flat){gl_Position=u_proj_matrix*u_mv_matrix*vec4(k,0.,1);vec4 l=u_proj_matrix*u_mv_matrix*vec4(k,g/10.,1);gl_Position.z=l.z+d;c=0.;}else{gl_Position=u_proj_matrix*u_mv_matrix*vec4(k,g,1.);gl_Position.z=gl_Position.z+d;c=g;}}",""].join("\\n"),["precision highp float;uniform int u_draw_part;varying float _;varying vec4 a;varying float b;varying float c;varying float d;uniform float u_camera_far;float e=500.0;void main(){if(u_draw_part==1){if(c>0.){discard;}}else if(u_draw_part==2){if(c==0.){discard;}}vec4 f;if(abs(_)>b){float g=1.-(abs(_)-b)/(1.-b);f=vec4(a.rgb,g*a.a);}else{f=a;}float g=(gl_FragCoord.z/gl_FragCoord.w-d);float h=f.a;if(g>u_camera_far-e){h=h*(u_camera_far-g)/e;if(h<=0.){discard;}}f.a=h;gl_FragColor=f;}",""].join("\\n")],dash:[["attribute vec2 a_pos;attribute vec2 a_normal;attribute vec4 a_color;attribute vec4 a_data;uniform mat4 u_mv_matrix;uniform mat4 u_proj_matrix;uniform float u_scale;uniform float u_dash;uniform float u_step_zoom;uniform float u_tile_zoom;uniform bool u_is_single;uniform bool u_flat;varying float _;varying vec2 a;varying vec4 b;varying float c;varying float d;varying float e;const float f=0.2;void main(){vec2 g=a_normal/10.;_=a_data.x;float h=a_data.y/100.;float i=a_data.z;float j=a_data.w/10.;float k=length(g);float l=1.+f/k;c=1.-(2.*f/(k+f));b=vec4(a_color.rgb,0.);float m=0.;if(u_is_single){m=j;}else{m=j/u_dash/pow(2.,u_tile_zoom-u_step_zoom);}if(_==1.){a=vec2(1.,m);}else{a=vec2(0.,m);}e=-i/500.-h/100.;vec2 n=a_pos/10.+g*l*u_scale;if(u_flat){gl_Position=u_proj_matrix*u_mv_matrix*vec4(n,0.,1);vec4 o=u_proj_matrix*u_mv_matrix*vec4(n,h/10.,1);gl_Position.z=o.z+e;d=0.;}else{gl_Position=u_proj_matrix*u_mv_matrix*vec4(n,h,1.);gl_Position.z=gl_Position.z+e;d=h;}}",""].join("\\n"),["precision highp float;uniform sampler2D u_image;uniform float u_dash;uniform int u_draw_part;varying vec4 b;varying float _;varying vec2 a;varying float d;varying float e;varying float c;uniform float u_camera_far;float f=500.0;void main(){if(u_draw_part==1){if(d>0.){discard;}}else if(u_draw_part==2){if(d==0.){discard;}}vec4 g=gl_FragColor=texture2D(u_image,a);float h=g.a+b.a;vec4 i;if(abs(_)>c){float j=1.-(abs(_)-c)/(1.-c);i=vec4(g.rgb*j,j*h);}else{i=g;}float j=(gl_FragCoord.z/gl_FragCoord.w-e);float k=i.a;if(j>u_camera_far-f){k=k*(u_camera_far-j)/f;if(k<=0.){discard;}}i.a=k;gl_FragColor=i;}",""].join("\\n")],line:[["attribute vec2 a_pos;attribute vec2 a_normal;attribute vec4 a_color;attribute vec4 a_data;uniform mat4 u_mv_matrix;uniform mat4 u_proj_matrix;uniform float u_scale;uniform bool u_flat;varying float _;varying vec4 a;varying float b;varying float c;varying float d;const float e=0.5;void main(){vec2 f=a_normal/10.;_=a_data.x;float g=a_data.y/100.;float h=a_data.z;float i=length(f);float j=1.+e/i;b=1.-(2.*e/(i+e));a=a_color;d=-h/500.-g/100.;vec2 k=a_pos/10.+f*j*u_scale;if(u_flat){gl_Position=u_proj_matrix*u_mv_matrix*vec4(k,0.,1);vec4 l=u_proj_matrix*u_mv_matrix*vec4(k,g/10.,1);gl_Position.z=l.z+d;c=0.;}else{gl_Position=u_proj_matrix*u_mv_matrix*vec4(k,g,1.);gl_Position.z=gl_Position.z+d;c=g;}}",""].join("\\n"),["precision highp float;uniform int u_draw_part;varying float _;varying vec4 a;varying float b;varying float c;varying float d;uniform float u_camera_far;float e=500.0;void main(){if(u_draw_part==1){if(c>0.){discard;}}else if(u_draw_part==2){if(c==0.){discard;}}vec4 f;if(abs(_)>b){float g=1.-(abs(_)-b)/(1.-b);f=vec4(a.rgb,g*a.a);}else{f=a;}float g=(gl_FragCoord.z/gl_FragCoord.w-d);float h=f.a;if(g>u_camera_far-e){h=h*(u_camera_far-g)/e;if(h<=0.){discard;}}f.a=h;gl_FragColor=f;}",""].join("\\n")],fill:[["precision highp float;attribute vec3 a_pos;attribute vec4 a_color;attribute float a_layer_index;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform bool u_flat;varying vec4 _;varying float a;varying float b;void main(){float c=a_pos.z;b=-a_layer_index/500.-c/100.;if(u_flat){gl_Position=u_proj_matrix*u_mv_matrix*vec4(a_pos.xy,0.,1);vec4 d=u_proj_matrix*u_mv_matrix*vec4(a_pos.xy,c/10.,1);gl_Position.z=d.z+b;a=0.;}else{gl_Position=u_proj_matrix*u_mv_matrix*vec4(a_pos.xy,c,1);gl_Position.z=gl_Position.z+b;a=c;}_=a_color;}",""].join("\\n"),["precision highp float;uniform int u_draw_part;varying vec4 _;varying float a;varying float b;uniform float u_camera_far;float c=500.0;void main(){if(u_draw_part==1){if(a>0.){discard;}}else if(u_draw_part==2){if(a==0.){discard;}}float d=(gl_FragCoord.z/gl_FragCoord.w-b);float e=_.a/255.;if(d>u_camera_far-c){e=e*(u_camera_far-d)/c;if(e<=0.){discard;}}gl_FragColor=vec4(_.r/255.,_.g/255.,_.b/255.,e);}",""].join("\\n")],debug:[["precision highp float;attribute vec2 a_pos;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;void main(){gl_Position=u_proj_matrix*u_mv_matrix*vec4(a_pos,step(32767.,a_pos.x),1);}",""].join("\\n"),["precision mediump float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}",""].join("\\n")],symbol:[["precision highp float;attribute vec4 aPosition;attribute float aZLevel;attribute vec2 aExtend;attribute vec2 aLoopOffset;attribute vec2 aVertexTextureCoord;varying vec2 _;varying vec2 a;varying vec3 b;uniform bool uUseRound;uniform mat4 uMVMatrix;uniform mat4 uPMatrix;uniform mat4 uOrthoPMatrix;uniform vec2 uMapHalfSize;uniform float uMapZoom;uniform vec3 uCameraPosHigh;uniform vec3 uCameraPosLow;uniform vec3 uFixPositionInfo;void main(){vec4 c;vec3 d=vec3(aPosition.xy,aZLevel);vec3 e=vec3(aPosition.zw,aZLevel);a=vec2(1.,1.);d.x+=aLoopOffset.x;e.x+=aLoopOffset.y;vec4 f=uPMatrix*uMVMatrix*vec4((d-uCameraPosHigh)+(e-uCameraPosLow),1.);float g=f[3]+100.;if((f[0]<-g||f[0]>g||f[1]<-g||f[1]>g||f[2]<-g||f[2]>g)&&uFixPositionInfo[0]!=1.){a=vec2(0.,0.);}vec3 h=vec3(f[0]/f[3],f[1]/f[3],f[2]/f[3]);vec3 i=vec3((h[0]+1.)*uMapHalfSize[0],(1.-h[1])*uMapHalfSize[1],0.5*h[2]+0.5);if(uFixPositionInfo[0]==1.){float j=uMapHalfSize[0]*2.;if(i[0]>j+20.){d.x-=uFixPositionInfo[1];e.x-=uFixPositionInfo[2];f=uPMatrix*uMVMatrix*vec4((d-uCameraPosHigh)+(e-uCameraPosLow),1.);h=vec3(f[0]/f[3],f[1]/f[3],f[2]/f[3]);i=vec3((h[0]+1.)*uMapHalfSize[0],(1.-h[1])*uMapHalfSize[1],0.5*h[2]+0.5);}else if(i[0]<-20.){d.x+=uFixPositionInfo[1];e.x+=uFixPositionInfo[2];f=uPMatrix*uMVMatrix*vec4((d-uCameraPosHigh)+(e-uCameraPosLow),1.);h=vec3(f[0]/f[3],f[1]/f[3],f[2]/f[3]);i=vec3((h[0]+1.)*uMapHalfSize[0],(1.-h[1])*uMapHalfSize[1],0.5*h[2]+0.5);}}c=vec4(i.xy,-100.,1.);c.y=uMapHalfSize[1]*2.-c.y;if(uUseRound==true){c.x=floor(c.x+.5);c.y=floor(c.y+.5);}c.x+=aExtend.x;c.y+=aExtend.y;b=vec3(1.,i.z,1./f[3]);gl_Position=uOrthoPMatrix*c;_=vec2(aVertexTextureCoord.xy);}",""].join("\\n"),["precision highp float;uniform sampler2D uSampler;uniform bool uForRenderPNG8Text;uniform bool uHighlight;uniform float uCameraFar;float c=500.0;varying vec2 _;varying vec2 a;varying vec3 b;void main(){if(a[0]==0.){discard;return;}vec4 d=texture2D(uSampler,_);if(uForRenderPNG8Text==true&&d.a<0.7){d.a=0.;}if(uHighlight==true){float e=d.a;if(e!=0.){float f=d.r;float g=d.g;float h=d.b;float i=floor((f*255.+g*255.+h*255.)/3.+0.5);float j=i-90.;if(j<0.){j=0.;}d.r=(51.+j*1.3)/255.;d.g=(133.+j*0.8)/255.;d.b=1.;}}float e=(b[1]/b[2]);float f=1.;if(e>uCameraFar-c){f=(uCameraFar-e)/c;if(f<=0.){discard;}}gl_FragColor=d*f;}",""].join("\\n")],symbolline:[["precision highp float;attribute vec2 aPosition;attribute float aZLevel;attribute vec2 aExtend;attribute vec2 aVertexTextureCoord;attribute vec2 aRotationCenter;attribute float aRotationAngle;varying vec2 _;varying vec2 a;uniform bool uUseRound;uniform mat4 uMVMatrix;uniform mat4 uPMatrix;uniform vec2 uMapHalfSize;uniform float uMapZoom;uniform bool uIsFlat;float b(float b){return pow(2.,18.-b);}void main(){vec4 c;float d=aZLevel;if(uIsFlat){d=0.;}a=vec2(1.,1.);float e=b(uMapZoom);vec2 f=aPosition.xy+aExtend.xy*e;float g=sin(radians(-aRotationAngle));float h=cos(radians(-aRotationAngle));mat2 i=mat2(h,-g,g,h);vec3 j=vec3(aRotationCenter.xy+i*(f.xy-aRotationCenter.xy),d);c=uMVMatrix*vec4(j,1.);gl_Position=uPMatrix*c;_=vec2(aVertexTextureCoord.xy);}",""].join("\\n"),["precision highp float;uniform sampler2D uSampler;uniform bool uForRenderPNG8Text;uniform float uCameraFar;float b=500.0;varying vec2 _;varying vec2 a;void main(){if(a[0]==0.){discard;return;}vec4 c=texture2D(uSampler,_);if(uForRenderPNG8Text==true&&c.a<0.7){c.a=0.;}float d;bool e=false;d=(gl_FragCoord.z/gl_FragCoord.w);float f=c.a;if(d>uCameraFar-b){f=f*(uCameraFar-d)/b;if(f<1.){discard;}}gl_FragColor=vec4(c.rgb,f);}",""].join("\\n")],raster:[["precision highp float;attribute vec3 aVertexPosition;attribute vec2 aVertexTextureCoord;varying vec2 _;uniform mat4 uMVMatrix;uniform mat4 uPMatrix;void main(){gl_Position=uPMatrix*uMVMatrix*vec4(aVertexPosition,1.);_=aVertexTextureCoord;}",""].join("\\n"),["precision highp float;uniform sampler2D uSampler;varying vec2 _;void main(){vec4 _=texture2D(uSampler,_);gl_FragColor=_;}",""].join("\\n")],sky:[["precision highp float;attribute vec3 aPos;uniform mat4 uPMatrix;uniform mat4 uMVMatrix;uniform float uHorizonY;uniform vec4 uGroundColor;uniform vec4 uSkyColor;varying vec4 _;void main(){vec2 a=aPos.xy;a.y+=uHorizonY;gl_Position=uPMatrix*uMVMatrix*vec4(a.xy,-2900.,1.);float b=aPos.z;if(b==0.){_=uGroundColor;}else{_=uSkyColor;}}",""].join("\\n"),["precision highp float;varying vec4 _;void main(){gl_FragColor=_;}",""].join("\\n")],smaa1:[["precision highp float;attribute vec3 position;attribute vec2 uv;uniform mat4 projectionMatrix;uniform mat4 modelViewMatrix;uniform vec2 resolution;varying vec2 _;varying vec4 a[3];void b(vec2 b){a[0]=b.xyxy+resolution.xyxy*vec4(-1.,0.,0.,1.);a[1]=b.xyxy+resolution.xyxy*vec4(1.,0.,0.,-1.);a[2]=b.xyxy+resolution.xyxy*vec4(-2.,0.,0.,2.);}void main(){_=uv;b(_);gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}",""].join("\\n"),["precision highp float;","#define A 0.1","uniform sampler2D tDiffuse;varying vec2 _;varying vec4 a[3];vec4 b(vec2 _,vec4 a[3],sampler2D b){vec2 c=vec2(A,A);vec4 d;vec3 e=texture2D(b,_).rgb;vec3 f=texture2D(b,a[0].xy).rgb;vec3 g=abs(e-f);d.x=max(max(g.r,g.g),g.b);vec3 h=texture2D(b,a[0].zw).rgb;g=abs(e-h);d.y=max(max(g.r,g.g),g.b);vec2 i=step(c,d.xy);if(dot(i,vec2(1.,1.))==0.)discard;vec3 j=texture2D(b,a[1].xy).rgb;g=abs(e-j);d.z=max(max(g.r,g.g),g.b);vec3 k=texture2D(b,a[1].zw).rgb;g=abs(e-k);d.w=max(max(g.r,g.g),g.b);float l=max(max(max(d.x,d.y),d.z),d.w);vec3 m=texture2D(b,a[2].xy).rgb;g=abs(e-m);d.z=max(max(g.r,g.g),g.b);vec3 n=texture2D(b,a[2].zw).rgb;g=abs(e-n);d.w=max(max(g.r,g.g),g.b);l=max(max(l,d.z),d.w);i.xy*=step(0.5*l,d.xy);return vec4(i,0.,0.);}void main(){gl_FragColor=b(_,a,tDiffuse);}",""].join("\\n")],smaa2:[["precision highp float;","#define A 8","#define B 16","#define C (1.0/vec2(160.0,560.0))","#define D (1.0/7.0)","attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;uniform mat4 projectionMatrix;uniform mat4 modelViewMatrix;varying vec2 _;varying vec4 a[3];varying vec2 b;void c(vec2 c){b=c/resolution;a[0]=c.xyxy+resolution.xyxy*vec4(-0.25,0.125,1.25,0.125);a[1]=c.xyxy+resolution.xyxy*vec4(-0.125,0.25,-0.125,-1.25);a[2]=vec4(a[0].xz,a[1].yw)+vec4(-2.,2.,-2.,2.)*resolution.xxyy*float(A);}void main(){_=uv;c(_);gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}",""].join("\\n"),["precision highp float;","#define A 8","#define B 16","#define C (1.0/vec2(160.0,560.0))","#define D (1.0/7.0)","#define E(tex,coord,offset) texture2D(tex,coord+float(offset)*resolution,0.0)","uniform sampler2D tDiffuse;uniform sampler2D tArea;uniform sampler2D tSearch;uniform vec2 resolution;varying vec2 _;varying vec4 a[3];varying vec2 b;vec2 c(vec2 _){return sign(_)*floor(abs(_)+0.5);}float d(sampler2D d,vec2 e,float f,float g){e.r=f+e.r*g;return 255.*texture2D(d,e,0.).r;}float e(sampler2D e,sampler2D f,vec2 g,float h){vec2 i=vec2(0.,1.);for(int j=0;j<A;j++){i=texture2D(e,g,0.).rg;g-=vec2(2.,0.)*resolution;if(!(g.x>h&&i.g>0.8281&&i.r==0.))break;}g.x+=0.25*resolution.x;g.x+=resolution.x;g.x+=2.*resolution.x;g.x-=resolution.x*d(f,i,0.,0.5);return g.x;}float f(sampler2D f,sampler2D g,vec2 h,float i){vec2 j=vec2(0.,1.);for(int k=0;k<A;k++){j=texture2D(f,h,0.).rg;h+=vec2(2.,0.)*resolution;if(!(h.x<i&&j.g>0.8281&&j.r==0.))break;}h.x-=0.25*resolution.x;h.x-=resolution.x;h.x-=2.*resolution.x;h.x+=resolution.x*d(g,j,0.5,0.5);return h.x;}float g(sampler2D g,sampler2D h,vec2 i,float j){vec2 k=vec2(1.,0.);for(int l=0;l<A;l++){k=texture2D(g,i,0.).rg;i+=vec2(0.,2.)*resolution;if(!(i.y>j&&k.r>0.8281&&k.g==0.))break;}i.y-=0.25*resolution.y;i.y-=resolution.y;i.y-=2.*resolution.y;i.y+=resolution.y*d(h,k.gr,0.,0.5);return i.y;}float h(sampler2D h,sampler2D i,vec2 j,float k){vec2 l=vec2(1.,0.);for(int m=0;m<A;m++){l=texture2D(h,j,0.).rg;j-=vec2(0.,2.)*resolution;if(!(j.y<k&&l.r>0.8281&&l.g==0.))break;}j.y+=0.25*resolution.y;j.y+=resolution.y;j.y+=2.*resolution.y;j.y-=resolution.y*d(i,l.gr,0.5,0.5);return j.y;}vec2 i(sampler2D i,vec2 j,float k,float l,float m){vec2 n=float(B)*c(4.*vec2(k,l))+j;n=C*n+(0.5*C);n.y+=D*m;return texture2D(i,n,0.).rg;}vec4 j(vec2 j,vec2 k,vec4 l[3],sampler2D m,sampler2D n,sampler2D o,ivec4 p){vec4 q=vec4(0.,0.,0.,0.);vec2 r=texture2D(m,j).rg;if(r.g>0.){vec2 s;vec2 t;t.x=e(m,o,l[0].xy,l[2].x);t.y=l[1].y;s.x=t.x;float u=texture2D(m,t,0.).r;t.x=f(m,o,l[0].zw,l[2].y);s.y=t.x;s=s/resolution.x-k.x;vec2 v=sqrt(abs(s));t.y-=1.*resolution.y;float w=E(m,t,ivec2(1,0)).r;q.rg=i(n,v,u,w,float(p.y));}if(r.r>0.){vec2 s;vec2 t;t.y=g(m,o,l[1].xy,l[2].z);t.x=l[0].x;s.x=t.y;float u=texture2D(m,t,0.).g;t.y=h(m,o,l[1].zw,l[2].w);s.y=t.y;s=s/resolution.y-k.y;vec2 v=sqrt(abs(s));t.y-=1.*resolution.y;float w=E(m,t,ivec2(0,1)).g;q.ba=i(n,v,u,w,float(p.x));}return q;}void main(){gl_FragColor=j(_,b,a,tDiffuse,tArea,tSearch,ivec4(0.));}",""].join("\\n")],smaa3:[["precision highp float;uniform vec2 resolution;attribute vec3 position;attribute vec2 uv;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;varying vec2 _;varying vec4 a[2];void b(vec2 b){a[0]=b.xyxy+resolution.xyxy*vec4(-1.,0.,0.,1.);a[1]=b.xyxy+resolution.xyxy*vec4(1.,0.,0.,-1.);}void main(){_=uv;b(_);gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}",""].join("\\n"),["precision highp float;uniform sampler2D tDiffuse;uniform sampler2D tColor;uniform vec2 resolution;varying vec2 _;varying vec4 a[2];vec4 b(vec2 _,vec4 a[2],sampler2D b,sampler2D c){vec4 d;d.xz=texture2D(c,_).xz;d.y=texture2D(c,a[1].zw).g;d.w=texture2D(c,a[1].xy).a;if(dot(d,vec4(1.,1.,1.,1.))<1e-5){return texture2D(b,_,0.);}else{vec2 e;e.x=d.a>d.b?d.a:-d.b;e.y=d.g>d.r?-d.g:d.r;if(abs(e.x)>abs(e.y)){e.y=0.;}else{e.x=0.;}vec4 f=texture2D(b,_,0.);_+=sign(e)*resolution;vec4 g=texture2D(b,_,0.);float h=abs(e.x)>abs(e.y)?abs(e.x):abs(e.y);f.xyz=pow(f.xyz,vec3(2.2));g.xyz=pow(g.xyz,vec3(2.2));vec4 i=mix(f,g,h);i.xyz=pow(i.xyz,vec3(1./2.2));return i;}}void main(){gl_FragColor=b(_,a,tColor,tDiffuse);}",""].join("\\n")],overlayfill:[["precision highp float;attribute vec2 a_pos;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;void main(){gl_Position=u_proj_matrix*u_mv_matrix*vec4(a_pos,0,1);}",""].join("\\n"),["precision mediump float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}",""].join("\\n")],overlayblock:[["precision highp float;attribute vec4 a_pos;attribute vec4 a_normal;attribute vec4 a_color;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform mat4 u_normal_matrix;uniform vec3 u_side_light_dir;uniform bool u_is_normal;varying vec4 _;varying float a;varying vec4 b;const vec3 c=vec3(0.06,0.06,0.06);vec3 d=vec3(0.1,0.1,0.1);void main(){vec4 e=u_proj_matrix*u_mv_matrix*a_pos;gl_Position=e;a=-1./500.-a_pos.z/100.;gl_Position.z=gl_Position.z+a;b=a_normal;_=a_color;vec3 f=a_color.rgb;vec3 g=normalize(vec3(u_normal_matrix*a_normal));vec4 h=u_mv_matrix*vec4(0.5,0.5,0,0);vec3 i=normalize(h.xyz);float j=max(0.,dot(g,-i));_=vec4(f+f*c*j,a_color.a);}",""].join("\\n"),["precision highp float;varying vec4 _;varying float a;uniform float u_camera_far;float c=500.0;void main(){float d=(gl_FragCoord.z/gl_FragCoord.w-a);float e=_.a;if(d>u_camera_far-c){e=e*(u_camera_far-d)/c;if(e<=0.){discard;}}gl_FragColor=vec4(_.rgb,e);}",""].join("\\n")],marker3d:[["attribute vec4 a_pos;attribute float a_height;attribute vec4 a_color;attribute float a_shape;attribute float a_size;attribute vec4 a_texture_coord;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform vec3 u_camera_pos_high;uniform vec3 u_camera_pos_low;varying vec4 _;varying vec4 a;varying float b;void main(){if(a_color.w>=0.&&a_color.w<=1.){_=a_color;}else{_=vec4(a_color.xyz,1.);}b=a_shape;a=a_texture_coord;vec3 c=vec3(a_pos.xy,a_height);vec3 d=vec3(a_pos.zw,a_height);vec4 e=u_proj_matrix*u_mv_matrix*vec4((c-u_camera_pos_high)+(d-u_camera_pos_low),1.);gl_Position=e;gl_PointSize=a_size;}",""].join("\\n"),["precision mediump float;varying vec4 _;varying float b;varying vec4 a;uniform bool u_use_texture;uniform sampler2D u_Sampler;void main(){vec4 _=_;if(b==1.){float a=distance(gl_PointCoord,vec2(0.5,0.5));if(a>0.5){discard;}float b=1.;b=1.-smoothstep(0.49,0.5,a);_.a*=b;}if(u_use_texture){vec4 a=a;float b=a.x;float c=a.z-a.x;float d=a.y;float e=a.w-a.y;_=texture2D(u_Sampler,vec2(b+gl_PointCoord.x*c,d+e*(1.-gl_PointCoord.y)));}gl_FragColor=_;}",""].join("\\n")],groundoverlay:[["precision highp float;attribute vec3 a_pos;attribute vec4 a_texture_coord;varying vec4 _;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;void main(){gl_Position=u_proj_matrix*u_mv_matrix*vec4(a_pos.xy,0.,1.);_=a_texture_coord;}",""].join("\\n"),["precision highp float;varying vec4 _;uniform sampler2D u_Sampler;uniform float u_opacity;void main(){vec4 _=texture2D(u_Sampler,vec2(_.s,_.t));_.a*=u_opacity;gl_FragColor=_;}",""].join("\\n")]};function ad(i,e){this.gl=i;this.map=e;this.cache={};this.bind()}ad.prototype.bind=function(){var e=this;this.map.on("update",function(T){var hQ=T.changedStatus;if(hQ.onsize_changed){for(var i in e.cache){e.cache[i].lastState.projMatrix=false}}})};ad.prototype._createProgram=function(e){var hX=this.gl;var hW=hX.createProgram();var hS=bW[e];var hT=hX.createShader(hX.FRAGMENT_SHADER);hX.shaderSource(hT,hS[1]);hX.compileShader(hT);hX.attachShader(hW,hT);var h1=hX.createShader(hX.VERTEX_SHADER);hX.shaderSource(h1,hS[0]);hX.compileShader(h1);hX.attachShader(hW,h1);hX.linkProgram(hW);var hU={};var hZ=hX.getProgramParameter(hW,hX.ACTIVE_ATTRIBUTES);for(var hV=0;hV<hZ;hV++){var hR=hX.getActiveAttrib(hW,hV);hU[hR.name]=hX.getAttribLocation(hW,hR.name)}var h0={};var hQ=hX.getProgramParameter(hW,hX.ACTIVE_UNIFORMS);for(var hY=0;hY<hQ;hY++){var T=hX.getActiveUniform(hW,hY);h0[T.name]=hX.getUniformLocation(hW,T.name)}return{program:hW,attributes:hU,numAttributes:hZ,uniforms:h0,lastState:{}}};ad.prototype._createProgramCached=function(e){if(!this.cache[e]){this.cache[e]=this._createProgram(e)}return this.cache[e]};ad.prototype.useProgram=function(hQ){var T=this.gl;var i=this._createProgramCached(hQ);var e=this.currentProgram;if(e!==i){T.useProgram(i.program);this.currentProgram=i}return i};var ht={};ht.symbol=[{name:"aPosition",components:4,offset:0,type:"Float32"},{name:"aZLevel",components:1,offset:16,type:"Float32"},{name:"aExtend",components:2,offset:20,type:"Float32"},{name:"aLoopOffset",components:2,offset:28,type:"Float32"},{name:"aVertexTextureCoord",components:2,offset:36,type:"Float32"}];ht.symbolline=[{name:"aPosition",components:2,offset:0,type:"Float32"},{name:"aZLevel",components:1,offset:8,type:"Float32"},{name:"aExtend",components:2,offset:12,type:"Float32"},{name:"aRotationCenter",components:2,offset:20,type:"Float32"},{name:"aRotationAngle",components:1,offset:28,type:"Float32"},{name:"aVertexTextureCoord",components:2,offset:32,type:"Float32"}];ht.arrowComponentsCount=10;ht.arrow=[{name:"a_pos",components:3,offset:0,type:"Float32"},{name:"a_diff",components:2,offset:12,type:"Float32"},{name:"a_normal",components:2,offset:20,type:"Float32"},{name:"a_tex",components:2,offset:28,type:"Float32"},{name:"a_layer_index",components:1,offset:36,type:"Float32"}];ht.fillComponentsCount=8;ht.fill=[{name:"a_pos",components:3,offset:0,type:"Float32"},{name:"a_color",components:4,offset:12,type:"Uint8"},{name:"a_layer_index",components:1,offset:16,type:"Float32"}];ht.overlayLineComponentsCount=12;ht.overlayLine=[{name:"a_pos",components:2,offset:0,type:"Float32"},{name:"a_normal",components:2,offset:8,type:"Float32"},{name:"a_color",components:4,offset:16,type:"Uint8",normalize:true},{name:"a_data",components:4,offset:20,type:"Float32"}];ht.lineComponentsCount=12;ht.line=[{name:"a_pos",components:2,offset:0,type:"Int16"},{name:"a_normal",components:2,offset:4,type:"Int16"},{name:"a_color",components:4,offset:8,type:"Uint8",normalize:true},{name:"a_data",components:4,offset:12,type:"Int16"}];var s=[0,0,0,256,512,512,512,512,512,512,256,512,512,512,512,512,1024,1024,1024,1024,1024,1024];var hK={grid:cC,line:bu,fill:cx,block:hz,shadow:aa,debug:bK,arrow:fu,symbol:ca,symbolline:gb,raster:g9,overlayBlock:dl,marker3d:fw,groundoverlay:d7};var I={3:{start:3},4:{start:4},5:{start:4},6:{start:6},7:{start:6},8:{start:8},9:{start:8},10:{start:10},11:{start:11},12:{start:11},13:{start:11},14:{start:14},15:{start:14},16:{start:16},17:{start:16},18:{start:18},19:{start:18},20:{start:18},21:{start:18},22:{start:18},23:{start:18},24:{start:18},25:{start:18}};var r=[245,245,245,255];var ct=127;var cG=128;var u=11;var dD=u*6;var ez=15;var ae=6;var f5=10;var gT=f5*6;var hv=50;var fI=41;var hj=0;var bj=1;var a2=2;function hd(i){i.preventDefault();setTimeout(function(){window.location.reload()},200)}function cj(hQ,i){var T=this;this._map=hQ;this._textRenderType=hQ.config.textRenderType;this._gridBufferCache={};this._debugBufferCache={};this._shadowPosVec3=vec3.fromValues(2,1,1);this._sideLightDirVec3=vec3.fromValues(0,1,2);this._camera=i;this._canvas=this._initCanvas();this._useSMAA=!f4()&&!C.Browser.ie&&hQ.config.smaa!==false;this._currentTextureIsFull=false;var hR=this.gl=this._getWebGLContext();this._float32ArrayForPolyline=new Float32Array(65535);this._uint16ArrayForPolyline=new Uint16Array(65535);this._textureCache=new eZ((f4()||C.Browser.ie)?64:128,{clearCallback:function(hS){if(hS){hR.deleteTexture(hS)}}});this._labelTextureAtlasOffset={};var e=a8.params.maxTextureSize;if(a6()>1&&this._textRenderType==="image"){this._labelTextTextureSize=[4096,Math.min(4096+1024,e)]}else{this._labelTextTextureSize=[4096,4096]}if(this._textRenderType==="canvas"){this._renderPng8Text=false}else{this._renderPng8Text=true}this._lineLabelBuffer=null;this._fixedLabelBuffer=null;this._iconLabelBuffer=null;this._highlightLabelBuffer=null;this._marker3dVertexBuffer=null;this._markerVertexBuffer=null;this._polylineBufferArray=[{vertex:null,element1:null,vao1:null}];this._polygonBuffer=new Array(20);this._groundBuffer=new Array(20);this._groundoverlayBuffer=new Array(20);this._textTextureManager=new cb.TextTextureManager(hR,{width:this._labelTextTextureSize[0],height:this._labelTextTextureSize[1],unpackAlpha:true});this._iconTextureManager=new cb.TextTextureManager(hR,{width:1024,height:1024,unpackAlpha:true});this._iconTextureAtlas=this._iconTextureManager.getEmptyTexture();this._iconTextureAtlasOffset={};this._iconTextureAtlasCoords={};this._textureAddToJob={};this._isIdle=false;this._identityMatrix=mat4.create();this._initialize();this._handleContextStatus();this.draw()}C.extend(cj.prototype,{draw:function(hQ){var h8=this.gl;var ih=this;var ie=ih._map;var h6=this.mapZoom=ie.getZoom();if(!this.stepZoom){this.stepZoom=h6}this.createGridBuffer(Math.floor(h6));this._isIdle=hQ?hQ.idle:false;if(this._isIdle&&this._useSMAA){b4.loadTexture(this,h8);if(this._frameBufferSizeInvalid===true){this.clearPreviousSMAAFramebuffer();this.initSMAAFrameBuffers();this._frameBufferSizeInvalid=false}}else{this._frameBufferSizeInvalid=true}this.projMatrix=this._camera.getProjectionMatrix3D();this.projMatrix2D=this._camera.getProjectionMatrix();this.cameraPosition=this._camera.getPosition();var ii=ie._featureMgr.getResult();var hR=ii.bkData;var hT=ii.eleData;var hU=ie.getSize();var h5=hU.width;var h3=hU.height;this.mapHalfSize=[h5/2,h3/2];this.polyZoomRatio=Math.pow(2,18-h6);this.gridTextureScale=di.mapZoomTileSize[Math.floor(h6)]/128;var ic=ie._displayOptions;this.isFlat=ic.isFlat;if(this._isIdle&&this._smaaInfo.glDrawSMAAReady===true){h8.bindFramebuffer(h8.FRAMEBUFFER,this._smaaPasses[0].framebuffer)}this.tileClippintRefer=0;this.showIndoorContour=false;this.currentIndoorUid=null;if(ie._indoorMgr){this.currentIndoorUid=ie._indoorMgr.currentUid}if(this.currentIndoorUid&&h6>=17){this.showIndoorContour=true}ih.clearGLStatus({stencil:true,color:true,depth:true});this._state.enableCap("depthTest");this._state.blendFunc(h8.SRC_ALPHA,h8.ONE_MINUS_SRC_ALPHA,h8.ONE,h8.ONE_MINUS_SRC_ALPHA);this.calShadowPos();ih.clearGLStatus({depth:true});var hW=0;for(var hX=0;hX<hR.length;hX++){if(!hR[hX]){continue}var ig=hR[hX];if(hX>0&&ic.layer===false){continue}if(ig.dataType===2){var id=[0,0,0];for(var h9=0;h9<ig.length;h9++){var h4=undefined;for(var h7=0;h7<ig[h9].length;h7++){var T=ig[h9][h7];var e=T.tileInfo.useZoom;if(e!==h4){id[h9]++;h4=e}}}for(var h9=0;h9<ig.length;h9++){var ib=1;if(h9===1){ib+=id[0]+id[2]}else{if(h9===2){ib+=id[0]}}var h2=ib+hW;h2=this.drawBase(ig[h9],h2,h6,hX,h9===2);var hS=false;for(var h7=0;h7<ig[h9].length;h7++){var T=ig[h9][h7];if(T.dataType===2||!T.dataType){if(T.renderData&&T.renderData.base3d){hS=true;this.drawTileBase3D(T,h6,h2,bj)}}}if(ic.indoor){for(var h7=0;h7<ig[h9].length;h7++){var T=ig[h9][h7];if(T.dataType===2||!T.dataType){if(T.renderData&&T.renderData.indoorBase){this.drawIndoorBase(T,h6)}}}}if(hS&&!this.isFlat){this.gl.stencilFunc(this.gl.ALWAYS,1<<7,cG);for(var h7=0;h7<ig[h9].length;h7++){var T=ig[h9][h7];if(T.dataType===2||!T.dataType){if(T.renderData&&T.renderData.base3d){this.drawTileBase3D(T,h6,h2,a2)}}}this.gl.stencilFunc(this.gl.ALWAYS,0,255)}for(var h7=0;h7<ig[h9].length;h7++){var T=ig[h9][h7];if(T.dataType===2||!T.dataType){if(T.renderData&&T.renderData.virtual){this.drawTileVirtual(T,h6)}}}}hW+=id[0]+id[1]+id[2]}else{this._state.disableCap("depthTest");if(ig.png8){this._state.blendFunc(h8.ONE,h8.ONE_MINUS_SRC_ALPHA)}else{this._state.blendFunc(h8.SRC_ALPHA,h8.ONE_MINUS_SRC_ALPHA,h8.ZERO,h8.ONE)}for(var h9=0;h9<ig[2].length;h9++){if(!ig[2][h9]){continue}this.drawRasterTile(ig[2][h9],h6)}this._state.enableCap("depthTest");if(ig.png8){this._state.blendFunc(h8.SRC_ALPHA,h8.ONE_MINUS_SRC_ALPHA,h8.ZERO,h8.ONE)}}}if(ic.overlay){if(hT[0].length>0){this._state.disableCap("depthTest");this.mvMatrixPoly=this._camera.getModelViewMatrixPoly();this.drawPolygon(hT[0]);this._state.enableCap("depthTest")}if(hT[1].length>0){this._state.disableCap("depthTest");this.mvMatrixPoly=this._camera.getModelViewMatrixPoly();this.drawPolyline(hT[1]);this._state.enableCap("depthTest")}if(hT[6].length>0){this._state.disableCap("depthTest");this.mvMatrixPoly=this._camera.getModelViewMatrixPoly();this.drawPrism(hT[6]);this._state.enableCap("depthTest")}if(hT[8].length>0){this._state.disableCap("depthTest");this.mvMatrixPoly=this._camera.getModelViewMatrixPoly();this.drawGroundOverlay(hT[8]);this._state.enableCap("depthTest")}}this._map.drawOverlay&&this._map.drawOverlay(h8);this.draw3D(hR);if(ie.getTilt()>10){var ia=ie.pointToPixelIn(ie.getBoundsIn().pointTopLeft).y+100;if(ia>0&&ie.config.showSky!==false){L(this,this._identityMatrix,ia,ie.height,this._skyColor)}}ie.insertRender&&ie.insertRender();if(this._useSMAA&&this._isIdle&&this._smaaInfo.glDrawSMAAReady===true){this.drawSMAA()}this._state.disableCap("depthTest");this.mvMatrixMarker=this._camera.getMCPlaneMVMatrix();this.mvMatrixMarker[12]=this.mvMatrixMarker[13]=this.mvMatrixMarker[14]=0;this._checkTextureAtlasUsage();var h0=aF(this.cameraPosition[0]);var hZ=aF(this.cameraPosition[1]);var hY=aF(this.cameraPosition[2]);this.cameraPosHigh=[h0[0],hZ[0],hY[0]];this.cameraPosLow=[h0[1],hZ[1],hY[1]];if(ic.poi){this._state.blendFunc(h8.ONE,h8.ONE_MINUS_SRC_ALPHA);if(ic.poiText&&hT[2].length>0){for(var h9=0;h9<hT[2].length;h9++){var h1=hT[2][h9];if(h1.lineLabels.length===0){continue}this.drawLineLabelSymbol(h1.lineLabels,this._camera.getModelViewMatrixForLineLabel(h1.tileInfo))}}if(hT[3].length>0){this.drawFixedLabelSymbol(hT[3])}if(ic.poiText&&hT[4].length>0){this.drawHighlightFixedLabelSymbol(hT[4])}}if(ic.overlay){this._state.blendFunc(h8.ONE,h8.ONE_MINUS_SRC_ALPHA);var hV=false;if(h6<12){hV=true}if(hT[5].length>0){this.drawSymbol(hT[5],{fixPosition:hV})}if(hT[7].length>0){this.drawMarker3D(hT[7])}}this._map.dispatchEvent(new bb("ondraw"))},calShadowPos:function(){this.isDrawShadow=false;var i=this._map;var e=!(typeof i.config.style==="string");if(e||this.mapZoom<18){return}var T=i.getSolarInfo();if(de(T.solarAltitude)>1){this.isDrawShadow=true;this._shadowPosVec3[0]=Math.sin(T.solarAzimuth);this._shadowPosVec3[1]=Math.cos(T.solarAzimuth);if(T.centerPosition==="south"){this._shadowPosVec3[1]=-this._shadowPosVec3[1]}this._shadowPosVec3[2]=Math.tan(T.solarAltitude)*0.5+1.5;this._sideLightDirVec3[0]=this._shadowPosVec3[0];this._sideLightDirVec3[1]=this._shadowPosVec3[1];this._sideLightDirVec3[2]=-this._shadowPosVec3[2]}},clearPreviousSMAAFramebuffer:function(){var hQ=this.gl;for(var e=0;e<this._smaaPasses.length;e++){hQ.deleteFramebuffer(this._smaaPasses[e].framebuffer);hQ.deleteTexture(this._smaaPasses[e].texture);hQ.deleteRenderbuffer(this._smaaPasses[e].renderbuffer)}this._smaaPasses=[];if(this._smaaBuffer){var T=this._smaaBuffer;T.vao1&&T.vao1.destroy(hQ);T.vao2&&T.vao2.destroy(hQ);T.vao3&&T.vao3.destroy(hQ);T.vertex&&T.vertex.destroy(hQ);this._smaaBuffer=null}},initSMAAFrameBuffers:function(){this._smaaPasses=[];for(var e=0;e<3;e++){var T=this.createFramebuffer();this._smaaPasses.push({framebuffer:T[0],texture:T[1],renderbuffer:T[2]})}},createFramebuffer:function(){var hQ=this.gl;var T=hQ.createFramebuffer();hQ.bindFramebuffer(hQ.FRAMEBUFFER,T);T.width=hQ.drawingBufferWidth;T.height=hQ.drawingBufferHeight;var i=hQ.createTexture();hQ.bindTexture(hQ.TEXTURE_2D,i);hQ.texParameteri(hQ.TEXTURE_2D,hQ.TEXTURE_MAG_FILTER,hQ.LINEAR);hQ.texParameteri(hQ.TEXTURE_2D,hQ.TEXTURE_MIN_FILTER,hQ.LINEAR);hQ.texParameteri(hQ.TEXTURE_2D,hQ.TEXTURE_WRAP_S,hQ.CLAMP_TO_EDGE);hQ.texParameteri(hQ.TEXTURE_2D,hQ.TEXTURE_WRAP_T,hQ.CLAMP_TO_EDGE);hQ.texImage2D(hQ.TEXTURE_2D,0,hQ.RGBA,T.width,T.height,0,hQ.RGBA,hQ.UNSIGNED_BYTE,null);hQ.framebufferTexture2D(hQ.FRAMEBUFFER,hQ.COLOR_ATTACHMENT0,hQ.TEXTURE_2D,i,0);var e=hQ.createRenderbuffer();hQ.bindRenderbuffer(hQ.RENDERBUFFER,e);hQ.renderbufferStorage(hQ.RENDERBUFFER,hQ.DEPTH_STENCIL,T.width,T.height);hQ.framebufferRenderbuffer(hQ.FRAMEBUFFER,hQ.DEPTH_STENCIL_ATTACHMENT,hQ.RENDERBUFFER,e);hQ.bindTexture(hQ.TEXTURE_2D,null);hQ.bindRenderbuffer(hQ.RENDERBUFFER,null);hQ.bindFramebuffer(hQ.FRAMEBUFFER,null);return[T,i,e]},drawSMAA:function(){if(!this._smaaBuffer){var i=this._width;var T=this._height;var e=new Float32Array([0,0,-900,0,0,i,0,-900,1,0,i,T,-900,1,1,0,0,-900,0,0,i,T,-900,1,1,0,T,-900,0,1]);this._smaaBuffer={vertex:new fi(e,{components:5,members:[{name:"position",components:3,offset:0,type:"Float32"},{name:"uv",components:2,offset:12,type:"Float32"}]},fi.BufferType.VERTEX),vao1:new hq(),vao2:new hq(),vao3:new hq()}}b4.draw(this,this._smaaBuffer,this._identityMatrix,this._smaaPasses,this._width,this._height)},createBlockData:function(i){var e=new fi(i.vertex,{components:7,members:[{name:"a_pos",components:3,offset:0,type:"Float32"},{name:"a_normal",components:3,offset:12,type:"Float32"},{name:"a_color",components:4,offset:24,type:"Uint8",normalize:true}]},fi.BufferType.VERTEX);return{vao1:new hq(),vertex:e,element1:new fi(i.index,{components:1},fi.BufferType.ELEMENT)}},createOverlayBlockData:function(T,i){var e=new fi(T.vertex,{components:7,members:[{name:"a_pos",components:3,offset:0,type:"Float32"},{name:"a_normal",components:3,offset:12,type:"Float32"},{name:"a_color",components:4,offset:24,type:"Uint8",normalize:true}]},fi.BufferType.VERTEX);return{vao1:new hq(),vertex:e,element1:new fi(T.index,{components:1},fi.BufferType.ELEMENT)}},createArrowData:function(e){return{vao1:new hq(),element1:new fi(e[1],{components:1},fi.BufferType.ELEMENT),vertex:new fi(e[0],{components:ht.arrowComponentsCount,members:ht.arrow},fi.BufferType.VERTEX)}},createGroundOverlayData:function(hQ,e){if(!hQ){return null}var hS=[0,0,1,0,1,1,0,1];var hR=hQ.vertex;var hU=[];for(var T=0;T<hR.length;T+=2){hU.push(hR[T]);hU.push(hR[T+1]);hU.push(hS[T]);hU.push(hS[T+1])}hQ.finnalVertex=new Float32Array(hU);var hT=this._groundoverlayBuffer;this._groundoverlayBuffer=hT.vertex=new fi(hQ.finnalVertex,{components:4,members:[{name:"a_pos",components:2,offset:0,type:"Float32"},{name:"a_texture_coord",components:2,offset:8,type:"Float32"}]},fi.BufferType.VERTEX);hT.vao1=new hq();hT.textureType=hQ.textureSource;hT.element1=new fi(hQ.index,{components:1},fi.BufferType.ELEMENT);return hT},createOverlayFillData:function(T,e,i){var hQ=this._polygonBuffer[i];if(!hQ){hQ={};hQ.vertex=new fi(T[1],{components:2,members:[{name:"a_pos",components:2,offset:0,type:e}]},fi.BufferType.VERTEX);hQ.vao1=new hq();hQ.element1=new fi(T[2],{components:1},fi.BufferType.ELEMENT)}else{hQ.vao1.update(this.gl,hQ.vertex,T[1],T[1].length,hQ.element1,T[2],T[2].length)}return hQ},createFillData:function(hR){if(!hR[0]){return null}var T=new fi(hR[0],{components:ht.fillComponentsCount,members:ht.fill},fi.BufferType.VERTEX);var e={vao1:new hq(),vertex:T,element1:new fi(hR[1],{components:1},fi.BufferType.ELEMENT)};if(hR[2]){e.border=[];for(var hQ=0;hQ<hR[2].length;hQ++){e.border.push({element1:new fi(hR[2][hQ].styleData[1],{components:1},fi.BufferType.ELEMENT),vao1:new hq(),vertex:this.createLineBuffer(null,hR[2][hQ].styleData[0],false)})}}return e},createLineBuffer:function(e,T,i){if(T){if(e){if(e.length>T.length){T=new Float32Array(e.length)}T.set(e)}}if(i){return new fi(T,{components:ht.overlayLineComponentsCount,members:ht.overlayLine},fi.BufferType.VERTEX)}else{return new fi(T,{components:ht.lineComponentsCount,members:ht.line},fi.BufferType.VERTEX)}},createLineData:function(i){var e={};e.vertex=this.createLineBuffer(null,i[0],false);e.element1=new fi(i[1],{components:1},fi.BufferType.ELEMENT);e.vao1=new hq();return e},createPolylineData:function(hQ){var hU=[];for(var T=0;T<hQ.length;T++){var hR=hQ[T].styleData[0];var e=hQ[T].styleData[1];if(hR.length===0){continue}var hT={};if(!this._polylineBufferArray[T]){this._polylineBufferArray[T]={vertex:null,element1:null,vao1:null}}var hS=this._polylineBufferArray[T];if(!hS.vertex){hS.vertex=this.createLineBuffer(hR,this._float32ArrayForPolyline,true)}if(e.length>this._uint16ArrayForPolyline.length){this._uint16ArrayForPolyline=new Uint16Array(e.length)}this._uint16ArrayForPolyline.set(e);if(!hS.element1){hS.element1=new fi(this._uint16ArrayForPolyline,{components:1},fi.BufferType.ELEMENT,e.length)}if(!hS.vao1){hS.vao1=new hq()}else{if(hR.length>this._float32ArrayForPolyline.length){this._float32ArrayForPolyline=new Float32Array(hR)}else{this._float32ArrayForPolyline.set(hR)}hS.vao1.update(this.gl,hS.vertex,this._float32ArrayForPolyline,hR.length,hS.element1,this._uint16ArrayForPolyline,e.length)}hU.push(hS)}if(hU.length===0){return null}return hU},createLabelData:function(hT,h7,h6,hS){if(hT.length===0){return}var ii=this._labelTextTextureSize;var h0=0;var hQ=0;var ic=hT.length;var ia=this.gl;var ig=this[h6];var h1=0;var ij=dD;var id=u;if(hS){ij=gT;id=f5}for(var ib=0;ib<ic;ib++){var h2=hT[ib];if(!h2||!h2.renderData){continue}var hR=h2.textureSource;if(!hR){continue}var T=h2.renderData.vertex;h1+=T.length/ij}var hZ=h1*ij;if(hZ>this._labelVertexBuffer.length){this._labelVertexBuffer=new Float32Array(hZ);if(ig){ig.vao.destroy(ia);ig.destroy(ia);ig=this[h6]=null}}var hW=this._iconLabelBuffer;if(hZ>this._labelIconVertexBuffer.length){this._labelIconVertexBuffer=new Float32Array(hZ);if(hW){hW.vao.destroy(ia);hW.destroy(ia);hW=this._iconLabelBuffer=null}}for(var ib=0;ib<ic;ib++){var h2=hT[ib];if(!h2){continue}if(!h2.renderData&&h2.iconRenderData){if(hQ+ij<this._labelIconVertexBuffer.length){this._labelIconVertexBuffer.set(h2.iconRenderData.vertex,hQ);hQ+=ij}continue}var T=h2.renderData.vertex;var h3=h2.renderData.textureCoord;var hR=h2.textureSource;if(!hR){continue}var e=hR.width;var h5=h2.textureHeight||hR.height;var hY=this._labelTextureAtlasOffset[hR.id];if(!hY&&!this._textureAddToJob[hR.id]&&this._currentTextureIsFull===false){if(!this._labelTextTextureAtlas){this._labelTextTextureAtlas=this._textTextureManager.getEmptyTexture()}hY=this._labelTextTextureAtlas.addTexture(hR,h5);this._labelTextureAtlasOffset[hR.id]=hY}if(hY){var h4=id/2;var hV=9;if(hS){hV=8}for(var h9=0,h8=T.length;h9<h8;h9+=id){T[h9+hV]=h3[h9/h4]*e/ii[0]+hY.width;T[h9+hV+1]=h3[h9/h4+1]*h5/ii[1]+hY.height}this._labelVertexBuffer.set(T,h0);h0+=T.length;if(h2.iconRenderData){if(hQ+ij<this._labelIconVertexBuffer.length){this._labelIconVertexBuffer.set(h2.iconRenderData.vertex,hQ);hQ+=ij}}}}if(h0===0&&hQ===0){return}var ie=null;if(h0>0){if(!ig){var hU=ht.symbol;if(hS){hU=ht.symbolline}ig=this[h6]=new fi(this._labelVertexBuffer,{components:id,members:hU},fi.BufferType.VERTEX,h0/id);this[h6].vao=new hq()}else{this[h6].vao.update(this.gl,ig,this._labelVertexBuffer,h0/id)}}var hX=null;if(hQ>0){hX=new hq();if(!hW){hW=this._iconLabelBuffer=new fi(this._labelIconVertexBuffer,{components:u,members:ht.symbol},fi.BufferType.VERTEX,hQ/u);hW.vao=new hq()}else{hW.vao.update(this.gl,hW,this._labelIconVertexBuffer,hQ/u)}}var ih=null;if(this._labelTextTextureAtlas){ih=this._labelTextTextureAtlas.getTexture()}return{vao:this[h6]?this[h6].vao:null,vaoIcon:this._iconLabelBuffer?this._iconLabelBuffer.vao:null,vertex:h0>0?ig:null,texture:ih,iconVertex:hQ>0?hW:null,iconTexture:this._iconTextureAtlas.getTexture()}},_addToAsyncJob:function(e){if(this._textureAddToJob[e.id]){return}var T=this;var i=(function(hQ){return function(){delete T._textureAddToJob[hQ.id];if(T._currentTextureIsFull){return}if(!T._labelTextTextureAtlas){T._labelTextTextureAtlas=T._textTextureManager.getEmptyTexture()}var hR=hQ.height;var hS=T._labelTextTextureAtlas.addTexture(hQ,hR);T._labelTextureAtlasOffset[hQ.id]=hS;T._map.dispatchEvent(new bb("onrefresh"))}})(e);this._textureJobScheduler.addJob(i);this._textureAddToJob[e.id]=true},createMarker3dData:function(e){if(e.length===0){return null}var hR=e.length*ez;if(hR>this._labelVertexBuffer3D.length){this._labelVertexBuffer3D=new Float32Array(hR);if(this._marker3dVertexBuffer){this._marker3dVertexBuffer.vao.destroy(this.gl);this._marker3dVertexBuffer.destroy(this.gl);this._marker3dVertexBuffer=null}}var h5=0;for(var h1=0,hX=e.length;h1<hX;h1++){var hW=e[h1].renderData;var hQ=e[h1].textureSource;var hT=[0,0,0,0];var hV=e[h1].overlay;if(hW.finalVertexData){this._labelVertexBuffer3D.set(hW.finalVertexData,h5);h5+=ez;continue}hW.finalVertexData=[];var hS=hW.vertex;if(!hS){continue}if(hQ){var h3=hV._config.icon;var h2=h3.imageUrl;if(h3.ratio>1&&h3.srcSetObject["2x"]){h2=h3.srcSetObject["2x"]}if(!h2&&h3.imageDom){h2=h3.imageDom.id}var T=hV.textureCoordGLMap;if(!T){var hY=this._imageMergedOffset[h2];if(!hY){hQ.id=h2;hY=this.textureAtlasMarker.addTexture(hQ);this._imageMergedOffset[h2]=hY}var hU=new d9(hQ.width,hQ.height);if(h3.imageSize){h3.ratio=hQ.width/h3.imageSize.width}T=this._calcTextureCoords(hU,h3.size,h3.imageOffset,hY,h3.ratio);hV.textureCoordGLMap=T}hT=[T[0],T[1],T[4],T[5]]}for(var h0=0;h0<hS.length;h0++){for(var hZ=0;hZ<ez-4;hZ++){hW.finalVertexData.push(hS[h0][hZ])}hW.finalVertexData.push(hT[0],hT[1],hT[2],hT[3])}this._labelVertexBuffer3D.set(hW.finalVertexData,h5);h5+=ez}var h4=this._marker3dVertexBuffer;if(!h4){this._marker3dVertexBuffer=h4=new fi(this._labelVertexBuffer3D,{components:15,members:[{name:"a_pos",components:4,offset:0,type:"Float32"},{name:"a_height",components:1,offset:16,type:"Float32"},{name:"a_color",components:4,offset:20,type:"Float32"},{name:"a_size",components:1,offset:36,type:"Float32"},{name:"a_shape",components:1,offset:40,type:"Float32"},{name:"a_texture_coord",components:4,offset:44,type:"Float32"}]},fi.BufferType.VERTEX,h5/ez);this._marker3dVertexBuffer.vao=new hq()}else{this._marker3dVertexBuffer.vao.update(this.gl,h4,this._labelVertexBuffer3D,h5/ez)}return{vao:this._marker3dVertexBuffer.vao,vertex:h4,texture:hQ?this.textureAtlasMarker.getTexture():null}},createMarkerData:function(e){if(e.length===0){return null}var hX=e.length*dD;if(hX>this._labelVertexBuffer.length){this._labelVertexBuffer=new Float32Array(hX);if(this._markerVertexBuffer){this._markerVertexBuffer.vao.destroy(this.gl);this._markerVertexBuffer.destroy(this.gl);this._markerVertexBuffer=null}}var hZ=0;for(var hT=0,hQ=e.length;hT<hQ;hT++){var hU=e[hT].overlay;if(hU._visible===false){continue}var h2=e[hT].renderData;if(h2.finalVertexData){this._labelVertexBuffer.set(h2.finalVertexData,hZ);hZ+=dD;continue}h2.finalVertexData=[];var h1=h2.vertex;if(!h1){continue}var h0=hU._config.icon;var T=e[hT].textureSource;var hS=h0.imageUrl;if(h0.ratio>1&&h0.srcSetObject["2x"]){hS=h0.srcSetObject["2x"]}if(!hS&&h0.imageDom){hS=h0.imageDom.id}var h3=hU.textureCoordGLMap;if(!h3){var hV=this._imageMergedOffset[hS];if(!hV){T.id=hS;hV=this.textureAtlasMarker.addTexture(T);this._imageMergedOffset[hS]=hV}var hY=new d9(T.width,T.height);if(h0.imageSize){h0.ratio=T.width/h0.imageSize.width}h3=this._calcTextureCoords(hY,h0.size,h0.imageOffset,hV,h0.ratio);hU.textureCoordGLMap=h3}for(var hR=0;hR<h1.length;hR++){h2.finalVertexData.push(h1[hR][0],h1[hR][1],h1[hR][2],h1[hR][3],0,h1[hR][4],h1[hR][5],0,0,h3[hR*2],h3[hR*2+1])}this._labelVertexBuffer.set(h2.finalVertexData,hZ);hZ+=dD}var hW=this._markerVertexBuffer;if(!hW){this._markerVertexBuffer=hW=new fi(this._labelVertexBuffer,{components:u,members:ht.symbol},fi.BufferType.VERTEX,hZ/u);this._markerVertexBuffer.vao=new hq()}else{this._markerVertexBuffer.vao.update(this.gl,hW,this._labelVertexBuffer,hZ/u)}return{vao:this._markerVertexBuffer.vao,vertex:hW,texture:this.textureAtlasMarker.getTexture()}},_calcTextureCoords:function(hU,hX,h2,hW,i){if(!hU||!hX||!h2||!hW){}i=i||1;var T=this.textureAtlasMarker.getSize();var hV=-h2.width*i;var e=-h2.height*i;var h1=-hV/T.width+hW.width;var hT=(hU.height+e-hX.height*i)/T.height+hW.height;var h0=(-hV+hX.width*i)/T.width+hW.width;var hS=hT;var hZ=h0;var hR=(hU.height+e)/T.height+hW.height;var hY=h1;var hQ=hR;return[h1,hT,h0,hS,hZ,hR,h1,hT,hZ,hR,hY,hQ]},createData:function(hS){var hU={};var hT=hS.renderData;var e=hS.tileInfo;if(hT.base){hU.base=[];for(var T=0;T<hT.base.length;T++){var hR=hT.base[T];var hQ=hR.type;if(hQ==="fill"){hU.base.push(this.createFillData(hR.data,e));bJ.addDrawIntoAreaSpots(e,hR)}else{if(hQ==="line"){hU.base.push(this.createLineData(hR.data))}}}}if(hT.base3d){hU.base3d=[];for(var T=0;T<hT.base3d.length;T++){var hR=hT.base3d[T];var hQ=hR.type;if(hQ==="fill"){bJ.addDrawIntoAreaSpots(e,hR);hU.base3d.push(this.createFillData(hR.data))}else{if(hQ==="line"){hU.base3d.push(this.createLineData(hR.data))}else{if(hQ==="arrow"){hU.base3d.push(this.createArrowData(hR.data))}else{if(hQ==="block"){hU.base3d.push(this.createBlockData(hR.data))}}}}}}if(hT.virtual){hU.virtual=[];for(var T=0;T<hT.virtual.length;T++){var hR=hT.virtual[T];var hQ=hR.type;if(hQ==="fill"){hU.virtual.push(this.createFillData(hR.data))}else{if(hQ==="line"){hU.virtual.push(this.createLineData(hR.data))}}}}if(hT.building3d){bJ.addDrawIntoAreaSpots(e,hT.building3d);hU.building3d=this.createBlockData(hT.building3d)}if(hT.building3dMesh){hU.building3dMesh=this.createBlockData(hT.building3dMesh)}if(hT.indoorBase){hU.indoorBase=[];for(var T=0;T<hT.indoorBase.length;T++){var hR=hT.indoorBase[T];var hQ=hR.type;if(hQ==="fill"){hU.indoorBase.push(this.createFillData(hR.data))}else{if(hQ==="line"){hU.indoorBase.push(this.createLineData(hR.data))}}}}if(hT.indoorBaseContour){hU.indoorBaseContour=[];for(var T=0;T<hT.indoorBaseContour.length;T++){var hR=hT.indoorBaseContour[T];hU.indoorBaseContour.push(this.createLineData(hR.data))}}if(hT.indoorArea3D){hU.indoorArea3D=[];for(var T=0;T<hT.indoorArea3D.length;T++){hU.indoorArea3D.push(this.createBlockData(hT.indoorArea3D[T]))}}if(hT.indoorBorder3D){hU.indoorBorder3D=[];for(var T=0;T<hT.indoorBorder3D.length;T++){hU.indoorBorder3D.push(this.createLineData(hT.indoorBorder3D[T].data))}}return hU},destroyData:function(e){if(!e){return}var i=this.gl;e.vao1&&e.vao1.destroy(i);e.vertex&&e.vertex.destroy(i);e.element1&&e.element1.destroy(i)},destroyCache:function(hR){if(!hR){return}for(var T in hR){if(T!=="_key_"&&hR.hasOwnProperty(T)){if(T==="building3d"){this.destroyData(hR[T])}else{var hQ=hR[T].length;for(var e=0;e<hQ;e++){this.destroyData(hR[T][e])}}}}},createDataFromCache:function(i){var e=this.calcBufferKey(i);if(!this._cache.getData(e)){this._cache.setData(e,this.createData(i))}return this._cache.getData(e)},calcBufferKey:function(hR){var e=hR.tileInfo;var hQ=hR.mapType+"_"+e.style+"_"+e.col+"_"+e.row+"_"+e.useZoom;if(hR.renderData&&hR.renderData.indoorData){var hS=hR.renderData.indoorData;var i=[];for(var T in hS){i.push(hS[T].currentFloor)}hQ=hQ+"_"+i.join("_")}return hQ},draw3D:function(e){this.setLayerDepth(fI);var i=this._map._displayOptions;if(this._map.getTilt()>0&&i.indoor){this.drawArea3D(e);this.drawArea3DBorder(e)}this.drawBuildings(e)},drawBuildings:function(T){var hT=this._map;if(hT._displayOptions.building===false){return}if(!T[0]){return}var e=false;var hS=T[0].length;for(var hR=0;hR<hS;hR++){for(var hQ=0;hQ<T[0][hR].length;hQ++){if(T[0][hR][hQ]&&T[0][hR][hQ].renderData&&(T[0][hR][hQ].renderData.building3d||T[0][hR][hQ].renderData.building3dMesh)){e=true;break}}}if(!e){return}this._state.colorMask(false,false,false,false);eg(this,this._sideLightDirVec3,true);for(var hR=0;hR<T[0].length;hR++){this.drawBuildingsTile(T[0][hR],"building3d",false);this.drawBuildingsTile(T[0][hR],"building3dMesh",false)}this._state.colorMask(true,true,true,true);this.gl.stencilFunc(this.gl.ALWAYS,1<<7,cG);this._state.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.REPLACE);for(var hR=0;hR<T[0].length;hR++){this.drawBuildingsTile(T[0][hR],"building3d",true)}eg(this,this._sideLightDirVec3,false);for(var hR=0;hR<T[0].length;hR++){this.drawBuildingsTile(T[0][hR],"building3dMesh",true)}if(this.isDrawShadow===true){this.gl.stencilFunc(this.gl.NOTEQUAL,1<<7,cG);this.setLayerDepth(fI);this._state.disableCap("depthTest");cA(this,this._shadowPosVec3);for(var hR=0;hR<T[0].length;hR++){this.drawShadow(T[0][hR])}this._state.enableCap("depthTest")}this._state.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP);this.gl.stencilFunc(this.gl.ALWAYS,0,255)},drawBuildingsTile:function(hT,hQ,T){for(var hS=0;hS<hT.length;hS++){var hR=hT[hS];if(hR.status!=="ready"){continue}var e=this.createDataFromCache(hR);if(e[hQ]){hR.mvMatrix=this._camera.getModelViewMatrix3D(hR.tileInfo);hK.block(this,hR,e[hQ],T)}}},drawArea3D:function(T){var hT=this._map;if(!T[0]){return}var e=false;var hS=T[0].length;for(var hR=0;hR<hS;hR++){for(var hQ=0;hQ<T[0][hR].length;hQ++){if(T[0][hR][hQ]&&T[0][hR][hQ].renderData&&T[0][hR][hQ].renderData.indoorArea3D){e=true;break}}}if(!e){return}eg(this,this._sideLightDirVec3,true);for(var hR=0;hR<T[0].length;hR++){this.drawArea3DTile(T[0][hR],true)}},drawArea3DTile:function(hT,hQ){for(var hS=0;hS<hT.length;hS++){var hR=hT[hS];if(hR.status!=="ready"){continue}var e=this.createDataFromCache(hR);if(!e.indoorArea3D){continue}hR.mvMatrix=this._camera.getModelViewMatrix3D(hR.tileInfo);for(var T=0;T<e.indoorArea3D.length;T++){hK.block(this,hR,e.indoorArea3D[T],hQ)}}},drawArea3DBorder:function(hV,hX){var e=this._map;if(!hV[0]){return}var T=false;var hY=hV[0].length;for(var hT=0;hT<hY;hT++){for(var hS=0;hS<hV[0][hT].length;hS++){if(hV[0][hT][hS]&&hV[0][hT][hS].renderData&&hV[0][hT][hS].renderData.indoorBorder3D){T=true;break}}}if(!T){return}for(var hQ=0;hQ<hV[0].length;hQ++){var hW=hV[0][hQ];for(var hT=0;hT<hW.length;hT++){var hU=hW[hT];if(hU.status!=="ready"){continue}var hR=this.createDataFromCache(hU);if(!hR.indoorBorder3D){continue}hU.mvMatrix=this._camera.getModelViewMatrix3D(hU.tileInfo);this.tileScale=Math.pow(2,hU.tileInfo.zoom-this.mapZoom);for(var hS=0;hS<hU.renderData.indoorBorder3D.length;hS++){if(hR.indoorBorder3D[hS]&&hR.indoorBorder3D[hS]){this.drawTileLayer(hU,hU.renderData.indoorBorder3D[hS],hR.indoorBorder3D[hS],"line",{force3D:true})}}}}},drawShadow:function(hR){for(var hQ=0;hQ<hR.length;hQ++){var T=hR[hQ];if(T.status!=="ready"){continue}var e=this.createDataFromCache(T);var hS=T.renderData;if(hS&&(hS.base3d||hS.building3d||hS.building3dMesh)){T.mvMatrix=this._camera.getModelViewMatrix3D(T.tileInfo);if(hS.building3d){hK.shadow(this,T,e.building3d)}if(hS.building3dMesh){hK.shadow(this,T,e.building3dMesh)}if(!this.isFlat&&hS.base3d){hK.shadow(this,T,e.base3d,hS.base3d)}}}},drawHighlightFixedLabelSymbol:function(i){var e=this.createLabelData(i,true,"_highlightLabelBuffer");if(e&&e.vertex&&e.texture){hK.symbol(this,e.vertex,e.vao,this.mvMatrixMarker,e.texture,this._renderPng8Text,this.projMatrix,true,this._map._labelProcessor._useRound,this.mapHalfSize,0,this.cameraPosHigh,this.cameraPosLow,this.projMatrix2D,1)}},drawFixedLabelSymbol:function(T){var i=this.createLabelData(T,true,"_fixedLabelBuffer");var e=this._map._displayOptions;if(e.poiText&&i&&i.vertex&&i.texture&&i.vao){hK.symbol(this,i.vertex,i.vao,this.mvMatrixMarker,i.texture,this._renderPng8Text,this.projMatrix,false,this._map._labelProcessor._useRound,this.mapHalfSize,0,this.cameraPosHigh,this.cameraPosLow,this.projMatrix2D,1)}if(e.poiIcon&&i&&i.iconVertex&&i.iconTexture&&i.vaoIcon){hK.symbol(this,i.iconVertex,i.vaoIcon,this.mvMatrixMarker,i.iconTexture,false,this.projMatrix,false,this._map._labelProcessor._useRound,this.mapHalfSize,0,this.cameraPosHigh,this.cameraPosLow,this.projMatrix2D,2)}},drawLineLabelSymbol:function(hQ,T){var e=false;var i=this.createLabelData(hQ,e,"_lineLabelBuffer",true);if(i&&i.vertex&&i.texture&&i.vao){hK.symbolline(this,i.vertex,i.vao,T,i.texture,this._renderPng8Text,this.projMatrix,this._map._labelProcessor._useRound,this.mapHalfSize,this.mapZoom,this.cameraPosition,1)}},drawSymbol:function(hQ,T){var i=this.createMarkerData(hQ);if(!i){return}T=T||{};var e=T.fixPosition||false;hK.symbol(this,i.vertex,i.vao,this.mvMatrixMarker,i.texture,false,this.projMatrix,false,this._map._overlayMgrGL._useRound,this.mapHalfSize,0,this.cameraPosHigh,this.cameraPosLow,this.projMatrix2D,null,e)},drawMarker3D:function(T){var e=this.createMarker3dData(T);if(!e){return}var i=T[0].overlay._config;hK.marker3d(this,{mvMatrix:this.mvMatrixMarker},this.cameraPosHigh,this.cameraPosLow,e,i)},drawPolyline:function(i){var e=this.createPolylineData(i);if(!e){return}hK.line(this,{mvMatrix:this.mvMatrixPoly},i,e,true)},drawPolygon:function(T){var e;for(var hQ=0;hQ<T.length;hQ++){e=this.createOverlayFillData(T[hQ],"Float32",hQ);if(T[hQ].hasMultipleParts){hK.fill(this,{mvMatrix:this.mvMatrixPoly},T[hQ],e,true,{usePolygonStencil:true,drawPolygonPass:1});hK.fill(this,{mvMatrix:this.mvMatrixPoly},T[hQ],e,true,{usePolygonStencil:true,drawPolygonPass:2})}else{hK.fill(this,{mvMatrix:this.mvMatrixPoly},T[hQ],e,true)}}},drawGroundOverlay:function(hR){var e;for(var T=0;T<hR.length;T++){e=this.createGroundOverlayData(hR[T],T);var hQ=this._textureCache.getData(hR[T].src);if(!hQ){var hS=this.gl;hQ=cb.utils.createTexture(hS,hR[T].textureSource);if(e.textureType.localName!=="video"){this._textureCache.setData(hR[T].src,hQ)}}hK.groundoverlay(this,{mvMatrix:this.mvMatrixPoly},hR[T],e,hQ)}},drawPrism:function(e){var T;for(var hQ=0;hQ<e.length;hQ++){T=this.createOverlayBlockData(e[hQ],hQ);hK.overlayBlock(this,{mvMatrix:this.mvMatrixPoly},T)}},drawBase:function(h0,hR,hT,hW,hU){var hZ=undefined;var T=0;for(var hQ=0;hQ<h0.length;hQ++){var hV=h0[hQ];if(hV.dataType===2||!hV.dataType){var h2=hV.tileInfo.useZoom;if(h2!==hZ){hR++;hZ=h2}hV.baseLayerHeight=hR;if(hU&&hW===0&&hV.status!=="ready"){hV.mvMatrix=this._camera.getModelViewMatrix3D(hV.tileInfo);this.renderGrid(hV)}if(hV.status==="ready"){T=Math.max(T,hV.renderData.base.length)}}}for(var e=0;e<T;e++){for(var hQ=0;hQ<h0.length;hQ++){var hV=h0[hQ];if(hV.dataType===2||!hV.dataType){if(hV.status!=="ready"){continue}if(!hV.renderData.base[e]){continue}hV.mvMatrix=this._camera.getModelViewMatrix3D(hV.tileInfo);var hS=Math.floor(hT);var i=this.createDataFromCache(hV);this.tileScale=Math.pow(2,hV.tileInfo.zoom-hT);this.tileScaleFromStart=Math.pow(2,hV.tileInfo.useZoom-I[hV.tileInfo.zoom].start);this.setLayerDepth(hV.baseLayerHeight);var h1=hV.renderData.base[e];var hX=h1.type;var hY=i.base[e];this.drawTileLayer(hV,h1,hY,hX,{withStencil:hX==="line"&&hV.tileInfo.zoom<10&&hU})}}}return ++hR},drawTileBase3D:function(hS,hW,T,hV){hS.mvMatrix=this._camera.getModelViewMatrix3D(hS.tileInfo);if(hS.status!=="ready"){return}var hR=Math.floor(hW);var e=this.createDataFromCache(hS);this.tileScale=Math.pow(2,hS.tileInfo.zoom-hW);this.tileScaleFromStart=Math.pow(2,hS.tileInfo.useZoom-I[hS.tileInfo.zoom].start);if(!this.isFlat){this.setLayerDepth(fI)}else{this.setLayerDepth(T)}for(var hQ=0;hQ<hS.renderData.base3d.length;hQ++){var hX=hS.renderData.base3d[hQ];var hT=hX.type;var hU=e.base3d[hQ];if(hT!=="block"){if(!this.isFlat){if(hV===a2&&!hX.has3D){continue}else{if(hV===bj&&!hX.has2D){continue}}}if(hT==="fill"&&hV===a2){this._state.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.REPLACE)}this.drawTileLayer(hS,hX,hU,hT,{drawPart:hV});if(hT==="fill"&&hV===a2){this._state.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP)}}else{if(!this.isFlat&&hV===a2){this._state.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.REPLACE);hK.block(this,hS,hU,true);this._state.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.KEEP)}}}},drawIndoorBase:function(hV,hS){if(hV.status!=="ready"){return}hV.mvMatrix=this._camera.getModelViewMatrix3D(hV.tileInfo);var hQ=Math.floor(hS);var T=this.createDataFromCache(hV);this.tileScale=Math.pow(2,hV.tileInfo.zoom-hS);this.tileScaleFromStart=Math.pow(2,hV.tileInfo.useZoom-I[hV.tileInfo.zoom].start);if(hV.renderData.indoorBaseContour&&this.showIndoorContour){for(var hR=0;hR<hV.renderData.indoorBaseContour.length;hR++){var hU=hV.renderData.indoorBaseContour[hR];if(hU.uid!==this.currentIndoorUid){continue}var hT=hU.type;var e=T.indoorBaseContour[hR];this.drawTileLayer(hV,hU,e,hT)}}if(hV.renderData.indoorBase){for(var hR=0;hR<hV.renderData.indoorBase.length;hR++){var hU=hV.renderData.indoorBase[hR];var hT=hU.type;var e=T.indoorBase[hR];this.drawTileLayer(hV,hU,e,hT)}}},drawTileVirtual:function(hV,hS){hV.mvMatrix=this._camera.getModelViewMatrix3D(hV.tileInfo);if(hV.status!=="ready"){return}var hQ=Math.floor(hS);var T=this.createDataFromCache(hV);this.tileScale=Math.pow(2,hV.tileInfo.zoom-hS);this.tileScaleFromStart=Math.pow(2,hV.tileInfo.useZoom-I[hV.tileInfo.zoom].start);this.setLayerDepth(0);this._state.disableCap("depthTest");for(var hR=0;hR<hV.renderData.virtual.length;hR++){var hU=hV.renderData.virtual[hR];var hT=hU.type;var e=T.virtual[hR];this.drawTileLayer(hV,hU,e,hT)}this._state.enableCap("depthTest")},drawRasterTile:function(hQ){var i=new fi(new Float32Array(hQ.renderData.vertexAll),{components:5,members:[{name:"aVertexPosition",components:3,offset:0,type:"Float32"},{name:"aVertexTextureCoord",components:2,offset:12,type:"Float32"}]},fi.BufferType.VERTEX);var e={vao:new hq(),vertex:i};var T=this._textureCache.getData(hQ.textureSource.src);if(!T){var hR=this.gl;T=cb.utils.createTexture(hR,hQ.textureSource);this._textureCache.setData(hQ.textureSource.src,T)}hQ.mvMatrix=this._camera.getModelViewMatrix3D(hQ.tileInfo);hK.raster(this,e.vertex,e.vao,hQ.mvMatrix,T,this.projMatrix)},drawTileLayer:function(hQ,hR,e,T,i){if(i&&i.withStencil){this.renderTileClippingMask(hQ);this.enableTileClippingMask(hQ)}hK[T](this,hQ,hR,e,false,i);if(i&&i.withStencil){this.disableTileClippingMask()}},enableTileClippingMask:function(i,e){var T=this.gl;T.stencilFunc(T.EQUAL,i.clippingTileRefer,ct)},disableTileClippingMask:function(){var e=this.gl;e.stencilFunc(e.ALWAYS,0,255)},renderTileClippingMask:function(e){var i=this.gl;e.clippingTileRefer=++this.tileClippintRefer;this._state.stencilOp(i.KEEP,i.REPLACE,i.REPLACE);i.stencilFunc(i.ALWAYS,e.clippingTileRefer,ct);this._state.colorMask(false,false,false,false);hK.grid(this,e.mvMatrix,this.gridTextureScale);this._state.colorMask(true,true,true,true);this._state.stencilOp(i.KEEP,i.KEEP,i.KEEP)},clearGLStatus:function(e){var T=this.gl;var i=0;if(e.color){i|=T.COLOR_BUFFER_BIT}if(e.stencil){i|=T.STENCIL_BUFFER_BIT}if(e.depth){i|=T.DEPTH_BUFFER_BIT}this.updateBackground();T.clear(i)},renderGrid:function(e){this.setLayerDepth(hj);hK.grid(this,e.mvMatrix,this.gridTextureScale)},setLayerDepth:function(e){if(this._preCurrentLayer===e){return}var i=1-e*this._depthEpsilon;var T=i-this._depthRange;this._preCurrentLayer=e;this.gl.depthRange(T,i)},_initCanvas:function(){var hT=this._map;var hR=hT.getSize();var hQ=hR.width;var e=hR.height;var i=hT.container;var hU=S("canvas");var hS=hU.style;var T=hT.config.ratio;this._width=hQ;this._height=e;hS.cssText="position: absolute;left:0;top:0;width:"+hQ+"px;height:"+e+"px;z-index:0;";hU.width=Math.round(hQ*T);hU.height=Math.round(e*T);i.appendChild(hU);return hU},_getWebGLContext:function(){var i={alpha:true,premultipliedAlpha:false,antialias:!this._useSMAA,failIfMajorPerformanceCaveat:false,preserveDrawingBuffer:this._map.config.preserveDrawingBuffer,stencil:true};if(C.Browser.safari){i.alpha=true}var T=this._map;var e=T.config.webgl2;return this._canvas.getContext(e?"webgl2":"webgl",i)||this._canvas.getContext("experimental-webgl",i)},_checkTextureAtlasUsage:function(){if(this._labelTextTextureAtlas){var e=this._labelTextTextureAtlas.getUsage();if(e>0.85){this._currentTextureIsFull=true}}},_initialize:function(){var hV=this.gl;var hR=this;this._map.addEventListener("update",function(i){if(i.changedStatus.onsize_changed){hR._resizeHandler()}});var hU=this._map;this.tileScale=1;this.stepZoom=hU.getZoom();this.polyZoomRatio=1;this.normalMatrix=mat4.create();this.background=r;var hR=this;hR.updateBackground=function(){if(typeof hU.config.style==="string"){hR.background=r}else{if(bo.customStyleInfo){var i=bo.customStyleInfo.bmapLandColor;if(i){hR.background=gZ.parseHexToRgbaArray(i)}else{hR.background=r}}}hR._state.clearColor(hR.background)};hU.addEventListener("style_loaded",function(){hR.updateBackground()});this._state=cb.WebGLState.get(hV,bo.getGUID("glmap_"));this._state.clearColor(this.background);this._state.enableCap("stencilTest");this._state.enableCap("depthTest");this._state.enableCap("cullFace");this._state.depthFunc(hV.LEQUAL);this._state.enableCap("blend");this._state.blendFunc(hV.SRC_ALPHA,hV.ONE_MINUS_SRC_ALPHA,hV.ONE,hV.ONE_MINUS_SRC_ALPHA);this._state.depthMask(true);this._needToDestroy=[];b4.init(this);if(this._useSMAA){this.initSMAAFrameBuffers()}this._cache=new eZ(C.Browser.ie?64:128,{clearCallback:function(i){hR._needToDestroy.push(i)}});this._map.on("zoom_changed",function(hW){var i=hW.target.getZoom();hR.stepZoom=Math.floor(i/0.25)*0.25});this._map.on("mapglidle",function hT(){for(var hX=0,hW=hR._needToDestroy.length;hX<hW;hX++){hR.destroyCache(hR._needToDestroy[hX])}hR._needToDestroy.length=0;if(hR._currentTextureIsFull===true){hR._textTextureManager.free(hR._labelTextTextureAtlas);hR._labelTextureAtlasOffset={};hR._currentTextureIsFull=false;hR._textureAddToJob={};hR._labelTextTextureAtlas=hR._textTextureManager.getEmptyTexture();this.fire(new bb("onrefresh"))}});this._map.on("destroy",function(){hR._canvas.removeEventListener("webglcontextlost",hd,false);var i=hR.gl.getExtension("WEBGL_lose_context");if(i){i.loseContext()}});this._textureJobScheduler=this._map.jobScheduler;this._depthEpsilon=8/Math.pow(2,16);this._depthRange=1-this._depthEpsilon*hv;this.programMgr=new ad(hV,this._map);this._skyColor=this._getSkyColor();hU.addEventListener("displayoptions_changed",function(){hR._skyColor=hR._getSkyColor()});var e=this._map.height/2;var hS=hU.config.skyColorStop||[0,0.1,0.7,1];for(var hQ=0;hQ<hS.length;hQ++){hS[hQ]*=e}var T=new Float32Array([0,hS[0],0,10000,hS[0],0,10000,hS[1],0,0,hS[0],0,10000,hS[1],0,0,hS[1],0,0,hS[1],0,10000,hS[1],0,10000,hS[2],1,0,hS[1],0,10000,hS[2],1,0,hS[2],1,0,hS[2],1,10000,hS[2],1,10000,hS[3],1,0,hS[2],1,10000,hS[3],1,0,hS[3],1]);this.skyVAO=new hq();this.skyBuffer=new fi(T,{components:3,members:[{name:"aPos",components:3,offset:0,type:"Float32"}]},fi.BufferType.VERTEX);this.textureAtlasMarker=new cb.TextureAtlas(this.gl,{width:2048,height:2048,unpackAlpha:true});this._imageMergedOffset={};this._labelGroundVertexBuffer=new Float32Array(10000);this._labelVertexBuffer=new Float32Array(65000);this._labelVertexBuffer3D=new Float32Array(65000);this._labelIconVertexBuffer=new Float32Array(65000);this._map.on("style_willchange",function(){hR._textRenderType=this.config.textRenderType;if(hR._textRenderType==="canvas"){hR._renderPng8Text=false}else{hR._renderPng8Text=true}hR._iconTextureManager=new cb.TextTextureManager(hV,{width:1024,height:1024,unpackAlpha:true});hR._iconTextureAtlas=hR._iconTextureManager.getEmptyTexture()})},_getSkyColor:function(){var e=this._map._displayOptions.skyColors;var hQ=[];for(var T=0;T<e.length;T++){var hS=gZ.parseCSSColor(e[T]);hQ.push([hS[0]/255,hS[1]/255,hS[2]/255,hS[3]/255])}var hR=this._map.config.skyColor;if(hR){hQ=hR}return hQ},_resizeHandler:function(hU){var hW=this;var i=hW._map;var hT=i.getSize();var T=hT.width;var hX=hT.height;var hV=i.config.ratio;var hQ=this._canvas;var hR=hQ.style;hR.width=T+"px";hR.height=hX+"px";hQ.width=Math.round(T*hV);hQ.height=Math.round(hX*hV);hW._width=T;hW._height=hX;var hS=this.gl;hS.viewport(0,0,hS.drawingBufferWidth,hS.drawingBufferHeight);this._frameBufferSizeInvalid=true},createDebugBuffer:function(T){var i=s[T];if(!this._debugBufferCache[i]){var e=[0,0,i,0,i,i,0,i];this._debugBufferCache[i]={vao:new hq(),buffer:new fi(new Uint16Array(e),{components:2,members:[{name:"a_pos",components:2,offset:0,type:"Uint16"}]},fi.BufferType.VERTEX)}}this.debugVAO=this._debugBufferCache[i].vao;this.debugBuffer=this._debugBufferCache[i].buffer},createGridBuffer:function(T){var i=s[T];if(!this._gridBufferCache[i]){var e=new Float32Array([0,0,0,0,i,0,1,0,0,i,0,1,i,i,1,1]);this._gridBufferCache[i]={vao:new hq(),buffer:new fi(e,{components:4,members:[{name:"a_pos",components:2,offset:0,type:"Float32"},{name:"a_tex",components:2,offset:8,type:"Float32"}]},fi.BufferType.VERTEX)}}this.gridVAO=this._gridBufferCache[i].vao;this.gridBuffer=this._gridBufferCache[i].buffer},_handleContextStatus:function(){var e=this._canvas;e.addEventListener("webglcontextlost",hd,false)}});function n(e){this._map=e;this._overlays=[[],[],[],[],[],[]];this._renderData=[[],[{styleData:[[],[]],texture:null,textureSize:null,zoomWithMap:null,overlay:null}],[],[],[],[]];this._polylineRenderData={};this._iconImage={};this._needRAF=0;this._customOverlays=[];this._useRound=true;this._ratio=1;if(a6()>1){this._ratio=2}e._overlayMgrGL=this;this._init()}C.extend(n.prototype,{_init:function(){this._bind()},_bind:function(){var i=this;var hQ=this._map;function hS(hW){var hU=hW.overlay||this;var hV=hW.action||"";var hT=true;i._updateGraph(hU,hV,false,hT);if(hV==="remove"){i._removeOverlay(hU,hS)}}function T(hW){var hT=hW.overlay||this;var hV=hW.action||"";var hU=hW.imageUrlChanged||false;i._updateMarker(hT,hV,hU);if(hV==="remove"){i._removeOverlay(hT,T)}}hQ.on("beforeaddoverlay",function(hU){if(!(hU.overlay instanceof w)){return}var hT=hU.overlay;if(i._overlays[0].length===0&&i._overlays[1].length===0&&i._overlays[3].length===0&&i._overlays[5].length===0){i._map._polyOverlayBasePoint=hT.getBoundsIn().getCenter();i._map.fire(new bb("onupdateoverlaymatrix"))}});hQ.on("addoverlay",function hR(hW){if(!(hW.overlay instanceof w)&&!(hW.overlay instanceof dr)&&!(hW.overlay instanceof bd)){return}var hU=hW.overlay;var hT=0;if(hW.overlay instanceof a){hT=1}else{if(hW.overlay instanceof dr){hT=2}else{if(hW.overlay instanceof bs){hT=3}else{if(hW.overlay instanceof bd){hT=4}else{if(hW.overlay instanceof dW){hT=5}}}}}for(var hV=0;hV<i._overlays[hT].length;hV++){if(i._overlays[hT][hV].hashCode===hU.hashCode){return}}if(hT!==2&&hT!==4&&i._overlays[0].length===0&&i._overlays[1].length===0&&i._overlays[3].length===0&&i._overlays[5].length===0){i._map._polyOverlayBasePoint=hU.getBoundsIn().getCenter();i._map.fire(new bb("onupdateoverlaymatrix"))}i._overlays[hT].push(hU);if(hT!==2&&hT!==4){hU.on("lineupdate",hS);i._updateGraph(hU,"add",false,true)}else{if(hT===2){hU.on("status_change",T);i._updateMarker(hU,"add")}else{if(hT===4){hU.on("status_change",T);hU.on("lineupdate",T);i._updateMarker(hU,"add")}}}});hQ.on("update",function e(hW){var hU=false;for(var hV=0;hV<i._overlays[0].length;hV++){if(i._updateGraph(i._overlays[0][hV],"",true,false)===true){hU=true}}for(hV=0;hV<i._overlays[1].length;hV++){if(i._updateGraph(i._overlays[1][hV],"",true,false)===true){hU=true}}for(hV=0;hV<i._overlays[3].length;hV++){if(i._updateGraph(i._overlays[3][hV],"",true,false)===true){hU=true}}for(hV=0;hV<i._overlays[5].length;hV++){if(i._updateGraph(i._overlays[5][hV],"",true,false)===true){hU=true}}if(hU){i._mergePolylineGraphData();i._map._featureMgr.setOverlayData(i._renderData[1],1)}var hT=new bb("onrefresh");hT.source="webgloverlaymgr";this.fire(hT)});hQ.addEventListener("movestart",function(){if(this.getMapType()!=="B_NORMAL_MAP"){return}i._useRound=false});hQ.addEventListener("moveend",function(hV){if(this.getMapType()!=="B_NORMAL_MAP"){return}if(hV.userData&&hV.userData.readyToMove===true){return}i._useRound=true;var hT=false;for(var hU=0;hU<i._overlays[0].length;hU++){if(i._updateGraph(i._overlays[0][hU],"",true,true)===true){hT=true}}for(hU=0;hU<i._overlays[1].length;hU++){if(i._updateGraph(i._overlays[1][hU],"",true,true)===true){hT=true}}for(hU=0;hU<i._overlays[3].length;hU++){if(i._updateGraph(i._overlays[3][hU],"",true,true)===true){hT=true}}for(var hU=0;hU<i._overlays[5].length;hU++){if(i._updateGraph(i._overlays[5][hU],"",true,true)===true){hT=true}}if(hT){i._mergePolylineGraphData();i._map._featureMgr.setOverlayData(i._renderData[1],1)}});hQ.addEventListener("zoomstart",function(){if(this.getMapType()!=="B_NORMAL_MAP"){return}i._useRound=false});hQ.addEventListener("zoomend",function(){if(this.getMapType()!=="B_NORMAL_MAP"){return}i._useRound=true;var hT=false;for(var hU=0;hU<i._overlays[0].length;hU++){if(i._updateGraph(i._overlays[0][hU],"",true,true)===true){hT=true}}for(hU=0;hU<i._overlays[1].length;hU++){if(i._updateGraph(i._overlays[1][hU],"",true,true)===true){hT=true}}for(hU=0;hU<i._overlays[3].length;hU++){if(i._updateGraph(i._overlays[3][hU],"",true,true)===true){hT=true}}for(hU=0;hU<i._overlays[5].length;hU++){if(i._updateGraph(i._overlays[5][hU],"",true,true)===true){hT=true}}if(hT){i._mergePolylineGraphData();i._map._featureMgr.setOverlayData(i._renderData[1],1)}});if(hQ.temp.originMapType===BMAP_EARTH_MAP){return}this._syncOverlayFromMap(hS,T)},_removeOverlay:function(T,hR){if(!(T instanceof w)&&!(T instanceof dr)){return}var e=0;if(T instanceof a){e=1}else{if(T instanceof dr){e=2}else{if(T instanceof bs){e=3}else{if(T instanceof bd){e=4}else{if(T instanceof dW){e=5}}}}}for(var hQ=0;hQ<this._overlays[e].length;hQ++){if(this._overlays[e][hQ].hashCode===T.hashCode){this._overlays[e].splice(hQ,1);break}}if(this._map._polyOverlayBasePoint&&this._overlays[0].length===0&&this._overlays[1].length===0&&this._overlays[3].length===0&&this._overlays[5].length===0){this._map._polyOverlayBasePoint=null}T.off("lineupdate",hR)},_syncOverlayFromMap:function(hU,hT){var e=this._map._overlayArray;var hR=false;for(var hS=0;hS<e.length;hS++){var hQ=e[hS];if(hQ instanceof a===true||hQ instanceof fl===true){if(this._overlays[0].length===0&&this._overlays[1].length===0&&this._overlays[3].length===0&&this._overlays[5].length===0){this._map._polyOverlayBasePoint=hQ.getBoundsIn().getCenter();this._map.fire(new bb("onupdateoverlaymatrix"))}this._overlays[1].push(hQ);hQ.on("lineupdate",hU);if(this._updateGraph(hQ,"add",true)===true){hR=true}}else{if(hQ instanceof aR===true){if(this._overlays[0].length===0&&this._overlays[1].length===0&&this._overlays[3].length===0&&this._overlays[5].length===0){this._map._polyOverlayBasePoint=hQ.getBoundsIn().getCenter();this._map.fire(new bb("onupdateoverlaymatrix"))}this._overlays[0].push(hQ);hQ.on("lineupdate",hU);if(this._updateGraph(hQ,"add",true)===true){hR=true}}else{if(hQ instanceof dW){if(this._overlays[0].length===0&&this._overlays[1].length===0&&this._overlays[3].length===0&&this._overlays[5].length===0){this._map._polyOverlayBasePoint=hQ.getBoundsIn().getCenter();this._map.fire(new bb("onupdateoverlaymatrix"))}this._overlays[5].push(hQ);hQ.on("lineupdate",hU);if(this._updateGraph(hQ,"add",true)===true){hR=true}}else{if(hQ instanceof bs===true){if(this._overlays[0].length===0&&this._overlays[1].length===0&&this._overlays[3].length===0&&this._overlays[5].length===0){this._map._polyOverlayBasePoint=hQ.getBoundsIn().getCenter();this._map.fire(new bb("onupdateoverlaymatrix"))}this._overlays[3].push(hQ);hQ.on("lineupdate",hU);if(this._updateGraph(hQ,"add",true)===true){hR=true}}else{if(hQ instanceof dr){this._overlays[2].push(hQ);hQ.on("status_change",hT);this._updateMarker(hQ,"add")}else{if(hQ instanceof bd){this._overlays[4].push(hQ);hQ.on("status_change",hT);hQ.on("lineupdate",hT);this._updateMarker(hQ,"add")}}}}}}}if(hR){this._mergePolylineGraphData();this._map._featureMgr.setOverlayData(this._renderData[1],1)}var T=new bb("onrefresh");T.source="webgloverlaymgr";this._map.fire(T)},_updateMarkerRenderData:function(hT,hS,hX){if(!this._renderData[hT.hashCode]){return false}var hY=false;var T=hT instanceof bd;var hW=T?4:2;var e=T?7:5;for(var hV=0;hV<this._renderData[hW].length;hV++){var hR=this._renderData[hW][hV];if(hR.hashCode===hT.hashCode){hY=true;hR.renderData=hT.getVertexInfoForGL(this._useRound);var hZ=hR.overlay._config.icon;var h0=hZ.imageUrl;var hQ=hZ.imageDom;if(this._ratio>1&&hZ.srcSetObject["2x"]){h0=hZ.srcSetObject["2x"];hZ.ratio=2}var hU;var h1;if(h0){h1=this._iconImage[h0]}else{if(hQ){h1=this._iconImage[hQ.id]}}if(h1){hU=h1.img}if(hU){hR.textureSource=hU;this._map._featureMgr.setOverlayData(this._renderData[hW],e);return true}hR.textureSource=null;this._removeMarkerFromRenderData(hT);this._addMarkerToRenderData(hT);break}}if(!hY&&hS==="setIcon"&&hX){this._renderData[hT.hashCode]=null;this._addMarkerToRenderData(hT)}return false},_addMarkerToRenderData:function(hS){if(this._renderData[hS.hashCode]){return false}this._renderData[hS.hashCode]=true;var hV=this;function hR(h6,h3,h2,h8){var h1=h3 instanceof bd;var h5=h1?4:2;var h7=h1?7:5;if(h3.map&&h3._visible===true&&((h3 instanceof dr&&h3.domElement!==null)||h3 instanceof bd)){if(h2!==null){if(((hV._ratio===1||!hW.srcSetObject["2x"])&&h3._config.icon.imageUrl!==h2)||(hV._ratio>1&&hW.srcSetObject["2x"]&&hW.srcSetObject["2x"]!==h2)){return}}else{if(h8!==null){if(h6!==h8){return}}}var h4=h3.getVertexInfoForGL(hV._useRound);hV._renderData[h5].push({overlay:h3,hashCode:h3.hashCode,textureSource:h6,renderData:h4});hV._renderData[h3.hashCode]=true}else{hV._renderData[h3.hashCode]=null}hV._renderData[h5].sort(function(ia,h9){return ia.overlay._zIndex-h9.overlay._zIndex});hV._map._featureMgr.setOverlayData(hV._renderData[h5],h7)}var hW=hS._config.icon;if(hS instanceof bd&&!hW){var hY=hS.getVertexInfoForGL(hV._useRound);hV._renderData[4].push({overlay:hS,hashCode:hS.hashCode,textureSource:null,renderData:hY});hV._renderData[hS.hashCode]=true;hV._map._featureMgr.setOverlayData(hV._renderData[4],7);var hZ=new bb("onrefresh");hZ.source="webgloverlaymgr";hV._map.fire(hZ);return true}var hX=hW.imageUrl;var hQ=hW.imageDom;var hT;var h0;if(this._ratio>1&&hW.srcSetObject["2x"]){hX=hW.srcSetObject["2x"];hW.ratio=2}if(hX){h0=this._iconImage[hX]}else{if(hQ){h0=this._iconImage[hQ.id]}}if(h0){hT=h0.img}if(hT){hR(hT,hS,hX,hQ);return true}if(h0){h0.pendings.push(hS)}else{if(hX){hT=new Image();hT.crossOrigin="anonymous";hT.onload=function(){hV._iconImage[hX].loaded=true;hV._iconImage[hX].img=this;for(var h4=0;h4<hV._iconImage[hX].pendings.length;h4++){hR(this,hV._iconImage[hX].pendings[h4],hX)}hV._iconImage[hX].pendings=[];var h2=hS instanceof bd;var h3=h2?4:2;var h5=h2?7:5;hV._map._featureMgr.setOverlayData(hV._renderData[h3],h5);var h1=new bb("onrefresh");h1.source="webgloverlaymgr";hV._map.fire(h1)};this._iconImage[hX]={pendings:[hS]};hT.src=hX}else{if(hQ){var T=hQ.id;hV._iconImage[T]={pendings:[],loaded:true,img:hQ};hR(hQ,hS,hX,hQ);var i=hS instanceof bd;var hU=i?4:2;var e=i?7:5;hV._map._featureMgr.setOverlayData(hV._renderData[hU],e);var hZ=new bb("onrefresh");hZ.source="webgloverlaymgr";hV._map.fire(hZ)}}}return false},_removeMarkerFromRenderData:function(T){if(!this._renderData[T.hashCode]){return false}if(T instanceof bd){for(var hQ=0;hQ<this._renderData[4].length;hQ++){if(this._renderData[4][hQ].hashCode===T.hashCode){this._renderData[4].splice(hQ,1);break}}}else{if(T instanceof dr){var hS=T._config.icon;if(hS){var e=T._config.icon.imageUrl;if(this._ratio>1&&hS.srcSetObject["2x"]){e=hS.srcSetObject["2x"]}if(this._iconImage[e]&&this._iconImage[e].pendings){var hR=this._iconImage[e].pendings;for(var hQ=hR.length-1;hQ>=0;hQ--){if(hR[hQ]===T){hR.splice(hQ,1)}}}}for(var hQ=0;hQ<this._renderData[2].length;hQ++){if(this._renderData[2][hQ].hashCode===T.hashCode){this._renderData[2].splice(hQ,1);break}}}}this._renderData[T.hashCode]=null;return true},_updateGraph:function(hQ,hR,hS,e){var T=false;var hT="";if(hQ){hR=hR||"";if(!hQ.ifInMapView()){if(this._removeGraphFromRenderData(hQ)===true){T=true}hQ._notInView=true}else{if(hR==="add"||hR==="show"||hQ._notInView===true){hQ._notInView=false;if(hQ._visible===true){if(this._addGraphToRenderData(hQ)===true){T=true}hT="add"}}else{if(hR==="remove"||hR==="hide"){if(this._removeGraphFromRenderData(hQ)===true){T=true}}else{if(this._updateGraphRenderData(hQ,e)===true){T=true}else{T=this._updateGraphRenderData(hQ,hR)}}}}}if(!hS&&T){this._mergePolylineGraphData(hT);this._map._featureMgr.setOverlayData(this._renderData[1],1)}var i=new bb("onrefresh");i.source="webgloverlaymgr";this._map.fire(i);return T},_mergePolylineGraphData:function(hQ){if(hQ==="add"){var T=this._overlays[this._lastAddGraphIndex];if(!T[T.length-1]){return}var e=T[T.length-1].hashCode;var i=this._polylineRenderData[e];if(i){this._mergeOnePolylineData(i)}return}this._renderData[1].length=0;this._renderData[1][0]={style:[],styleData:[[],[]]};this._mergeGraphArrayData(this._overlays[0]);this._mergeGraphArrayData(this._overlays[1])},_mergeGraphArrayData:function(hQ){for(var T=0;T<hQ.length;T++){var e=hQ[T].hashCode;if(!this._polylineRenderData[e]){continue}this._mergeOnePolylineData(this._polylineRenderData[e])}},_mergeOnePolylineData:function(h2){var h0=this._renderData[1].length-1;var hR=this._renderData[1][h0];var i=this._renderData[1][h0].styleData[0];var hW=this._renderData[1][h0].styleData[1];var hX=9;for(var hQ=0;hQ<h2.styleData.length;hQ++){var T=h2.styleData[hQ];var h1=T[0];var hT=T[1];var hV=i.length/hX;var hZ=h1.length/hX;var e=h2.overlay.canRenderDataBeMerged();var hY=true;if(hR.overlay&&!hR.overlay.canRenderDataBeMerged()){hY=false}if(hV+hZ>65536||(hR.styleData[0].length>0&&e===false)||hY===false){h0++;hR=this._renderData[1][h0]={style:[],styleData:[[],[]],texture:null,textureSize:null,zoomWithMap:null,overlay:null};i=hR.styleData[0];hW=hR.styleData[1];hV=0}if(hR.styleData[0].length===0&&e===false){hR.texture=h2.texture;hR.textureSize=h2.textureSize;hR.zoomWithMap=h2.zoomWithMap;hR.overlay=h2.overlay}for(var hU=0;hU<hZ;hU++){i[i.length]=h1[hU*hX];i[i.length]=h1[hU*hX+1];i[i.length]=h1[hU*hX+2];i[i.length]=h1[hU*hX+3];i[i.length]=h1[hU*hX+4];i[i.length]=h1[hU*hX+5];i[i.length]=h1[hU*hX+6];i[i.length]=h1[hU*hX+7];i[i.length]=h1[hU*hX+8]}for(var hS=0;hS<hT.length;hS++){hW[hW.length]=hT[hS]+hV}}},_addGraphToRenderData:function(hQ){if(this._renderData[hQ.hashCode]){return false}var hW;var hV;if(hQ instanceof bs){this._lastAddGraphIndex=3;var i=hQ.buildFillVertex(c9);var T={vertex:i.vertex,index:i.index};T.hashCode=hQ.hashCode;T.hasMultipleParts=hQ.hasMultipleParts;this._renderData[3].push(T);this._map._featureMgr.setOverlayData(this._renderData[3],6)}else{if(hQ instanceof dW){this._lastAddGraphIndex=5;hV=hQ.getFillStyleForGL();var i=hQ.buildFillVertex(c9);var hU=hV.type;var hT=this;if(hU==="image"){var hR=new Image();hR.crossOrigin="anonymous";hR.onload=function hS(){var hX={opacity:hV.opacity,vertex:i[0],index:i[1],textureSource:this,src:this.src,overlay:hQ};hX.hashCode=hQ.hashCode;hX.hasMultipleParts=hQ.hasMultipleParts;hT._renderData[5].push(hX);hT._map._featureMgr.setOverlayData(hT._renderData[5],8)};hR.src=hV.texture}else{if(hU==="canvas"){var T={textureSource:hV.texture,src:"canavs_"+new Date().valueOf(),opacity:hV.opacity,vertex:i[0],index:i[1],overlay:hQ};T.hashCode=hQ.hashCode;T.hasMultipleParts=hQ.hasMultipleParts;hT._renderData[5].push(T);hT._map._featureMgr.setOverlayData(hT._renderData[5],8)}else{if(hU==="video"){var e=document.createElement("video");e.controls=false;e.autoplay=true;e.crossOrigin="anonymous";e.loop=true;e.style.width="256px;";e.style.height="256px;";e.oncanplay=function(){if(this._videoloaded){return}var hX={opacity:hV.opacity,vertex:i[0],index:i[1],textureSource:this,src:this.src,overlay:hQ};hX.hashCode=hQ.hashCode;hX.hasMultipleParts=hQ.hasMultipleParts;hT._renderData[5].push(hX);hT._map._featureMgr.setOverlayData(hT._renderData[5],8);this._videoloaded=true};e.src=hV.texture;this._needRAF+=1}}}}else{if(hQ instanceof aR){this._lastAddGraphIndex=0;hV=hQ.getFillStyleForGL();var i=hQ.buildFillVertex(c9);var T=[hV,i[0],i[1]];T.hashCode=hQ.hashCode;T.hasMultipleParts=hQ.hasMultipleParts;this._renderData[0].push(T);this._map._featureMgr.setOverlayData(this._renderData[0],0);if(hQ._config.strokeOpacity>0&&hQ._config.strokeWeight>0){hW=hQ.buildVertex(fh,true);this._polylineRenderData[hQ.hashCode]={cacheIndex:hW.cacheIndex,hashCode:hQ.hashCode,styleData:hW,texture:hQ._config.texture,textureSize:hQ._config.textureSize,zoomWithMap:hQ._config.textureZoomWithMap,overlay:hQ}}}else{this._lastAddGraphIndex=1;hW=hQ.buildVertex(fh,true);this._polylineRenderData[hQ.hashCode]={cacheIndex:hW.cacheIndex,hashCode:hQ.hashCode,styleData:hW,texture:hQ._config.texture,textureSize:hQ._config.textureSize,zoomWithMap:hQ._config.textureZoomWithMap,overlay:hQ}}}}this._renderData[hQ.hashCode]=true;this._updateOverlayLoopRender();return true},_removeGraphFromRenderData:function(T){if(!this._renderData[T.hashCode]){return false}if(T instanceof bs){for(var hQ=0;hQ<this._renderData[3].length;hQ++){if(this._renderData[3][hQ].hashCode===T.hashCode){this._renderData[3].splice(hQ,1);break}}this._map._featureMgr.setOverlayData(this._renderData[3],6)}if(T instanceof aR){for(var hQ=0;hQ<this._renderData[0].length;hQ++){if(this._renderData[0][hQ].hashCode===T.hashCode){this._renderData[0].splice(hQ,1);break}}this._map._featureMgr.setOverlayData(this._renderData[0],0)}if(T instanceof dW){for(var hQ=0;hQ<this._renderData[5].length;hQ++){if(this._renderData[5][hQ].hashCode===T.hashCode){var e=this._renderData[5].splice(hQ,1);if(e[0].overlay._config.type==="video"){this._needRAF-=1}break}}this._map._featureMgr.setOverlayData(this._renderData[5],8)}this._polylineRenderData[T.hashCode]=null;this._renderData[T.hashCode]=null;this._updateOverlayLoopRender();return true},_updateOverlayLoopRender:function(){var e=this;if(this._needRAF>0){if(this._rafTimer){return}this._rafTimer=requestAnimationFrame(e._loopRender.bind(e))}else{cancelAnimationFrame(this._rafTimer);this._rafTimer=undefined}},_loopRender:function(){this._map._webglMapScene.startRenderThread();this._rafTimer=requestAnimationFrame(this._loopRender.bind(this))},_updateGraphRenderData:function(T,hW){var hV;var hS=false;var hT;if(T instanceof bs){var e=T.buildFillVertex(c9,hW);for(var hR=0;hR<this._renderData[3].length;hR++){var hX=this._renderData[3][hR];if(hX.hashCode===T.hashCode){this._renderData[3][hR].vertex=e.vertex;this._renderData[3][hR].index=e.index;this._map._featureMgr.setOverlayData(this._renderData[3],6);this._removeGraphFromRenderData(T);this._addGraphToRenderData(T);break}}}if(T instanceof aR){hT=T.getFillStyleForGL();var e=T.buildFillVertex(c9);for(var hR=0;hR<this._renderData[0].length;hR++){if(this._renderData[0][hR].hashCode===T.hashCode){this._renderData[0][hR][0]=hT;this._renderData[0][hR][1]=e[0];this._renderData[0][hR][2]=e[1];break}}this._map._featureMgr.setOverlayData(this._renderData[0],0)}hV=T.buildVertex(fh,hW);var hU=T.hashCode;if(this._polylineRenderData[hU]){if(!hV.inCache||hV.cacheIndex!==this._polylineRenderData[hU].cacheIndex){hS=true;var hQ=this._polylineRenderData[hU];hQ.cacheIndex=hV.cacheIndex;hQ.styleData=hV;hQ.texture=T._config.texture;hQ.textureSize=T._config.textureSize;hQ.zoomWithMap=T._config.textureZoomWithMap;hQ.overlay=T}}return hS},_updateMarker:function(i,hR,hQ){var T=false;if(i){hR=hR||"";if(hR==="add"||hR==="show"){if(i._visible===true&&i.getPositionIn()!==null){T=this._addMarkerToRenderData(i)}}else{if(hR==="remove"||hR==="hide"){T=this._removeMarkerFromRenderData(i)}else{T=this._updateMarkerRenderData(i,hR,hQ)}}}if(T){var e=new bb("onrefresh");e.source="webgloverlaymgr";this._map.fire(e)}}});function c9(hV,h0,hW,hX,h2){hW=hW||2;var hY=h0&&h0.length;var hT=hY?h0[0]*hW:hV.length;var hZ=fR(hV,0,hT,hW,true);var hS=h2||[];if(!hZ){return hS}var hR;var hQ;var T;var e;var h3;var h1;var h4;hX=hX||0;if(hY){hZ=gi(hV,h0,hZ,hW)}if(hV.length>80*hW){hR=T=hV[0];hQ=e=hV[1];for(var hU=hW;hU<hT;hU+=hW){h3=hV[hU];h1=hV[hU+1];if(h3<hR){hR=h3}if(h1<hQ){hQ=h1}if(h3>T){T=h3}if(h1>e){e=h1}}h4=Math.max(T-hR,e-hQ)}f0(hZ,hS,hW,hR,hQ,h4,null,hX);return hS}function fR(hS,hU,e,hT,T){var hQ;var hR;if(T===(aU(hS,hU,e,hT)>0)){for(hQ=hU;hQ<e;hQ+=hT){hR=bY(hQ,hS[hQ],hS[hQ+1],hR)}}else{for(hQ=e-hT;hQ>=hU;hQ-=hT){hR=bY(hQ,hS[hQ],hS[hQ+1],hR)}}if(hR&&e4(hR,hR.next)){fG(hR);hR=hR.next}return hR}function y(hQ,e){if(!hQ){return hQ}if(!e){e=hQ}var T=hQ;var i;do{i=false;if(!T.steiner&&(e4(T,T.next)||cw(T.prev,T,T.next)===0)){fG(T);T=e=T.prev;if(T===T.next){return null}i=true}else{T=T.next}}while(i||T!==e);return e}function f0(i,hQ,hT,hR,e,hX,hW,hU){if(!i){return}if(!hW&&hX){A(i,hR,e,hX)}var hV=i;var T;var hS;while(i.prev!==i.next){T=i.prev;hS=i.next;if(hX?F(i,hR,e,hX):dC(i)){hQ.push(T.i/hT+hU);hQ.push(i.i/hT+hU);hQ.push(hS.i/hT+hU);fG(i);i=hS.next;hV=hS.next;continue}i=hS;if(i===hV){if(!hW){f0(y(i),hQ,hT,hR,e,hX,1,hU)}else{if(hW===1){i=eT(i,hQ,hT,hU);f0(i,hQ,hT,hR,e,hX,2,hU)}else{if(hW===2){d6(i,hQ,hT,hR,e,hX,hU)}}}break}}}function dC(T){var i=T.prev;var e=T;var hR=T.next;if(cw(i,e,hR)>=0){return false}var hQ=T.next.next;while(hQ!==T.prev){if(au(i.x,i.y,e.x,e.y,hR.x,hR.y,hQ.x,hQ.y)&&cw(hQ.prev,hQ,hQ.next)>=0){return false}hQ=hQ.next}return true}function F(hS,hT,hR,hZ){var hW=hS.prev;var hV=hS;var hU=hS.next;if(cw(hW,hV,hU)>=0){return false}var h0=hW.x<hV.x?(hW.x<hU.x?hW.x:hU.x):(hV.x<hU.x?hV.x:hU.x);var hX=hW.y<hV.y?(hW.y<hU.y?hW.y:hU.y):(hV.y<hU.y?hV.y:hU.y);var hQ=hW.x>hV.x?(hW.x>hU.x?hW.x:hU.x):(hV.x>hU.x?hV.x:hU.x);var T=hW.y>hV.y?(hW.y>hU.y?hW.y:hU.y):(hV.y>hU.y?hV.y:hU.y);var i=al(h0,hX,hT,hR,hZ);var hY=al(hQ,T,hT,hR,hZ);var e=hS.nextZ;while(e&&e.z<=hY){if(e!==hS.prev&&e!==hS.next&&au(hW.x,hW.y,hV.x,hV.y,hU.x,hU.y,e.x,e.y)&&cw(e.prev,e,e.next)>=0){return false}e=e.nextZ}e=hS.prevZ;while(e&&e.z>=i){if(e!==hS.prev&&e!==hS.next&&au(hW.x,hW.y,hV.x,hV.y,hU.x,hU.y,e.x,e.y)&&cw(e.prev,e,e.next)>=0){return false}e=e.prevZ}return true}function eT(hT,T,hS,hR){var hQ=hT;do{var i=hQ.prev;var e=hQ.next.next;if(!e4(i,e)&&fH(i,hQ,hQ.next,e)&&e6(i,e)&&e6(e,i)){T.push(i.i/hS+hR);T.push(hQ.i/hS+hR);T.push(e.i/hS+hR);fG(hQ);fG(hQ.next);hQ=hT=e}hQ=hQ.next}while(hQ!==hT);return hQ}function d6(e,T,hR,hQ,i,hW,hS){var hV=e;do{var hU=hV.next.next;while(hU!==hV.prev){if(hV.i!==hU.i&&gJ(hV,hU)){var hT=ar(hV,hU);hV=y(hV,hV.next);hT=y(hT,hT.next);f0(hV,T,hR,hQ,i,hW,null,hS);f0(hT,T,hR,hQ,i,hW,null,hS);return}hU=hU.next}hV=hV.next}while(hV!==e)}function gi(hQ,hX,hT,hS){var hU=[];var hR;var hV;var e;var T;var hW;for(hR=0,hV=hX.length;hR<hV;hR++){e=hX[hR]*hS;T=hR<hV-1?hX[hR+1]*hS:hQ.length;hW=fR(hQ,e,T,hS,false);if(hW===hW.next){hW.steiner=true}hU.push(cY(hW))}hU.sort(dA);for(hR=0;hR<hU.length;hR++){ge(hU[hR],hT);hT=y(hT,hT.next)}return hT}function dA(i,e){return i.x-e.x}function ge(T,i){i=dx(T,i);if(i){var e=ar(i,T);y(e,e.next)}}function dx(e,hR){var i=hR;var hT=e.x;var hS=e.y;var hQ=-Infinity;var T;do{if(hS<=i.y&&hS>=i.next.y){var hW=i.x+(hS-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(hW<=hT&&hW>hQ){hQ=hW;if(hW===hT){if(hS===i.y){return i}if(hS===i.next.y){return i.next}}T=i.x<i.next.x?i:i.next}}i=i.next}while(i!==hR);if(!T){return null}if(hT===hQ){return T.prev}var hV=T;var hZ=T.x;var hX=T.y;var hY=Infinity;var hU;i=T.next;while(i!==hV){if(hT>=i.x&&i.x>=hZ&&au(hS<hX?hT:hQ,hS,hZ,hX,hS<hX?hQ:hT,hS,i.x,i.y)){hU=Math.abs(hS-i.y)/(hT-i.x);if((hU<hY||(hU===hY&&i.x>T.x))&&e6(i,e)){T=i;hY=hU}}i=i.next}return T}function A(hR,e,hQ,i){var T=hR;do{if(T.z===null){T.z=al(T.x,T.y,e,hQ,i)}T.prevZ=T.prev;T.nextZ=T.next;T=T.next}while(T!==hR);T.prevZ.nextZ=null;T.prevZ=null;e2(T)}function e2(hV){var hS;var hR;var hQ;var hU;var hW;var T;var hX;var hT;var hY=1;do{hR=hV;hV=null;hW=null;T=0;while(hR){T++;hQ=hR;hX=0;for(hS=0;hS<hY;hS++){hX++;hQ=hQ.nextZ;if(!hQ){break}}hT=hY;while(hX>0||(hT>0&&hQ)){if(hX===0){hU=hQ;hQ=hQ.nextZ;hT--}else{if(hT===0||!hQ){hU=hR;hR=hR.nextZ;hX--}else{if(hR.z<=hQ.z){hU=hR;hR=hR.nextZ;hX--}else{hU=hQ;hQ=hQ.nextZ;hT--}}}if(hW){hW.nextZ=hU}else{hV=hU}hU.prevZ=hW;hW=hU}hR=hQ}hW.nextZ=null;hY*=2}while(T>1);return hV}function al(i,hR,e,hQ,T){i=32767*(i-e)/T;hR=32767*(hR-hQ)/T;i=(i|(i<<8))&16711935;i=(i|(i<<4))&252645135;i=(i|(i<<2))&858993459;i=(i|(i<<1))&1431655765;hR=(hR|(hR<<8))&16711935;hR=(hR|(hR<<4))&252645135;hR=(hR|(hR<<2))&858993459;hR=(hR|(hR<<1))&1431655765;return i|(hR<<1)}function cY(T){var i=T;var e=T;do{if(i.x<e.x){e=i}i=i.next}while(i!==T);return e}function au(hR,hQ,hT,hS,e,hU,T,i){return(e-T)*(hQ-i)-(hR-T)*(hU-i)>=0&&(hR-T)*(hS-i)-(hT-T)*(hQ-i)>=0&&(hT-T)*(hU-i)-(e-T)*(hS-i)>=0}function gJ(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!cX(i,e)&&e6(i,e)&&e6(e,i)&&ee(i,e)}function cw(T,i,e){return(i.y-T.y)*(e.x-i.x)-(i.x-T.x)*(e.y-i.y)}function e4(i,e){return i.x===e.x&&i.y===e.y}function fH(T,e,i,hQ){if((e4(T,e)&&e4(i,hQ))||(e4(T,hQ)&&e4(i,e))){return true}return cw(T,e,i)>0!==cw(T,e,hQ)>0&&cw(i,hQ,T)>0!==cw(i,hQ,e)>0}function cX(i,e){var T=i;do{if(T.i!==i.i&&T.next.i!==i.i&&T.i!==e.i&&T.next.i!==e.i&&fH(T,T.next,i,e)){return true}T=T.next}while(T!==i);return false}function e6(i,e){return cw(i.prev,i,i.next)<0?cw(i,e,i.next)>=0&&cw(i,i.prev,e)>=0:cw(i,e,i.prev)<0||cw(i,i.next,e)<0}function ee(T,i){var hS=T;var e=false;var hR=(T.x+i.x)/2;var hQ=(T.y+i.y)/2;do{if(((hS.y>hQ)!==(hS.next.y>hQ))&&(hR<(hS.next.x-hS.x)*(hQ-hS.y)/(hS.next.y-hS.y)+hS.x)){e=!e}hS=hS.next}while(hS!==T);return e}function ar(T,i){var e=new aG(T.i,T.x,T.y);var hQ=new aG(i.i,i.x,i.y);var hS=T.next;var hR=i.prev;T.next=i;i.prev=T;e.next=hS;hS.prev=e;hQ.next=e;e.prev=hQ;hR.next=hQ;hQ.prev=hR;return hQ}function bY(T,e,hS,hQ){var hR=new aG(T,e,hS);if(!hQ){hR.prev=hR;hR.next=hR}else{hR.next=hQ.next;hR.prev=hQ;hQ.next.prev=hR;hQ.next=hR}return hR}function fG(e){e.next.prev=e.prev;e.prev.next=e.next;if(e.prevZ){e.prevZ.nextZ=e.nextZ}if(e.nextZ){e.nextZ.prevZ=e.prevZ}}function aG(T,e,hQ){this.i=T;this.x=e;this.y=hQ;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}c9.deviation=function(hT,hY,hV,hQ){var hW=hY&&hY.length;var hS=hW?hY[0]*hV:hT.length;var T=Math.abs(aU(hT,0,hS,hV));if(hW){for(var hU=0,hX=hY.length;hU<hX;hU++){var e=hY[hU]*hV;var hR=hU<hX-1?hY[hU+1]*hV:hT.length;T-=Math.abs(aU(hT,e,hR,hV))}}var h2=0;for(hU=0;hU<hQ.length;hU+=3){var h1=hQ[hU]*hV;var h0=hQ[hU+1]*hV;var hZ=hQ[hU+2]*hV;h2+=Math.abs((hT[h1]-hT[hZ])*(hT[h0+1]-hT[h1+1])-(hT[h1]-hT[h0])*(hT[hZ+1]-hT[h1+1]))}return T===0&&h2===0?0:Math.abs((h2-T)/T)};function aU(hS,hU,e,hT){var hR=0;for(var hQ=hU,T=e-hT;hQ<e;hQ+=hT){hR+=(hS[T]-hS[hQ])*(hS[hQ+1]+hS[T+1]);T=hQ}return hR}c9.flatten=function(hS){var hT=hS[0][0].length;var e={vertices:[],holes:[],dimensions:hT};var hQ=0;for(var hR=0;hR<hS.length;hR++){for(var T=0;T<hS[hR].length;T++){for(var hU=0;hU<hT;hU++){e.vertices.push(hS[hR][T][hU])}}if(hR>0){hQ+=hS[hR-1].length;e.holes.push(hQ)}}return e};');
﻿_jsload&&_jsload('oppcgl', 'function eN(){this._currentState="idle";this._currentTouchCount=0;this._firstPointerId=-1;this._secondPointerId=-1}eN.prototype.takeAction=function(e,i){if(this["_on"+e]){this["_on"+e](i)}return this.getState()};eN.prototype._onmousedown=function(e){if(this._currentTouchCount===0){this._firstPointerId=e}else{if(this._currentTouchCount===1){this._secondPointerId=e}}this._currentTouchCount++;if(this._currentState==="idle"){this._currentState="readyToDrag"}else{if(this._currentState==="dragging"||this._currentState==="readyToDrag"){this._currentState="readyToPinch"}else{if(this._currentState==="pinching"){this._currentState="freeze"}else{this._currentState="freeze"}}}};eN.prototype._onmousemove=function(){if(this._currentState==="readyToDrag"||this._currentState==="dragging"){this._currentState="dragging"}else{if(this._currentState==="readyToPinch"){this._currentState="pinching"}}};eN.prototype._onmouseup=function(e){if(this._currentState==="idle"){return}this._currentTouchCount--;if(this._currentState==="readyToDrag"||this._currentState==="dragging"){this._currentState="idle";this._firstPointerId=-1;this._secondPointerId=-1}else{if(this._currentState==="readyToPinch"||this._currentState==="pinching"){this._clearId(e);this._currentState="freeze"}else{if(this._currentState==="freeze"){if(this._currentTouchCount===0){this._currentState="idle";this._firstPointerId=-1;this._secondPointerId=-1;return}if(this._currentTouchCount===2){if(e!==this._firstPointerId&&e!==this._secondPointerId){this._currentState="pinching"}}if(e===this._firstPointerId||e===this._secondPointerId){this._clearId(e);this._currentState="freeze"}}}}};eN.prototype._ongesturestart=function(){if(window.TouchEvent||!window.GestureEvent){return}if(this._currentState==="idle"||this._currentState==="readyToDrag"){this._currentState="readyToPinch"}};eN.prototype._ongesturechange=function(){if(window.TouchEvent||!window.GestureEvent){return}if(this._currentState==="readyToPinch"){this._currentState="pinching"}};eN.prototype._ongestureend=function(){if(window.TouchEvent||!window.GestureEvent){return}if(this._currentState==="readyToPinch"||this._currentState==="pinching"||this._currentState==="freeze"){this._currentState="idle"}};eN.prototype.getState=function(){return dU[this._currentState]||0};eN.prototype.reset=function(){this._currentState="idle";this._currentTouchCount=0;this._firstPointerId=-1;this._secondPointerId=-1};eN.prototype._clearId=function(e){if(e===this._firstPointerId){this._firstPointerId=-1}else{if(e===this._secondPointerId){this._secondPointerId=-1}}};eN.prototype.setState=function(e){this._currentState=e};bo.register(function(e){if(e._mouse){return}e._mouse=new hm(e);if(!e._mouse._drag){e._mouse=null}if(e._renderType==="webgl"){e.addEventListener("dblclick",function(i){if(!e.config.enableDblclickZoom){return}this.zoomIn(i.point)});e.addEventListener("rightdblclick",function(i){if(!e.config.enableDblclickZoom){return}this.zoomOut(i.point)});e.addEventListener("minuspress",function(i){this.zoomOut()});e.addEventListener("pluspress",function(i){this.zoomIn()})}});function aH(hQ,T){var i={};i.id=hQ.pointerId||0;i.clientPos={x:hQ.clientX||hQ.pageX||0,y:hQ.clientY||hQ.pageY||0};i.clientPos.x=hQ.clientX-hQ.layerX+hQ.offsetX;i.clientPos.y=hQ.clientY-hQ.layerY+hQ.offsetY;i.offsetPos={x:hQ.layerX||hQ.offsetX||0,y:hQ.layerY||hQ.offsetY||0};i.target=hQ.target;i.button=hQ.button||0;i.ctrlKey=hQ.ctrlKey||false;i.metaKey=hQ.metaKey||false;var hR=dE(i,T);C.extend(i,hR);i.offsetPosMap=new ej(hR.x,hR.y);i.timeStamp=hQ.timeStamp;i.domEvent=hQ;if(hQ.type&&hQ.type.indexOf("wheel")>-1){i.wheelDelta=hQ.wheelDelta;i.detail=hQ.detail;i.deltaX=hQ.deltaX;i.deltaY=hQ.deltaY;i.deltaMode=hQ.deltaMode}i.offsetX=i.offsetPosMap.x;i.offsetY=i.offsetPosMap.y;i.layerX=hQ.layerX;i.layerY=hQ.layerY;return i}function dE(hQ,T){var hS=hQ.target;var hY=hQ.clientPos.x;var hX=hQ.clientPos.y;var hV=null;var hU=null;if(hS.nodeType!==1){hS=hS.parentNode}var hT=T.getContainer();var hR=hT;while(hR){hY-=hR.offsetLeft;hX-=hR.offsetTop;hR=hR.offsetParent}if(typeof window.scrollY==="number"){hX+=window.scrollY}if(typeof window.scrollX==="number"){hY+=window.scrollX}var i=T.getPanes();var e=null;while(hS&&hS!==hT){if(hS.hashCode){if(C.instance(hS.hashCode) instanceof cV){hV=C.instance(hS.hashCode)}if(C.instance(hS.hashCode) instanceof an||C.instance(hS.hashCode) instanceof hG){hU=C.instance(hS.hashCode)}}var hZ=hS.parentNode;if(hZ===i.floatPane||hZ===i.markerMouseTarget||hZ===i.floatShadow||hZ===i.labelPane||hZ===i.markerPane||hZ===i.mapPane){e=hS}hS=hZ}var hW=null;if(e&&!hV&&!hU){hW=e}return{x:hY,y:hX,overlay:hV,infoWindow:hU,customOverlayDom:hW,pixel:new ej(hY,hX),point:T.pixelToPointIn(new ej(hY,hX)),latlng:T.pixelToPoint(new ej(hY,hX))}}function gj(hR,hQ){var hS=hR.changedTouches[0];var i=hR.changedTouches.length;var T={target:hR.target,timeStamp:hR.timeStamp,ctrlKey:hR.ctrlKey||false,webkitForce:hR.webkitForce,metaKey:hR.metaKey||false,touchesCount:hR.touches.length,targetTouchesCount:hR.targetTouches.length};if(hR.changedTouches){T.changedTouchesCount=hR.changedTouches.length}else{T.changedTouchesCount=1}eJ(hS,T,hQ);if(i>1){T.secondTouchInfo={};C.extend(T.secondTouchInfo,T);eJ(hR.changedTouches[1],T.secondTouchInfo,hQ)}return T}function eJ(hS,hT,e){if(!hS){return}var hV=hS.clientX;var hU=hS.clientY;hT.id=hS.identifier||0;hT.clientPos={x:hV,y:hU};var hQ=0;var T=0;var i=e.container;while(i.offsetParent){hQ+=i.offsetLeft;T+=i.offsetTop;i=i.offsetParent}hT.offsetPos={x:hV-hQ,y:hU-T};hT.button=0;hT.offsetPosMap=new ej(hT.offsetPos.x,hT.offsetPos.y);var hR=dE(hT,e);C.extend(hT,hR)}function B(hU,hT){var i=hU.clientX;var hV=hU.clientY;if(typeof window.scrollY==="number"){hV+=window.scrollY}var hS={};hS.id=0;hS.clientPos={x:i,y:hV};hS.target=hU.target;var hQ=0;var T=0;var hR=hT.container;while(hR.offsetParent){hQ+=hR.offsetLeft;T+=hR.offsetTop;hR=hR.offsetParent}hS.offsetPos={x:i-hQ,y:hV-T};hS.timeStamp=hU.timeStamp;hS.offsetPosMap=new ej(hS.offsetPos.x,hS.offsetPos.y);hS.scale=hU.scale;hS.rotation=hU.rotation;return hS}function hm(e){this._map=e;if(e._renderType==="webgl"){this._drag=new cd(e)}else{if(typeof g2==="undefined"){return}this._drag=new g2(e)}this._earthDrag=null;this._earthWheel=null;this._dragStarted=false;this._touchStarted=false;this._waitForSecondTouch=false;this._firstTouchInfo={};this._secondTouchInfo={};this._currentTouchCount=0;this._prevGestureScale=1;this._useGesture=!!((f4()&&window.GestureEvent)||(!window.TouchEvent&&window.GestureEvent));this._opButton=-1;this._rotationFix=0;this._pinchRotationThreshold=20;this._pinchZoomThreshold=0.2;this._gestureStatus={zoom:false,rotate:false,tilt:false,dragZoom:false};this._diffX=0;this._diffY=0;this._enableRightDrag=true;if(typeof navigator.userAgent==="string"&&navigator.userAgent.indexOf("QQBrowser")>0){this._enableRightDrag=false}this._lastWheelTime=new Date();this._isModernBrowser=e.config.isModernBrowser;if(e.getRenderType()==="webgl"){e.deepZoom=new ap(e)}else{if(this._isModernBrowser){e.deepZoom=new bE(e)}}this._stateMachine=new eN();this._init();this._bind();if(this._useGesture){this._bindGesture()}this._bindRightButton();this._bindMouseWheel();this._operationVelocity=0;this._lastDiffDistance=0;this._zoomVelocity=0;this._lastDiffZoom=0;this._rotationVelocity=0;this._initRotation=0;this._trackVelocityTimer=null;this._trackTimeStamp=0;this._lastDragPoint={x:0,y:0};this._penultimateDragPoint={x:0,y:0};this._touchInMap=false}hm.prototype._init=function(){this._supportPointerEvent=(window.PointerEvent||window.MSPointerEvent)&&(navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0);var e={mousedown:"mousedown",mousemove:"mousemove",mouseup:"mouseup"};if(this._supportPointerEvent){if(window.PointerEvent){e.mousedown="pointerdown";e.mousemove="pointermove";e.mouseup="pointerup"}else{if(window.MSPointerEvent){e.mousedown="MSPointerDown";e.mousemove="MSPointerMove";e.mouseup="MSPointerUp"}}}this._eventMapping=e};hm.prototype._bind=function(){var hR=this._map;var T=hR.temp;var i=this._eventMapping;var hQ=this;var e=hR.platform;C.on(e,i.mousedown,function(hT){if(f4()){return}hQ._mousedown=true;var hS=aH(hT,hR);hQ._mouseButton=hT.button;hR.dispatchEvent(C.extend(new bb("onmousedown"),hS));hQ._processMouseDown(hS)});C.on(e,"touchstart",function(hT){if(hQ._mousedown===true){return}hQ._touchStarted=true;var hS=gj(hT,hR);hQ._processMouseDown(hS);hQ._touchInMap=true;if(!hS.customOverlayDom){hT.preventDefault()}});C.on(document,i.mousemove,function(hT){if(hQ._touchStarted){return}var hS=aH(hT,hR);hS.button=hQ._mouseButton;if(hR.currentOperation===dU.idle){hR.dispatchEvent(C.extend(new bb("onmousemove"),hS))}hQ._processMouseMove(hS)});C.on(document,"touchmove",function(hS){if(!hQ._touchInMap){return}hQ._processMouseMove(gj(hS,hR));hS.preventDefault});C.on(document,i.mouseup,function(hS){if(hQ._touchStarted){return}hQ._mousedown=false;hQ._processMouseUp(aH(hS,hR))});C.on(document,"touchend",function(hW){if(!hQ._touchInMap){return}if(!hQ._firstTouchInfo||!hQ._firstTouchInfo.offsetPos){hQ._processMouseUp(aH(hW,hR));return}if(hW.targetTouches.length===0){var hU=Math.abs(hQ._diffX)>5||Math.abs(hQ._diffY)>5;hQ._touchStarted=false;if(!hQ._twoFingerTouched&&!hU){var hS=new bb("onclick");C.extend(hS,hQ._firstTouchInfo);hS.icon=hR.getIconByClickPosition(hQ._firstTouchInfo.offsetPos);hR.dispatchEvent(hS);if(hQ._waitForSecondTouch===false){hQ._waitForSecondTouch=true;hQ._firstTouchPos={x:hQ._firstTouchInfo.offsetPos.x,y:hQ._firstTouchInfo.offsetPos.y};hQ._doubleTouchTimer=setTimeout(function hT(){hQ._waitForSecondTouch=false;hQ._doubleTouchTimer=null},hR.config.clickInterval)}else{if(Math.abs(hQ._firstTouchInfo.offsetPos.x-hQ._firstTouchPos.x)<20&&Math.abs(hQ._firstTouchInfo.offsetPos.y-hQ._firstTouchPos.y)<20){var hV=new bb("ondblclick");C.extend(hV,hQ._firstTouchInfo);hR.dispatchEvent(hV)}hQ._waitForSecondTouch=false;clearTimeout(hQ._doubleTouchTimer);hQ._doubleTouchTimer=null}}hQ._twoFingerTouched=false;hQ._touchInMap=false}hQ._processMouseUp(gj(hW,hR))});C.on(e,"click",function(hV){if(window.TouchEvent&&f4()){return}if(hR.getLock()===true){return}if(hR.currentOperation===dU.idle){var hU=hQ._diffX===0&&hQ._diffY===0;var hT=aH(hV,hR);if(hU){var hS=new bb("onclick");C.extend(hS,hT);hS.icon=hR.getIconByClickPosition(hS.offsetPosMap);hR.dispatchEvent(hS)}if(!T._clickTimer){T._clickTimer=setTimeout(function(){T._clickTimer=null;if(hU){var hW=new bb("onclickex");C.extend(hW,hT);hR.dispatchEvent(hW)}},hR.config.clickInterval)}}hQ._diffX=0;hQ._diffY=0});hR.container.onselectstart=function(){return false};C.on(hR.container,"contextmenu",function(hS){hS.cancelBubble=true;bU(hS)});C.on(e,"dblclick",function(hS){if(hR.getLock()===true){return}if(hR.currentOperation===dU.idle){if(C.Browser.ie){hR.dispatchEvent(C.extend(new bb("onclick"),aH(hS,hR)))}if(T._clickTimer){clearTimeout(T._clickTimer);T._clickTimer=null}hR.dispatchEvent(C.extend(new bb("ondblclick"),aH(hS,hR)))}});C.on(document,"mousedown",function(hT){hT=window.event||hT;var hS=hT.srcElement||hT.target;if(T.canKeyboard){T.canKeyboard=hR.container.contains(hS)}else{T.canKeyboard=e.contains(hS)}});C.on(e,"webkitmouseforcedown",function(hS){hR.dispatchEvent(C.extend(new bb("onforcedown"),aH(hS,hR)))});C.on(e,"webkitmouseforceup",function(hS){hR.dispatchEvent(C.extend(new bb("onforceup"),aH(hS,hR)))})};hm.prototype._bindGesture=function(){var e=this;var i=this._map;C.on(i.platform,"gesturestart",function(hQ){i.currentOperation=e._stateMachine.takeAction("gesturestart");var T=B(hQ,i);e._gestureStartTime=T.timeStamp;if(T.rotation<-160){e._rotationFix=180}else{if(T.rotation>160){e._rotationFix=-180}else{e._rotationFix=0}}e._pinchStartPosition=T.offsetPosMap;e._getCurrentDrag().onReadyToPinch(hQ,{initMiddlePoint:T.offsetPosMap,pinchStartPosition:e._pinchStartPosition,zoomRatio:1});hQ.preventDefault()});C.on(document,"gesturechange",function(hS){if(i.currentOperation!==dU.readyToPinch&&i.currentOperation!==dU.pinching){return}i.currentOperation=e._stateMachine.takeAction("gesturechange");if(i.currentOperation!==dU.pinching){return}var hR=B(hS,i);if(isNaN(hR.scale)){hR.scale=e._prevGestureScale}else{e._prevGestureScale=hR.scale}hR.rotation+=e._rotationFix;var T=hR.offsetPosMap;e._pinchingPosition=T;e._diffX=T.x-e._pinchStartPosition.x;e._diffY=T.y-e._pinchStartPosition.y;var hQ=e._getPinchParam(hR);if(!hQ){hS.preventDefault();return}e._getCurrentDrag().onPinching(hS,{pinchStartPosition:e._pinchStartPosition,pinchingPosition:T,pinchingDistance:hQ.pinchingDistance,zoomRatio:hQ.zoomRatio,angleDiff:hQ.rotation,gestureStatus:e._gestureStatus});hS.preventDefault()});C.on(document,"gestureend",function(hR){if(i.currentOperation!==dU.readyToPinch&&i.currentOperation!==dU.pinching){return}var hQ=B(hR,i);if(isNaN(hQ.scale)){hQ.scale=e._prevGestureScale}else{e._prevGestureScale=hQ.scale}var T=e._pinchParam||{};e._getCurrentDrag().onPinchEnd(hR,{pinchStartPosition:e._pinchStartPosition,pinchEndPosition:e._pinchingPosition,zoomRatio:T.zoomRatio,angleDiff:T.rotation,gestureStatus:e._gestureStatus});e._resetGestureParam();i.currentOperation=e._stateMachine.takeAction("gestureend");hR.preventDefault()})};hm.prototype._getPinchParam=function(hQ){var hV=hQ.scale;var hX=hQ.rotation;var hR=hQ.offsetPosMap;var hU=hR.x-this._pinchStartPosition.x;var hS=hR.y-this._pinchStartPosition.y;var T={x:hU,y:hS};var hW=hQ.timeStamp-this._gestureStartTime;if(hW<100){return null}var i=this._gestureStatus;if(!this._gestureDetected){this._gestureDetected=true;if(Math.abs(hU)<10&&Math.abs(hS)>10&&Math.abs(hV-1)<0.1&&hX<10){i.tilt=true}}var hT=0;if(!i.tilt&&!i.rotate){if(Math.abs(hX)>this._pinchRotationThreshold){this._initRotation=hX;if(hX>0){hT=hX-this._pinchRotationThreshold}else{hT=hX+this._pinchRotationThreshold}i.rotate=true}else{hX=0}}if(i.rotate&&this._initRotation){hT+=hX-this._initRotation}var e=hV;if(i.tilt){e=1}this._pinchParam={zoomRatio:e,rotation:hT,pinchingDistance:T};return this._pinchParam};hm.prototype._resetGestureParam=function(){this._initRotation=0;this._gestureStatus.zoom=false;this._gestureStatus.rotate=false;this._gestureStatus.tilt=false;this._gestureStatus.dragZoom=false;this._gestureDetected=false;this._pinchParam=null;this._gestureStartTime=null};hm.prototype._bindRightButton=function(){var i=this._map;var e=this;C.on(i.container,this._eventMapping.mouseup,function(T){if(i.mapType===BMAP_EARTH_MAP){return}if(i.getLock()===true){return}if(i.currentOperation!==dU.readyToDrag){if(i.currentOperation===dU.dragging&&e._diffX===0&&e._diffY===0){}else{return}}if(T.button===2){e._processRightClick(aH(T,i))}})};hm.prototype._processMouseDown=function(hV){var i=this._map;if(hV.overlay&&hV.overlay instanceof dr&&hV.overlay._config.enableDraggingMap===false&&!f4()){if(i.currentOperation===dU.idle){this._clearStatus();this._firstTouchInfo=hV;this._firstTouchInfo.initX=hV.offsetPosMap.x;this._firstTouchInfo.initY=hV.offsetPosMap.y;return}}if(i.currentOperation!==dU.idle&&hV.button!==this._opButton){return}if(hV.button===2&&this._currentTouchCount===1){return}if(i.getLock()){return}if(this._currentTouchCount===2){return}this._currentTouchCount++;if(this._currentTouchCount===2){this._twoFingerTouched=true}if(this._lastTouchstartTime&&f4()){var hR=hV.timeStamp-this._lastTouchstartTime;if(hR<200){this._gestureStatus.dragZoom=true}}this._lastTouchstartTime=hV.timeStamp;i.currentOperation=this._stateMachine.takeAction("mousedown",hV.id);if(hV.secondTouchInfo){this._currentTouchCount++;i.currentOperation=this._stateMachine.takeAction("mousedown",hV.secondTouchInfo.id)}if(i.currentOperation===dU.readyToDrag){if(C.Browser.ie||(C.Browser.firefox&&hV.target.setCapture)){hV.target.setCapture()}var hS=this._firstTouchInfo;C.extend(hS,hV);hS.initX=hV.offsetPosMap.x;hS.initY=hV.offsetPosMap.y;this._opButton=hV.button;if(hV.button===2&&this._enableRightDrag===false){i.currentOperation=dU.idle;this._stateMachine.reset();return}this._getCurrentDrag().onReadyToDrag(hV)}else{if(i.currentOperation===dU.readyToPinch){if(hV.secondTouchInfo){C.extend(this._firstTouchInfo,hV);this._firstTouchInfo.initX=hV.offsetPosMap.x;this._firstTouchInfo.initY=hV.offsetPosMap.y;C.extend(this._secondTouchInfo,hV.secondTouchInfo);this._secondTouchInfo.initX=hV.secondTouchInfo.offsetPosMap.x;this._secondTouchInfo.initY=hV.secondTouchInfo.offsetPosMap.y;this._opButton=hV.button}else{C.extend(this._secondTouchInfo,hV);this._secondTouchInfo.initX=hV.offsetPosMap.x;this._secondTouchInfo.initY=hV.offsetPosMap.y}if(this._useGesture){return}this._initTouchDistance=gV(this._firstTouchInfo.offsetPosMap,this._secondTouchInfo.offsetPosMap);this._initMiddlePoint=c1(this._firstTouchInfo.offsetPosMap,this._secondTouchInfo.offsetPosMap);var hQ=this._firstTouchInfo.initX-this._initMiddlePoint.x;var hX=this._initMiddlePoint.y-this._firstTouchInfo.initY;var T=this._secondTouchInfo.initX-this._initMiddlePoint.x;var hW=this._initMiddlePoint.y-this._secondTouchInfo.initY;var hT;if(hQ-T!==0){var hU=(hW-hX)/(T-hQ);hT=de(Math.atan(hU))}else{hT=90}if(hT<0){hT=180+hT}this._initAngle=hT;this._preAngle=hT;this._pinchStartPosition=this._initMiddlePoint;this._getCurrentDrag().onReadyToPinch(hV,{initMiddlePoint:this._initMiddlePoint,pinchStartPosition:this._pinchStartPosition,zoomRatio:1})}}};hm.prototype._processMouseMove=function(hS){var i=this._map;if(i.currentOperation===dU.idle){return}if(hS.id===this._firstTouchInfo.id){C.extend(this._firstTouchInfo,hS)}else{if(hS.id===this._secondTouchInfo.id){C.extend(this._secondTouchInfo,hS)}}if(hS.secondTouchInfo){if(hS.secondTouchInfo.id===this._firstTouchInfo.id){C.extend(this._firstTouchInfo,hS.secondTouchInfo)}else{if(hS.secondTouchInfo.id===this._secondTouchInfo.id){C.extend(this._secondTouchInfo,hS.secondTouchInfo)}}}i.currentOperation=this._stateMachine.takeAction("mousemove",hS.id);if(i.currentOperation===dU.pinching){if(this._useGesture){return}if(!this._gestureStartTime){this._gestureStartTime=hS.timeStamp}var hW=gV(this._firstTouchInfo.offsetPosMap,this._secondTouchInfo.offsetPosMap);var hV=c1(this._firstTouchInfo.offsetPosMap,this._secondTouchInfo.offsetPosMap);this._pinchingPosition=hV;this._diffX=hV.x-this._initMiddlePoint.x;this._diffY=hV.y-this._initMiddlePoint.y;var hT={scale:Math.round(hW/this._initTouchDistance*100)/100,rotation:this._calcRotationDiff(hV),offsetPosMap:hV,timeStamp:hS.timeStamp};this._pinchingPosition=hV;var T=this._getPinchParam(hT);if(T){this._zoomRatio=T.zoomRatio;this._getCurrentDrag().onPinching(hS,{initMiddlePoint:this._initMiddlePoint,pinchStartPosition:this._pinchStartPosition,pinchingPosition:hV,pinchingDistance:T.pinchingDistance,zoomRatio:T.zoomRatio,angleDiff:T.rotation,gestureStatus:this._gestureStatus})}}else{if(i.currentOperation===dU.dragging){var hR=this._getCurrentDrag();if(this._dragStarted===false){hR.onDragStart&&hR.onDragStart(hS);this._dragStarted=true}if(hS.id===this._firstTouchInfo.id){this._diffX=hS.offsetPosMap.x-this._firstTouchInfo.initX;this._diffY=hS.offsetPosMap.y-this._firstTouchInfo.initY}else{if(hS.secondTouchInfo&&hS.secondTouchInfo.id===this._firstTouchInfo.id){this._diffX=hS.secondTouchInfo.offsetPosMap.x-this._firstTouchInfo.initX;this._diffY=hS.secondTouchInfo.offsetPosMap.y-this._firstTouchInfo.initY}}this._lastDragPoint=hS.pixel;var hQ;if(this._lastDragPoint.x===this._penultimateDragPoint.x&&this._lastDragPoint.y===this._penultimateDragPoint.y){hQ={x:this._diffX,y:this._diffY}}else{hQ={x:this._lastDragPoint.x-this._penultimateDragPoint.x,y:this._lastDragPoint.y-this._penultimateDragPoint.y}}if(!i.config.enableDragging){return}hR.onDragging(hS,{diffX:this._diffX,diffY:this._diffY,velocity:this._operationVelocity,button:this._opButton,dragDistance:{x:this._diffX,y:this._diffY},gestureStatus:this._gestureStatus,dir:hQ});if(!this._trackVelocityTimer){var hU=this;this._trackTimeStamp=(new Date()).getTime();this._trackVelocityTimer=setInterval(function(){hU._trackVelocity();hU._penultimateDragPoint=hU._lastDragPoint},30)}}}};hm.prototype._calcRotationDiff=function(hV){var i=this._firstTouchInfo.offsetPosMap.x-hV.x;var hU=hV.y-this._firstTouchInfo.offsetPosMap.y;var e=this._secondTouchInfo.offsetPosMap.x-hV.x;var hT=hV.y-this._secondTouchInfo.offsetPosMap.y;var hQ;if(i-e!==0){var hR=(hT-hU)/(e-i);hQ=de(Math.atan(hR))}else{hQ=90}if(hQ<0){hQ=180+hQ}var T=hQ;while(this._preAngle-hQ>100){hQ=hQ+180}while(this._preAngle-hQ<-100){hQ=hQ-180}var hS=this._initAngle-hQ;this._preAngle=hQ;return hS};hm.prototype._processMouseUp=function(hR){var hQ=this._map;if(hQ.currentOperation===dU.idle){return}if(hR.button!==this._opButton){return}this._currentTouchCount--;if(hQ.currentOperation===dU.readyToDrag||hQ.currentOperation===dU.dragging){if(this._trackVelocityTimer){clearInterval(this._trackVelocityTimer);this._trackVelocityTimer=null}this._dragStarted=false;var i;if(this._lastDragPoint.x===this._penultimateDragPoint.x&&this._lastDragPoint.y===this._penultimateDragPoint.y){i={x:this._diffX,y:this._diffY}}else{i={x:this._lastDragPoint.x-this._penultimateDragPoint.x,y:this._lastDragPoint.y-this._penultimateDragPoint.y}}this._getCurrentDrag().onDragEnd(hR,{velocity:this._operationVelocity,dragDistance:{x:this._diffX,y:this._diffY},gestureStatus:this._gestureStatus,dir:i});this._clearStatus(hR);this._resetGestureParam();if(C.Browser.ie||(C.Browser.firefox&&hR.target.releaseCapture)){hR.target.releaseCapture()}this._opButton=-1}else{if(hQ.currentOperation===dU.pinching){if(!this._useGesture){var T=this._pinchParam;if(T){this._getCurrentDrag().onPinchEnd(hR,{pinchStartPosition:this._pinchStartPosition,pinchEndPosition:this._pinchingPosition,zoomRatio:T.zoomRatio,angleDiff:T.rotation,gestureStatus:this._gestureStatus})}this._resetGestureParam()}this._clearId(hR.id)}else{if(hQ.currentOperation===dU.freeze){if(this._currentTouchCount===0){this._clearStatus(hR)}else{if(hR.id===this._firstTouchInfo.id||hR.id===this._secondTouchInfo.id){if(!this._useGesture){var T=this._pinchParam;if(T){this._getCurrentDrag().onPinchEnd(hR,{pinchStartPosition:this._pinchStartPosition,pinchEndPosition:this._pinchingPosition,zoomRatio:T.zoomRatio,angleDiff:T.rotation,gestureStatus:this._gestureStatus})}this._resetGestureParam()}this._clearId(hR.id)}}}}}hQ.currentOperation=this._stateMachine.takeAction("mouseup",hR.id);if(hR.changedTouchesCount===2||hR.targetTouchesCount===0){hR.changedTouchesCount=1;this._processMouseUp(hR)}if(this._currentTouchCount===0&&f4()){this._diffX=this._diffY=0}};hm.prototype._clearId=function(e){if(e===this._firstTouchInfo.id){this._firstTouchInfo={}}else{if(e===this._secondTouchInfo.id){this._secondTouchInfo={}}}};hm.prototype._clearStatus=function(){this._firstTouchInfo={};this._secondTouchInfo={}};hm.prototype._processRightClick=function(hR){var hQ=this._map;var T=hQ.temp;if(T.rightDblclickTimer){clearTimeout(T.rightDblclickTimer);T.rightDblclickTimer=null;hQ.dispatchEvent(C.extend(new bb("onrightclick"),hR));hQ.dispatchEvent(C.extend(new bb("onrightdblclick"),hR))}else{hQ.dispatchEvent(C.extend(new bb("onrightclick"),hR));var i=C.extend(new bb("onrightclickex"),hR);T.rightDblclickTimer=setTimeout(function(){T.rightDblclickTimer=null;hQ.dispatchEvent(i)},hQ.config.clickInterval)}};hm.prototype._bindMouseWheel=function(){var hQ=this._map;var T=this;if(!C.Browser.firefox){C.on(hQ.container,"mousewheel",function i(hR){if(hQ.getLock()===true){return}if(!hQ.config.enableWheelZoom){return}if(hQ.mapType!==BMAP_EARTH_MAP){if(T._isModernBrowser){T._deepZoomWheel(hR)}else{T._wheel(hR)}}else{if(T._earthWheel){T._earthWheel.onWheel(aH(hR,hQ))}}bU(hR)})}else{C.on(hQ.container,"wheel",function e(hR){if(hQ.getLock()===true){return}if(!hQ.config.enableWheelZoom){return}if(hQ.mapType!==BMAP_EARTH_MAP){if(T._isModernBrowser){T._deepZoomWheel(hR)}else{T._wheel(hR)}}else{if(T._earthWheel){T._earthWheel.onWheel(aH(hR,hQ))}}bU(hR)})}};hm.prototype._getCurrentDrag=function(){var e=this._map;if(e.getMapType()!==BMAP_EARTH_MAP){return this._drag}return this._earthDrag};hm.prototype._wheel=function(hT){var hS=this._map;var hQ=this._map.temp;if(hQ.dragAni){hQ.dragAni.stop();hQ.dragAni=null;setTimeout(function(){hS.dispatchEvent(new bb("onmoveend"))},1)}if(hQ.touchZoomLabelCanvas){hQ.touchZoomLabelCanvas.style.display="none"}if(hQ.touchZoomDiv){hQ.touchZoomDiv.style.display="none"}hT=window.event||hT;hS.lastLevel=hS.zoomLevel;var T=new bb("onmousewheel");T.trend=hT.wheelDelta>=0;if(isNaN(hT.wheelDelta)){T.trend=hT.deltaY<=0}var i=new Date();if(T.trend===true&&hS.zoomLevel===hS.getMaxZoom()||T.trend===false&&hS.zoomLevel===hS.getMinZoom()||i-this._lastWheelTime<220){hS.currentOperation^=dU.mousewheel;if(T.trend===true&&hS.zoomLevel===hS.getMaxZoom()||T.trend===false&&hS.zoomLevel===hS.getMinZoom()){var hR=new bb("onzoomexceeded");if(hS.zoomLevel===hS.getMaxZoom()){hR.targetZoom=hS.zoomLevel+1}else{hR.targetZoom=hS.zoomLevel-1}hS.dispatchEvent(hR)}bU(hT);return}this._astWheelTime=i;C.extend(T,aH(hT,hS));hS.dispatchEvent(T)};hm.prototype._deepZoomWheel=function(hQ){var T=this._map;var i=new bb("ondeepzoommousewheel");C.extend(i,aH(hQ,T));T.dispatchEvent(i)};hm.prototype.setEarthDrag=function(e){this._earthDrag=e};hm.prototype.setEarthWheel=function(e){this._earthWheel=e};hm.prototype._trackVelocity=function(){var T=(new Date()).getTime();var e=T-this._trackTimeStamp;if(e===0){return}this._trackTimeStamp=T;var hQ=Math.sqrt(Math.pow(this._diffX,2)+Math.pow(this._diffY,2));var hR=Math.abs(hQ-this._lastDiffDistance);this._lastDiffDistance=hQ;var i=500*hR/e;this._operationVelocity=(0.6*i+0.4*this._operationVelocity)};function ap(e){this._map=e;this.scrollCount=0;this.maxZoomWheelDir=1;this.minZoomWheelDir=-1;this.maxZoom=e.getMaxZoom();this.minZoom=e.getMinZoom();this.lastWheelTime=0;this._opMethod="";this.lastWheelDelta=0;this.lastDiff=0;this._mouseFixPoint=null;this.bindEvent()}var gH=ap.prototype;gH.bindEvent=function(){var e=this;var i=e._map;i.addEventListener("maptypechange",function(T){e.maxZoom=i.getMaxZoom();e.minZoom=i.getMinZoom()});i.addEventListener("deepzoommousewheel",function(T){e.wheel(T)})};gH.wheel=function(hS){var hU=this;var i=hU._map;var h1=i.temp;if(h1.dragAni){h1.dragAni.stop(false,{readyToMove:true});h1.dragAni=null}var hQ=Math.floor(hS.timeStamp);var T=hQ-this.lastWheelTime;var hR=this._trend=hS.deltaY<=0;if(isNaN(hS.deltaY)){hR=this._trend=hS.wheelDelta>=0}var h0=Math.abs(hS.deltaY);var hY=Math.abs(hS.wheelDelta);var hX=h0;if(hY===0&&hX===0){return}var hW=false;if(this._opMethod==="mouseWheel"&&typeof this._preTrend==="boolean"&&this._preTrend!==this._trend){hW=true}if(T>100||hW===true){this._opMethod=bL(hY,hX,hS.deltaMode);if(this._opMethod==="mouseWheel"){if(h1.wheelAni){h1.wheelAni.stop();h1.wheelAni=null}if(this._wheelMotionTimer){clearTimeout(this._wheelMotionTimer);this._wheelMotionTimer=null}}this._mouseFixPoint=hS.point.clone();this.scrollCount=0;this.startZoom=i.getZoom();i.fire(new bb("onmousewheelscroll"));if((this.startZoom===this.maxZoom&&hR===true)||(this.startZoom===this.minZoom&&hR===false)){var hZ=new bb("onzoomexceeded");hZ.targetZoom=this.startZoom;i.dispatchEvent(hZ);return}}this.lastWheelTime=hQ;var hV=this._mouseFixPoint;if(this._opMethod==="mouseWheel"&&hX!==0){var hT=hY?(hY/3):hX;this._onWheelMouse(hT,hR,hV,hS.deltaMode);return}if(this._opMethod==="padScroll"){h0=hX/50}else{h0=hX/20}if(isNaN(h0)&&hS.detail){h0=Math.abs(hS.detail)}var hU=this;setTimeout(function(){var h2=i.getZoom();var e=hR===true?h2+0.2*h0:h2-0.2*h0;i.setZoomIn(e,{zoomCenter:hV,stopCurrentAnimation:true,noAnimation:true})},20)};gH._onWheelMouse=function(i,hQ,hS,T){var hT=this._map;this.scrollCount++;if(this.scrollCount>10){this.scrollCount=10}var hR=0;if(C.Browser.firefox){if(T===1){i*=15}if(!C.Platform.macintosh){hR=dO(i*0.005,2)*this.scrollCount}else{if(i%1!==0){i*=10}hR=dO(i*0.01,2)}}else{if(!C.Platform.macintosh){hR=dO(i*0.005,2)*this.scrollCount}else{hR=dO(i*0.005,2)}}if(hR>2){hR=2}if(hQ===false){hR=-hR}var e=hT.getZoom()+hR;hT.setZoomIn(e,{zoomCenter:hS,fromMouseWheel:true});this._preTrend=this._trend};function cd(e){this._map=e;this._opButton=0;this._initTilt=0;this._initHeading=0;this._mapHeight=0;this._changeHeadingStartPos=null}C.extend(cd.prototype,{onReadyToDrag:function(hR,i){var hQ=this._map;var T=hQ.temp;if(T.dragAni){T.dragAni.stop(false,{readyToMove:true});T.dragAni=null}if(hQ._ani){hQ._ani.stop();hQ._ani=null}if(hQ._infiniteAni){hQ._infiniteAni.stop();hQ._infiniteAni=null}if(T.tlPan){T.tlPan.stop();T.tlPan=null}if(!hQ.config.enableDragging){return}if(hR.button===0&&hR.ctrlKey===false&&hR.metaKey===false){this._opButton="left";T.pl=hQ.offsetX;T.pt=hQ.offsetY}else{this._opButton="right";this._initTilt=hQ.getTilt();this._initHeading=hQ.getHeading();this._mapHeight=hQ.getSize().height}if(T.curSpotsArray.length===0&&T.curAreaSpot===null){hQ.platform.style.cursor=hQ.config.draggingCursor}else{hQ.platform.style.cursor="pointer"}},onReadyToPinch:function(hQ,i){var T=this._map;if(T.config.fixCenterWhenPinch){this._fixPoint=T.getCenterIn().clone()}else{this._fixPoint=T.pixelToPointIn(i.pinchStartPosition)}this._fixPixel=T.pointToPixelIn(this._fixPoint);this._startZoom=T.getZoom();this._startHeading=T.getHeading();this._startTilt=T.getTilt()},onDragStart:function(){var e=this._map;if(!e.config.enableDragging){return}e.platform.style.cursor=e.config.draggingCursor;this._startZoom=e.getZoom()},onDragging:function(hU,i){var hQ=this._map;if(!hQ.config.enableDragging){return}var hZ=hQ.temp;if(this._opButton==="right"&&hQ.getZoom()<hQ._enableTiltZoom){return}var hX=i.diffX;var hW=i.diffY;var hS=false;var hY=i.gestureStatus.dragZoom;if(Math.abs(hX)>1||Math.abs(hW)>1){hS=true;if(!hZ._moved){if(!hY){hQ.dispatchEvent(C.extend(new bb("ondragstart"),hU));hQ.dispatchEvent(new bb("onmovestart"))}hZ._moved=true}}if(hS===false){return}hQ.dispatchEvent(C.extend(new bb("ondragging"),hU));hZ.lastDomMoveTime=hU.timeStamp;if(hY){hQ.setZoomIn(this._startZoom-hW/50,{noAnimation:true})}else{if(this._opButton==="left"){hQ._setPlatformPosition(hX,hW,{initMapOffsetX:hZ.pl,initMapOffsetY:hZ.pt})}else{var hV=20;var hT={noAnimation:true};if(Math.abs(hW)>hV){if(!this._rightDragInitY){this._rightDragInitY=hU.pixel.y}}if(this._rightDragInitY){if(!hQ.config.enableTilt){return}var T=hU.pixel.y-this._rightDragInitY;this._setTiltByMoveY(this._initTilt,T,hT)}if(Math.abs(hX)>hV){if(!this._rightDragInitX){this._rightDragInitX=hU.pixel.x}}if(this._rightDragInitX){if(!hQ.config.enableRotate){return}var hR=hU.pixel.x-this._rightDragInitX;if(this._changeHeadingStartPos===null){this._changeHeadingStartPos=hU.pixel}if(this._changeHeadingStartPos.y<this._mapHeight/2){hQ.setHeading(this._initHeading+hR*0.3,hT)}else{hQ.setHeading(this._initHeading-hR*0.3,hT)}}}}},_setTiltByMoveY:function(T,hS,e){var hR=this._map;var i=T+hS*0.4;var hQ=hR.getCurrentMaxTilt();i=cE(i,c8.MIN_TILT,hQ,0.4);hR.setTilt(i,e)},onPinching:function(hS,i){var hR=this._map;if(hR.config.enableTiltGestures&&i.gestureStatus.tilt){this._setTiltByMoveY(this._startTilt,i.pinchingDistance.y,{noAnimation:true});return}var hQ=Math.log(i.zoomRatio)/Math.log(2);var T=Math.max(Math.min(this._startZoom+hQ,hR.getMaxZoom()),hR.getMinZoom());if(hR.config.enableRotateGestures&&typeof i.angleDiff==="number"){hR.setHeading(this._startHeading+i.angleDiff,{noAnimation:true})}hR.setZoomIn(T,{zoomCenter:this._fixPoint,noAnimation:true,fixPixel:this._fixPixel})},onDragEnd:function(hR,i){var hQ=this._map;if(!hQ.config.enableDragging){return}var T=hQ.temp;if(T.curSpotsArray.length===0&&T.curAreaSpot===null){hQ.platform.style.cursor=hQ.config.defaultCursor}else{hQ.platform.style.cursor="pointer"}if(T._moved&&!i.gestureStatus.dragZoom){hQ.dispatchEvent(C.extend(new bb("ondragend"),hR));if(!hQ.config.enableInertialDragging||hR.timeStamp-T.lastDomMoveTime>100){hQ.dispatchEvent(new bb("onmoveend"))}else{this._processMotion(i.velocity,i.dragDistance,i.dir)}T._moved=false}this._changeHeadingStartPos=null;this._rightDragInitX=this._rightDragInitY=null;if(this._opButton==="right"){this._tiltBounceBack()}},_tiltBounceBack:function(){var i=this._map;if(i.getZoom()<i._enableTiltZoom){return}var e=i.getCurrentMaxTilt();if(i.getTilt()>e){i.setTilt(e,{duration:200})}else{if(i.getTilt()<c8.MIN_TILT){i.setTilt(c8.MIN_TILT,{duration:200})}}},onPinchEnd:function(hR,i){var hQ=this._map;if(i.gestureStatus.tilt){this._tiltBounceBack()}if(hQ.config.enableRotateGestures&&i.gestureStatus.rotate){var T=Math.abs(hQ.getHeading());if(T%360<10){hQ.resetHeading()}}},_processMotion:function(hR,h3,hV){var h1=this._map;var hU=h1.temp;var T=(new Date()).getTime();var i=0.5*hR;if(this._opButton==="right"){i=0.15*hR}var hZ=0;var hY=0;if(hV.y===0){hZ=i}else{var hQ=Math.abs(hV.x/hV.y);hY=Math.round(Math.sqrt(i*i/(1+hQ*hQ)));hZ=Math.round(hQ*hY)}var hX=dK(h1._heading);if(hV.x<0){hZ=-hZ}if(hV.y<0){hY=-hY}var hT=h3.x+hZ;var hS=h3.y+hY;if(hU.dragAni){hU.dragAni.stop();hU.dragAni=null;h1.dispatchEvent(new bb("onmoveend"))}var h4=0;var h2=0;if(this._opButton==="right"){if(!this._changeHeadingStartPos){return}var hW=this._mapHeight;var e=this._changeHeadingStartPos;var h0=this._initHeading;hU.dragAni=new o({duration:10000,render:function(h6){var h5=(new Date()).getTime()-T;var h7=Math.exp(-h5/250);h4=hT-hZ*h7;if(Math.abs(hZ*h7)<5&&Math.abs(hY*h7)<5){hU.dragAni.stop();return}if(e.y<hW/2){h1.setHeading(h0+h4*0.3,{noAnimation:true})}else{h1.setHeading(h0-h4*0.3,{noAnimation:true})}},finish:function(){hU.dragAni=null;if(e.y<hW/2){h1.setHeading(h0+h4*0.3,{noAnimation:true})}else{h1.setHeading(h0-h4*0.3,{noAnimation:true})}},onStop:function(){hU.dragAni=null;if(e.y<hW/2){h1.setHeading(h0+h4*0.3,{noAnimation:true})}else{h1.setHeading(h0-h4*0.3,{noAnimation:true})}}});return}hU.dragAni=new o({duration:10000,render:function(h7,h6){var h5=(new Date()).getTime()-T;var h8=Math.exp(-h5/250);h4=hT-hZ*h8;h2=hS-hY*h8;if(Math.abs(hZ*h8)<5&&Math.abs(hY*h8)<5){hU.dragAni.stop();return}h1._setPlatformPosition(h4,h2,{initMapOffsetX:hU.pl,initMapOffsetY:hU.pt})},finish:function(){hU.dragAni=null;h1._setPlatformPosition(h4,h2,{initMapOffsetX:hU.pl,initMapOffsetY:hU.pt});h1.dispatchEvent(new bb("onmoveend"))},onStop:function(h5){hU.dragAni=null;h1._setPlatformPosition(h4,h2,{initMapOffsetX:hU.pl,initMapOffsetY:hU.pt});var h6=new bb("onmoveend");h6.userData=h5;h1.dispatchEvent(h6)}})}});bo.register(function(i){var e=i;if(i._keyboardInit===true){return}i._keyboardInit=true;C.on(document,"keydown",function(T){if(e.temp.stopArrow===true){e.temp.stopArrow=false}if(e.config.enableKeyboard&&e.temp.canKeyboard){var T=window.event||T;var hQ=false;if(C.Platform.macintosh){if(T.metaKey===true){hQ=true}}else{if(T.ctrlKey===true){hQ=true}}switch(T.keyCode||T.which){case 189:case 109:case 173:if(!hQ){e.temp.operating=true;e.dispatchEvent(new bb("onminuspress"))}break;case 61:case 187:case 107:if(!hQ){e.temp.operating=true;e.dispatchEvent(new bb("onpluspress"))}break;case 33:e.temp.operating=false;e.temp.stopArrow=true;T.cancelBubble=true;T.returnValue=false;break;case 34:e.temp.operating=false;e.temp.stopArrow=true;T.cancelBubble=true;T.returnValue=false;break;case 35:e.temp.operating=false;e.temp.stopArrow=true;T.cancelBubble=true;T.returnValue=false;break;case 36:e.temp.operating=false;e.temp.stopArrow=true;T.cancelBubble=true;T.returnValue=false;break;case 37:if(e.mapType==="B_EARTH_MAP"){return}e.temp.operating=true;e.temp.arrow|=1;e._arrow();T.cancelBubble=true;T.returnValue=false;break;case 38:if(e.mapType==="B_EARTH_MAP"){return}e.temp.operating=true;e.temp.arrow|=2;e._arrow();T.cancelBubble=true;T.returnValue=false;break;case 39:if(e.mapType==="B_EARTH_MAP"){return}e.temp.operating=true;e.temp.arrow|=4;e._arrow();T.cancelBubble=true;T.returnValue=false;break;case 40:if(e.mapType==="B_EARTH_MAP"){return}e.temp.operating=true;e.temp.arrow|=8;e._arrow();T.cancelBubble=true;T.returnValue=false;break}}});C.on(document,"keyup",function(T){if(e.config.enableKeyboard){var T=window.event||T;switch(T.keyCode||T.which){case 37:e.temp.arrow=e.temp.arrow&~1;if(e.temp.arrow!==0){e._arrow()}break;case 38:e.temp.arrow=e.temp.arrow&~2;if(e.temp.arrow!==0){e._arrow()}break;case 39:e.temp.arrow=e.temp.arrow&~4;if(e.temp.arrow!==0){e._arrow()}break;case 40:e.temp.arrow=e.temp.arrow&~8;if(e.temp.arrow!==0){e._arrow()}break}}e.temp.operating=false});c8.prototype._arrow=function(){if(this.mapType===BMAP_EARTH_MAP){return}if(this._arrow.occurrent&&this._arrow._lastArrow===this.temp.arrow&&this.temp.stopArrow===true){return}var T=this;var hR=T.temp.arrow;T._arrow._lastArrow=hR;T._arrow.interval=30;T._arrow.duration=999;T._arrow.dx=T._arrow.dy=0;if(hR&1){T._arrow.dx=1}if(hR&2){T._arrow.dy=1}if(hR&4){T._arrow.dx=-1}if(hR&8){T._arrow.dy=-1}if(hR&1&&hR&4){T._arrow.dx=0}if(hR&2&&hR&8){T._arrow.dy=0}if(!T._arrow.occurrent){T._arrow.occurrent=true;T._arrow.time=new Date().getTime();T._arrow.beginTime=T._arrow.time;T.dispatchEvent(new bb("onmovestart"));var hQ=new o({fps:T._arrow.interval,duration:T._arrow.duration,transition:cn.linear,render:function(hY){var hT=T._arrow;var hW=T.temp.arrow;if(T._arrow._lastArrow!==hW){T._arrow._lastArrow=hW;if(hW&1){hT.dx=1}if(hW&2){hT.dy=1}if(hW&4){hT.dx=-1}if(hW&8){hT.dy=-1}if(hW&1&&hW&4){hT.dx=0}if(hW&2&&hW&8){hT.dy=0}}if(T.temp.stopArrow===true){hT.dx=0;hT.dy=0}var hX=new Date().getTime();var hV=Math.pow((hX-hT.beginTime)/hT.duration,2);if(!T.temp.arrow){hT.occurrent=false;hQ.terminative=true;T._arrow.time=new Date().getTime();setTimeout(function(){T.dispatchEvent(new bb("onmoveend"))},40)}var hZ=(hX-hT.time);var hU=hT.dx*hZ*hV>=0?Math.ceil(hT.dx*hZ*hV):Math.floor(hT.dx*hZ*hV);var hS=hT.dy*hZ*hV>=0?Math.ceil(hT.dy*hZ*hV):Math.floor(hT.dy*hZ*hV);if(hU!==0&&hS!==0){hU=Math.round(hU*0.7);hS=Math.round(hS*0.7)}hT.time=hX;T._setPlatformPosition(hU,hS)},finish:function(){T._arrow.time=new Date().getTime();setTimeout(function(){T._arrowPan()},T._arrow.interval)}})}};c8.prototype._arrowPan=function(){var hS=this;var hQ=hS._arrow;if(hS.temp.stopArrow){hQ.dx=0;hQ.dy=0}if(!hS.temp.arrow){hQ.occurrent=false;hS.dispatchEvent(new bb("onmoveend"));return}var hT=new Date().getTime();var hU=(hT-hQ.time);var hR=Math.ceil(hQ.dx*hU);var T=Math.ceil(hQ.dy*hU);hQ.time=hT;hS._setPlatformPosition(hR,T);setTimeout(function(){hS._arrowPan()},hQ.interval)}});');
﻿_jsload&&_jsload('scommon', 'var dP=1,dQ=2,fs=3,eE=new d9(21,33),bM=new d9(10,33),aX=new d9(22,36),gL=new d9(11,36),p=new d9(25,40),k=new d9(12,20),eW=new d9(9,0),gS=new d9(300,300);c3.addSearchPoi=function(i,hV,hT,hU){var hW=aw(hV);if(!hW){return}if(hT<0||hT>9){return}var hR=null;var hS=new aC(hW);var e=e3.staticHost+"/wolfman/static/common/images/";e+="markers_new2x_2960fb4.png";if(a6()>1){function hQ(){return new ha(e,eE,{imageSize:gS,anchor:bM,imageOffset:new d9(21*hT,0),infoWindowOffset:eW})}hR=hQ();var T=hQ();T.setImageOffset(new d9(21*hT,66));hS.icoDefault=hR;hS.icoActive=T}else{hR=new ha(e,eE,{imageSize:gS,anchor:bM,imageOffset:new d9(21*hT,0),infoWindowOffset:eW})}hS.setIcon(hR);i.addOverlay(hS);if(hU){hS.setTitle(hU)}return hS};c3.addCenterPoi=function(hR,e,hS){var hQ=aw(e);if(!hQ){return}var i=new aC(hQ);var hT=null;if(f4()){function T(){return new ha(e3.imgPath+"markers_hd.png",new d9(21,31),{anchor:bM,imageOffset:new d9(-29,-320),imageSize:new d9(85,477),infoWindowAnchor:eW})}hT=T();i.icoDefault=hT}else{hT=new ha(e3.imgPath+"markers.png",eE,{anchor:bM,imageOffset:new d9(0,-250),infoWindowAnchor:eW})}i.setIcon(hT);hR.addOverlay(i);if(hS){i.setTitle(hS)}return i};c3.addSearchInBoundsPoi=function(i,hU,hT){var hV=aw(hU);if(!hV){return}var hS=new aC(hV);var hR=null;var e=e3.staticHost+"/wolfman/static/common/images/";e+="markers_new2x_2960fb4.png";if(a6()>1){function hQ(){return new ha(e,aX,{imageSize:gS,anchor:gL,imageOffset:new d9(200,188),infoWindowOffset:eW})}hR=hQ();var T=hQ();T.setImageOffset(new d9(200,224));hS.icoDefault=hR;hS.icoActive=T}else{hR=new ha(e,aX,{imageSize:gS,anchor:gL,imageOffset:new d9(200,188),infoWindowOffset:eW})}hS.setIcon(hR);i.addOverlay(hS);if(hT){hS.setTitle(hT)}return hS};function aw(e){var T=[];var i=null;if(e instanceof hr||e instanceof c4){i=e}else{if(typeof e=="string"){T=C.trim(e).split(",");if(T.length<2){return}T[0]=parseFloat(C.trim(T[0]));T[1]=parseFloat(C.trim(T[1]))}else{T=e.slice(0);if(T.length<2){return}}i=new hr(T[0],T[1])}return i}c3.createSearchInfoWnd=function(T,e){var hZ=T.title;var hX=T.addr;var hS=T.tel;var hV=T.uid||"";var i=T.url;var hY=T.detailUrl;var hW=T.poiType||BMAP_POI_TYPE_NORMAL;e=e||{};if(!hZ){return null}var hU=hZ;if(hW==BMAP_POI_TYPE_BUSSTOP){hU=hU+"-公交车站"}else{if(hW==BMAP_POI_TYPE_SUBSTOP){hU=hU+"-地铁站"}}var hT=13;if(hY){hT=10}if(hU.replace(/[\\u0100-\\uffff]/g,"##").length>hT*2+1){hU=hU.substring(0,hT)+"&#8230"}var hR=\'<p style="margin-left:5px;display:inline;height:30px;line-height:30px;width:210px;font:bold 14px/16px \'+e3.fontFamily+\';white-space:nowrap;overflow:hidden" title="\'+hZ+\'">\'+hU;if(hY){hR+=\'<a target="_blank" href="\'+hY+\'" style="margin-left:5px;font-size:12px;color:#3d6dcc;font-weight:normal;text-decoration:none;">详情»</a>\'}hR+="</p>";var h1=[];h1.push(\'<div style="font: 12px \'+e3.fontFamily+\'; margin: 5px">\');if(hX){var h0="地址：";if(hW==BMAP_POI_TYPE_BUSSTOP||hW==BMAP_POI_TYPE_SUBSTOP){h0="车次："}h1.push(\'<table cellspacing="0" style="overflow: hidden; table-layout: fixed; width: 100 %; font: 12px \'+e3.fontFamily+\'" >\');h1.push(\'<tr><td style="vertical-align: top; width: 38px; white-space: nowrap; word-break: keep-all">\'+h0+"&nbsp;</td><td>");h1.push(hX+"&nbsp;</td></tr>");if(hS){h1.push(\'<tr><td style="vertical-align: top; ">电话：</td><td>\'+hS+"</td></tr>")}h1.push("</table>")}else{if(hS){h1.push(\'<table cellspacing="0" style="table-layout: fixed; width: 100 %; font: 12px \'+e3.fontFamily+\'">\');h1.push(\'<tr><td style="vertical-align: top; width: 36px; white-space: nowrap; word-break: keep-all">电话：</td><td>\'+hS+"</td></tr></table>")}}h1.push("</div>");var hQ=new an(h1.join(""),{title:hR,height:0,width:250,margin:[10,10,20,10]});return hQ};c3.addDestPoi=function(hT,e,hU,T){var hQ=e3.staticHost+"/wolfman/static/common/images/";hQ+="markers_new2x_2960fb4.png";var hS=aw(e);if(!hS){return}var hR=new ha(hQ,p,{imageSize:gS,anchor:k,imageOffset:new d9(200+T*25,139),infoWindowOffset:eW});var i=new aC(hS,{icon:hR,baseZIndex:3500000,draggingCursor:"pointer"});hT.addOverlay(i);if(hU){i.setTitle(hU)}return i};c3.addLine=function(i,e){return c3.addRoute(i,e,fW)};c3.ROUTE_TRAFFIC_STYLE_CONFIG=[{stroke:6,color:"#0030ff",opacity:0.45,style:"solid"},{stroke:5,color:"#00bd00",opacity:0.95,style:"solid"},{stroke:5,color:"#ffac00",opacity:0.95,style:"solid"},{stroke:5,color:"#f41c0d",opacity:0.95,style:"solid"}];c3.ROUTE_STYLE_CONFIG=[{stroke:6,color:"#5298fe",opacity:1,style:"solid"},{stroke:6,color:"#5298fe",opacity:1,style:"solid"},{stroke:6,color:"#4ddc26",opacity:1,style:"solid"},{stroke:6,color:"#00bd01",opacity:1,style:"solid"},{stroke:6,color:"#ff0103",opacity:0.65,style:"dashed"},{stroke:6,color:"#ff0103",opacity:0.65,style:"solid"},{stroke:6,color:"#5298ff",opacity:1,style:"solid"},{stroke:6,color:"#5298ff",opacity:1,style:"solid"},{stroke:6,color:"#ff0103",opacity:0.65,style:"dashed"}];c3.addRouteWithTraffic=function(hS,hQ,hT){var T=c3.ROUTE_TRAFFIC_STYLE_CONFIG;if(typeof hT=="undefined"){hT=0}if(!T[hT]){return}var e=hQ;var i=T[hT];var hR=new ak(e,{strokeWeight:i.stroke,strokeColor:i.color,strokeOpacity:i.opacity,strokeStyle:i.style,clickable:false});hS.addOverlay(hR);hR._trafficStatus=hT;return hR};c3.addRoute=function(hU,hR,hQ){var T=c3.ROUTE_STYLE_CONFIG;if(typeof hQ=="undefined"){hQ=0}if(!T[hQ]){return}var e=hR;var i=T[hQ];var hT=new ak(e,{strokeWeight:i.stroke,strokeColor:i.color,strokeOpacity:i.opacity,strokeStyle:i.style,clickable:false});hU.addOverlay(hT);hT._routeType=hQ;if(hQ==fW){var hS=new ak(e,{strokeWeight:i.stroke-2,strokeColor:"#fff",strokeOpacity:0.3,clickable:false});hT._p=hS;hU.addOverlay(hS)}return hT};c3.createTransInfoWnd=function(i){var hS=i.content;var e=i.curIndex;var hT=i.total;var hQ=i.nextTransCbk;var hR=i.obj;var hU=i.hideStep;var hV=[\'<div style="font: 12px \'+e3.fontFamily+\'">\'];if(hS){hV.push(\'<div style="margin: 10px 1em 24px 0">\'+hS+"</div>")}if(!hU){hV.push(c3.genStepNavHtml(hT,e))}hV.push("</div>");var T=new an(hV.join(""),{title:"",height:0,width:220,margin:[10,10,20,10]});if(hU){return T}T.addEventListener("open",function(){var hW=f4()?"touchend":"click";if(C.G("trans_prev")){C.on(C.G("trans_prev"),hW,function(){if(hQ&&typeof hQ=="function"){hQ(e-1,hR)}})}if(C.G("trans_next")){C.on(C.G("trans_next"),hW,function(){if(hQ&&typeof hQ=="function"){hQ(e+1,hR)}})}});return T};c3.genStepNavHtml=function(T,e){var i=[];i.push(\'<table id="trans_nav" width="99% " cols="2" style="background: #eaf2ff; font: 12px \'+e3.fontFamily+\'"><tbody><tr>\');i.push(\'<td nowrap="nowrap" width="50% " align="left">\');if(e==0){i.push(\'<span unselectable="on" style="color: #9c9d99; -moz-user-select: none: >上一步</span>\')}else{i.push(\'<a id="trans_prev" style="color: #7777cc; -moz-user-select: none" href="javascript: void (0)">上一步</a>\')}i.push("</td>");i.push(\'<td nowrap="nowrap" width="50% " align="right">\');if(e==T+1){i.push(\'<span unselectable="on" style="color: #9c9d99; -moz-user-select: none" >下一步</span>\')}else{i.push(\'<a style="color: #7777cc" id="trans_next" href="javascript: void (0)">下一步</a>\')}i.push("</td></tr></tbody></table>");return i.join("")};c3.addTransPoi=function(i,hU,hS,hT){var hV=aw(hU);if(!hV){return}hS=hS||BMAP_LINE_TYPE_BUS;var e=e3.staticHost+"/wolfman/static/common/images/new/";e+="transit-exchange-2x_46d5be3.png";var T=54;switch(hS){case BMAP_LINE_TYPE_SUBWAY:T=75;break;case BMAP_LINE_TYPE_TRAIN:T=117;break;case BMAP_LINE_TYPE_AIRPLANE:T=138;break;case BMAP_LINE_TYPE_COACH:case BMAP_LINE_TYPE_BUS:default:T=54;break}var hR=new ha(e,new d9(22,22),{imageSize:new d9(22,181),infoWindowAnchor:new d9(10,0),imageOffset:new d9(0,T)});var hQ=new aC(hV,{icon:hR});i.addOverlay(hQ);if(hT){hQ.setTitle(hT)}return hQ};c3.getInfoWindowDom=function(e){if(e&&e.infoWindowDoms&&e.infoWindowDoms.contentDiv){return e.infoWindowDoms.contentDiv.childNodes[0]}return null};c3.addStationPoi=function(T,e,hQ){var i=new aC(e,{icon:new ha(d2._stopUrl,new d9(11,11))});if(hQ){i.setTitle(hQ)}T.addOverlay(i);return i};c3.createTipLbl=function(i){var e=new aN(i,{offset:new d9(30,-10)});e.setStyle({border:"solid 1px gray",padding:"2px",whiteSpace:"nowrap",background:"#fff"});return e};c3.getDistanceByPixel=function(i,e){if(!i||!e){return}return Math.round(Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2)))};c3.addSearchPoi_R=function(hW,hU,hX,e,i){var hZ=aw(hW),e=e||{};e.type=e.type||"normal";if(!hZ||typeof(hU)=="undefined"||hU<0||(hU>9&&e.type!=="child")||(hU>39&&e.type==="child")){return}var hY;var hV=e3.staticHost+"/wolfman/static/common/images/";hV+="markers_new2x_2960fb4.png";var hQ=0;if(e.type=="RouteAddrMarker"){hQ=273}var T=new d9(18*hU,hQ);var hT=new ha(hV,new d9(18,27),{offset:new d9(9,27),imageOffset:T,infoWindowOffset:eW,imageSize:gS,});hY=hU+1;var hR=100;var hS=new aC(hZ,{icon:hT,zIndexFixed:true,baseZIndex:2500000-hR*hU});hS.customProperty={type:e.type};i.addOverlay(hS);hS._stCode=hY;if(hX){hS.setTitle(hX)}return hS};fA.CBK_SEARCH_COMPLETE=1;fA.CBK_MARKERS_SET=2;fA.CBK_INFO_HTML_SET=3;fA.CBK_POLYLINES_SET=4;fA.CBK_RESULTS_HTML_SET=5;fA.CBK_BUSLIST_COMPLETE=6;fA.CBK_BUSLINE_COMPLETE=7;fA.CBK_BUSLISTHTML_SET=8;fA.CBK_BUSLINEHTML_SET=9;fA._getPoiUrl=function(e,i){if(e){return e3.mapHost+"?s="+encodeURIComponent("inf&uid="+e+"&c="+i)+"&i=0&sr=1"}return""};fA._getLocType=function(e){if(!e){return gx}if(typeof e=="string"){return cm}if(e instanceof hr||e instanceof c4){return hb}if(e instanceof c8){return gW}if(typeof e=="number"){return b8}return gx};C.extend(fA.prototype,{_getIdByLoc:function(hR,e){var i=fA._getLocType(hR.src);if(i==gx){return}var T=this;if(i==b8){e&&e(hR.src);return}if(i==cm){if(hR.curLocType==i&&hR.curSrc==hR.src&&hR.curId){e&&e(hR.curId);return}hR.curLocType=i;hR.curSrc=hR.src;cB.request(function(hT){if(hT&&hT.result&&hT.result["type"]==go){T._loc.curId=hT.content["code"];e&&e(T._loc.curId)}},{qt:eF,wd:hR.src})}else{var hQ;var hS=18;if(i==gW){if(hR.src.isLoaded()){hQ=hR.src.getCenter();hS=hR.src.getZoom()}else{hR.src.addEventListener("load",function(){T._getIdByLoc(hR,e)})}}else{hQ=hR.src}if(i==hR.curLocType&&hR.curSrc.equals(hQ)&&hR.curId){e&&e(hR.curId);return}if(i==gW){hQ=en.convertLL2MC(hQ)}if(i==hb){hQ=en.convertLL2MC(hQ)}hR.curLocType=i;hR.curSrc=new hr(hQ.lng,hQ.lat);cB.request(function(hT){if(hT&&hT.result&&hT.result["type"]==fN){T._loc.curId=hT.content?hT.content["uid"]:1;e&&e(T._loc.curId)}},{qt:b2,b:hQ.lng+","+hQ.lat+";"+hQ.lng+","+hQ.lat,l:hS})}},_setStatus:function(e){if(typeof e=="number"){this._status=e}else{delete this._status}},_triggerCbk:function(i,e,hQ){var T;if(typeof e==="undefined"){T=4}else{if(e._plans&&e._plans.length){T=1}else{if(Object.prototype.toString.call(e._start)==="[object Object]"&&Object.prototype.toString.call(e._end)==="[object Object]"){T=3}else{T=2}}}var hR;switch(i){case fA.CBK_SEARCH_COMPLETE:hR=this._opts.onSearchComplete;hR&&hR(e,T);break;case fA.CBK_MARKERS_SET:hR=this._opts.onMarkersSet;hR&&hR(e,hQ);break;case fA.CBK_POLYLINES_SET:hR=this._opts.onPolylinesSet;hR&&hR(e,hQ);break;case fA.CBK_INFO_HTML_SET:hR=this._opts.onInfoHtmlSet;hR&&hR(e,hQ);break;case fA.CBK_RESULTS_HTML_SET:hR=this._opts.onResultsHtmlSet;hR&&hR(e,hQ);break;case fA.CBK_BUSLIST_COMPLETE:hR=this._opts.onGetBusListComplete;hR&&hR(e,hQ);break;case fA.CBK_BUSLINE_COMPLETE:hR=this._opts.onGetBusLineComplete;hR&&hR(e,hQ);break;case fA.CBK_BUSLISTHTML_SET:hR=this._opts.onBusListHtmlSet;hR&&hR(e,hQ);break;case fA.CBK_BUSLINEHTML_SET:hR=this._opts.onBusLineHtmlSet;hR&&hR(e,hQ);break;default:break}}});var fv=0;var cH=1;var g7=2;O.unique=function(T){var hS=false;var hR=[];var hT={};for(var hQ=0,e=T.length;hQ<e;hQ++){if(!hT[T[hQ]]){hT[T[hQ]]=true;hR.push(T[hQ])}}return hR};O.getBestLevel=function(T,i){if(i){var e=Math.min(i.width/1100,i.height/660);T=Math.round(T+(Math.log(e)/Math.log(2)))}if(T<1){T=1}if(T>21){T=21}return T};O.parseGeo=function(hT,hW){if(typeof hT!="string"||!hT){return}var hY=hT.split("|");var e;var hR;var T;if(hY.length==1){e=f9(hT)}else{e=f9(hY[2]);hR=f9(hY[0]);T=f9(hY[1]);if(!hW){return e}}var hU={type:e.geoType};if(hW){switch(hU.type){case g7:var hV=new hr(e.geo[0][0],e.geo[0][1]);var hX=en.convertMC2LL(hV);hU.point=hX;hU.points=[hX];break;case cH:hU.points=[];var hZ=e.geo[0];for(var hS=0,hQ=hZ.length-1;hS<hQ;hS+=2){var h0=new hr(hZ[hS],hZ[hS+1]);h0=en.convertMC2LL(h0);hU.points.push(h0)}hR=new hr(hR.geo[0][0],hR.geo[0][1]);T=new hr(T.geo[0][0],T.geo[0][1]);hR=en.convertMC2LL(hR);T=en.convertMC2LL(T);hU.bounds=new dS(hR,T);break;default:break}}return hU};O.parseGeoExt=function(h9,h0){if(!h0){h0=0}else{if(h0<0.25){h0=0}else{if(h0>0.25&&h0<1){h0=1}else{if(h0>32){h0=32}}}}var hV=h9.split("|");if(hV.length==1){var hQ=f9(hV[0]);return{type:hQ.type,bound:"",points:hQ.geo.join(",")}}else{if(hV.length>1){var h1=h9.split(";.=");var hX=[];var hR=[];var h2=0;var h6=h1.length;for(var h3=0;h3<h6;h3++){var h8=h1[h3];if(h6>1){if(h3==0){h8=h8+";"}if(h3>0&&h3<h6-1){h8=".="+h8+";"}if(h3==h6-1){h8=".="+h8}}var hS=h8.split("|");var h5=f9(hS[0]);var h4=f9(hS[1]);hX.push(h5.geo.join(","));hX.push(h4.geo.join(","));var hQ=f9(hS[2]);h2=hQ.type;var h7=hQ.geo.join(",");h7=O.parseGeoExtReg1(h7);if(h0>0){h7=O.parseGeoExtReg2(h7,h0)}hR.push(h7)}if(h6<=1){hR=hR.join(";")}if(h6==2){var T=hR[0]+";"+hR[1];var hT=T.split(";");var e=[];for(var h3=0;h3<hT.length;h3++){var hW=hT[h3].split(",")[0];var hU=hT[h3].split(",")[1];var hY=new hr(hW,hU);var hZ=en.convertMC2LL(hY);e.push(hZ)}hR=e}return{type:h2,bound:hX.join(";"),points:hR}}}};O.getPoiPoint=function(e){var T=[];var i=null;if(e.toString()=="Point"){i=e}else{if(typeof e=="string"){T=C.trim(e).split(",");if(T.length<2){return}T[0]=parseFloat(C.trim(T[0]));T[1]=parseFloat(C.trim(T[1]))}else{T=e.slice(0);if(T.length<2){return}}i=new BMap.Point(T[0],T[1])}return i};O.parseGeoStr=function(T){var i=T.split(",");var e=new hr(i[0],i[1]);return en.convertMC2LL(e)};O.level={country:4,province:11,city:12,area:13};var hI=["=",".","-","*"];var f3=1<<23;function f9(hW){var hV=a9(hW.charAt(0));var T=hW.substr(1);var hY=0;var e=T.length;var hZ=[];var hT=[];var hU=[];while(hY<e){if(T.charAt(hY)==hI[0]){if((e-hY)<13){return 0}hU=aL(T.substr(hY,13),hZ);if(hU<0){return 0}hY+=13}else{if(T.charAt(hY)==";"){hT.push(hZ.slice(0));hZ.length=0;++hY}else{if((e-hY)<8){return 0}hU=c6(T.substr(hY,8),hZ);if(hU<0){return 0}hY+=8}}}for(var hS=0,hQ=hT.length;hS<hQ;hS++){for(var hR=0,hX=hT[hS].length;hR<hX;hR++){hT[hS][hR]/=100}}return{geoType:hV,geo:hT}}function a9(i){var e=-1;if(i==hI[1]){e=g7}else{if(i==hI[2]){e=cH}else{if(i==hI[3]){e=fv}}}return e}function aL(hR,T){var e=0;var hT=0;var hS=0;for(var hQ=0;hQ<6;hQ++){hS=cO(hR.substr(1+hQ,1));if(hS<0){return -1-hQ}e+=hS<<(6*hQ);hS=cO(hR.substr(7+hQ,1));if(hS<0){return -7-hQ}hT+=hS<<(6*hQ)}T.push(e);T.push(hT);return 0}function c6(hS,hQ){var T=hQ.length;if(T<2){return -1}var e=0;var hU=0;var hT=0;for(var hR=0;hR<4;hR++){hT=cO(hS.substr(hR,1));if(hT<0){return -1-hR}e+=hT<<(6*hR);hT=cO(hS.substr(4+hR,1));if(hT<0){return -5-hR}hU+=hT<<(6*hR)}if(e>f3){e=f3-e}if(hU>f3){hU=f3-hU}hQ.push(hQ[T-2]+e);hQ.push(hQ[T-1]+hU);return 0}function cO(i){var e=i.charCodeAt(0);if(i>="A"&&i<="Z"){return e-"A".charCodeAt(0)}else{if(i>="a"&&i<="z"){return(26+e-"a".charCodeAt(0))}else{if(i>="0"&&i<="9"){return(52+e-"0".charCodeAt(0))}else{if(i=="+"){return 62}else{if(i=="/"){return 63}}}}}return -1}O.pathToPoints=function(hS){var hQ=[];if(typeof hS!=="string"){return hQ}else{var hR=hS.split(";");for(var T=0;T<hR.length;T++){var e=hR[T].split(",");hQ.push(new hr(e[0],e[1]))}}return hQ};');
﻿_jsload&&_jsload('control', 'C.extend(dH.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(e){a7.prototype.initialize.call(this,e);this._render();this._updateState();this._bind(e);return this._container},_bind:function(i){var e=this;i.addEventListener("load",function(T){e._updateState()});i.addEventListener("moveend",function(T){e._updateState()});i.addEventListener("zoomend",function(T){e._updateState()})},_render:function(){a7.prototype._render.call(this);C.ac(this._container,"BMap_cpyCtrl");var e=this._container.style;e.cursor="default";e.whiteSpace="nowrap";e.MozUserSelect="none";e.WebkitTextSizeAdjust="none";a7.prototype._setPosition.call(this);if(this.sateMapStyle){this.addSateMapStyle()}},_updateState:function(){if(!this._map||!this._container||this._copyrightCollection.length===0){return}for(var hQ=0,e=this._copyrightCollection.length;hQ<e;hQ++){var hS;var hU=this._map.getZoom();if(this._copyrightCollection[hQ].mapType!==""&&this._map.mapType!==this._copyrightCollection[hQ].mapType){hS=false}else{if(hU<this._copyrightCollection[hQ].minZoom){hS=false}else{hS=true}}if(hS){if(this._container){var hR=false;for(var T=0,hT=this._container.children.length;T<hT;T++){if(parseInt(this._container.children[T].getAttribute("_cid"),10)===this._copyrightCollection[hQ].id){hR=true;this._container.children[T].style.display="block";if(this._container.children[T].innerHTML!==this._copyrightCollection[hQ].content){this._container.children[T].innerHTML=this._copyrightCollection[hQ].content}break}}if(!hR){this._generateHTML(this._copyrightCollection[hQ])}}}else{if(this._container){for(var T=0;T<this._container.children.length;T++){if(parseInt(this._container.children[T].getAttribute("_cid"),10)===this._copyrightCollection[hQ].id&&this._container.children[T].style.display!=="none"){this._container.children[T].style.display="none";return}}}}}},addCopyright:function(hQ){if(!hQ||typeof hQ.id!=="number"||isNaN(hQ.id)){return}var e={minZoom:0,bounds:null,content:"",mapType:""};for(var T in hQ){e[T]=hQ[T]}if(this._map){var hT=e.minZoom;if(hT===-1||hT<this._map.getMinZoom()||hT>this._map.getMaxZoom()){e.minZoom=this._map.getMinZoom()}if(e.mapType!==""&&!b6[e.mapType]){e.mapType=BMAPGL_NORMAL_MAP}}var hR=this.getCopyright(hQ.id);if(hR){for(var hS in e){hR[hS]=e[hS]}}else{this._copyrightCollection.push(e)}this._updateState()},getCopyright:function(hQ){for(var T=0,e=this._copyrightCollection.length;T<e;T++){if(this._copyrightCollection[T].id===hQ){return this._copyrightCollection[T]}}},getCopyrightCollection:function(){return this._copyrightCollection},removeCopyright:function(hS){var hQ;for(var T=0,e=this._copyrightCollection.length;T<e;T++){if(this._copyrightCollection[T].id===hS){hQ=this._copyrightCollection.splice(T,1);T--;e=this._copyrightCollection.length}}var hR=this.getDom(hS);if(hR&&hR.parentNode){hR.parentNode.removeChild(hR);hR=null}this._updateState();return hQ},_generateHTML:function(e){if(!this._container){return}this._container.innerHTML+=\'<span _cid="\'+e.id+\'">\'+e.content+"</span>"},getDom:function(hR){var hQ=a7.prototype.getDom.call(this);if(typeof hR==="undefined"){return hQ}else{if(hQ){for(var T=0,e=hQ.children.length;T<e;T++){if(parseInt(hQ.children[T].getAttribute("_cid"),10)===hR){return hQ.children[T]}}}}}});function fo(){}C.extend(dt.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map);this.dispatchEvent(new bb("ondomready"))}},initialize:function(e){a7.prototype.initialize.call(this,e);this._firstAnimation=true;this._setParam();this._render();this._bind();this._setSliderZoomLv(e.getZoom());this._bindMapEvent(e);var i=this._opts.offset||(new d9(1,0));this.setOffset(i);this.redraw();return this._container},_bindMapEvent:function(i){var e=this;i.addEventListener("zoomend",function(T){if(!e._map){return}e._setSliderZoomLv(e._map.getZoom());if(e._msover){return}if(e._isShowLevelHint){if(e.getType()===BMAP_NAVIGATION_CONTROL_ANIM){e._hideTimerId=setTimeout(function(){e._hideLevelHint(true);e._shrinkSlider()},1000)}else{e._hideTimerId=setTimeout(function(){e._hideLevelHint(true)},1000)}}});i.addEventListener("mousewheel",function(){if(!e._map){return}if(e._map.config.enableWheelZoom&&e._isShowLevelHint){if(e._hideTimerId){clearTimeout(e._hideTimerId);e._hideTimerId=null}if(e.getType()!==BMAP_NAVIGATION_CONTROL_ANIM){e._showLevelHint()}}});i.addEventListener("load",function(T){if(!e._map){return}e._setSliderZoomLv(e._map.getZoom())})},redraw:function(){this._setParam();this.setType(this._opts.type);if(this._map){this._setSliderZoomLv(this._map.getZoom())}},_setParam:function(){this._minZoomLevel=this._map.config.zoomLevelMin;this._maxZoomLevel=this._map.config.zoomLevelMax;if(this._minZoomLevel>4||this._maxZoomLevel<18){this._isShowLevelHint=false}else{this._isShowLevelHint=true}this._totalZoomLv=this._maxZoomLevel-this._minZoomLevel+1;this._maxBarY=this._minBarY+(this._totalZoomLv-1)*this._sliderInterval},_render:function(){a7.prototype._render.call(this);var T=C.Browser.ie==6?" BMap_ie6":"";var i=" BMap_stdMpType"+this._opts.type;var hQ=this._container;C.ac(hQ,"BMap_stdMpCtrl");C.ac(hQ,T);C.ac(hQ,i);hQ.innerHTML=this._generateHtml(this._opts.type);this._setSliderBarCursor(C.Browser.opera?"pointer":e3.defaultCursor);this._panBtnContainer=C.G(hQ.children[0]);this._zoomDom=C.G(hQ.children[1]);var e=this._zoomDom;this._btnZoomIn=C.G(e.children[0]);this._btnZoomOut=C.G(e.children[1]);this._sliderDom=C.G(e.children[2]);this._sliderBaseDom=C.G(e.children[2].children[0]);this._sliderBotDom=C.G(e.children[2].children[1]);this.setType(this._opts.type)},_setSliderHeight:function(){var i=this._opts.type;var hQ=this.controlHeight[i].width;var hR=this.controlHeight[i].height;var hS=this.controlHeight[i].zoomHeight;var e=this.controlHeight[i].zoomWidth;var hT=this.controlHeight[i].sliderHeight;if(this._opts.type==BMAP_NAVIGATION_CONTROL_LARGE||this._opts.type==BMAP_NAVIGATION_CONTROL_ANIM){}this._container.style.width=hQ+"px";this._container.style.height=hR+"px";this._zoomDom.style.height=hS+"px";this._zoomDom.style.width=hQ+"px";if(this.getType()==BMAP_NAVIGATION_CONTROL_ANIM){this._btnZoomOut.style.top=24+"px"}else{var T=(this._opts.forceNew===true)?29:23;this._btnZoomOut.style.top=hS-T+"px"}this._sliderDom.style.height=hT+"px";this._sliderBaseDom.style.height=hT+"px";if(this._opts.type==BMAP_NAVIGATION_CONTROL_ZOOM){this._zoomDom.children[0].style.left=this._zoomDom.children[1].style.left="0"}else{this._zoomDom.children[0].style.left=this._zoomDom.children[1].style.left=""}},_generateHtml:function(){var e=[];e.push(this._generatePanHtml());e.push(this._generateZoomContainerHtml());return e.join("")},_generatePanHtml:function(){var e=\'<div class="BMap_stdMpPan"><div class="BMap_button BMap_panN" title="向上平移"></div><div class="BMap_button BMap_panW" title="向左平移"></div><div class="BMap_button BMap_panE" title="向右平移"></div><div class="BMap_button BMap_panS" title="向下平移"></div><div class="BMap_stdMpPanBg BMap_smcbg"></div></div>\';return e},_generateZoomContainerHtml:function(){var e=\'<div class="BMap_stdMpZoom">\'+this._generateZoomHtml()+this._generateSliderHtml()+this._generateZoomBalloonHtml()+"</div>";return e},_generateZoomHtml:function(){var e="BMap_button";(this._opts.forceNew===true)&&(e="BMap_button_new");var i=\'<div class="\'+e+\' BMap_stdMpZoomIn" title="放大一级"><div class="BMap_smcbg in"></div></div><div class="\'+e+\' BMap_stdMpZoomOut" title="缩小一级"><div class="BMap_smcbg out"></div></div>\';return i},_generateSliderHtml:function(){var e=\'<div class="BMap_stdMpSlider"><div class="BMap_stdMpSliderBgTop"><div class="BMap_smcbg"></div></div><div class="BMap_stdMpSliderBgBot"><div class="BMap_smcbg"></div></div><div class="BMap_stdMpSliderMask" title="放置到此级别"></div><div class="BMap_stdMpSliderBar" title="拖动缩放"><div class="BMap_smcbg"></div></div></div>\';return e},_generateZoomBalloonHtml:function(){var e=\'<div class="BMap_zlHolder"><div class="BMap_zlSt"><div class="BMap_smcbg"></div></div><div class="BMap_zlCity"><div class="BMap_smcbg"></div></div><div class="BMap_zlProv"><div class="BMap_smcbg"></div></div><div class="BMap_zlCountry"><div class="BMap_smcbg"></div></div></div>\';return e},setType:function(e){if(typeof e=="number"&&e>=BMAP_NAVIGATION_CONTROL_LARGE&&e<=BMAP_NAVIGATION_CONTROL_ANIM){this._opts.type=e}else{this._opts.type=BMAP_NAVIGATION_CONTROL_LARGE}if(!this._map||!this._container){return}var i=this._container;i.className=i.className.replace(/BMap_stdMpType\\d/,"BMap_stdMpType"+this._opts.type);this._setSliderHeight();if(e!=BMAP_NAVIGATION_CONTROL_LARGE&&e!=BMAP_NAVIGATION_CONTROL_ANIM){C.rc(i.children[1].children[2],"hvr")}this.setAnchor(this._opts.anchor)},getType:function(){return this._opts.type},_bind:function(){var h0=this;var hZ=h0._container;var hS=this._opts.from=="MAP_INDEX";function hR(i,h2){return i.contains?i!=h2&&i.contains(h2):!!(i.compareDocumentPosition(h2)&16)}function hV(h4,h3){var h2,i=h4.type.toLowerCase();if(i=="mouseover"){h2=h4.relatedTarget||h4.fromElement}else{if(i==="mouseout"){h2=h4.relatedTarget||h4.toElement}else{return true}}return h2&&h2.prefix!="xul"&&!hR(h3,h2)&&h2!==h3}C.on(hZ,"mouseover",function(i){i=i||window.event;if(hV(i,hZ)){h0.dispatchEvent(new bb("onmouseover"))}});C.on(hZ,"mouseout",function(i){i=i||window.event;if(hV(i,hZ)){h0.dispatchEvent(new bb("onmouseout"))}});function hQ(){if(!h0._isShowLevelHint){return}h0._msover=true;if(h0._hideTimerId){clearTimeout(h0._hideTimerId);h0._hideTimerId=null}h0._expandSlider();if(h0.getType()!==BMAP_NAVIGATION_CONTROL_ANIM){h0._showLevelHint()}}function hU(){if(!h0._isShowLevelHint){return}if(h0._hideTimerId){clearTimeout(h0._hideTimerId)}h0._msover=false;h0._hideTimerId=setTimeout(function(){h0._hideLevelHint();h0._hideTimerId=null;h0._shrinkSlider()},1000)}if("onmouseenter" in document.documentElement){C.on(this._zoomDom,"mouseenter",function(i){hQ()});C.on(this._zoomDom,"mouseleave",function(h2){var i=h2.relatedTarget;if(i&&(i===this||hR(this,i))){return}hU()})}else{C.on(this._zoomDom,"mouseover",function(h2){var i=h2.relatedTarget;if(i&&(i===this||hR(this,i))){return}hQ()});C.on(this._zoomDom,"mouseout",function(h2){var i=h2.relatedTarget;if(i&&(i===this||hR(this,i))){return}hU()})}C.on(hZ.children[0],"mouseover",function(){h0._hideLevelHint(true)});C.on(hZ.children[0].children[0],"click",function(){h0._panBy(0,Math.round(h0._map.height/3));hS?fo(6004):null});C.on(hZ.children[0].children[1],"click",function(){h0._panBy(Math.round(h0._map.width/3),0);hS?fo(6004):null});C.on(hZ.children[0].children[2],"click",function(){h0._panBy(-Math.round(h0._map.width/3),0);hS?fo(6004):null});C.on(hZ.children[0].children[3],"click",function(){h0._panBy(0,-Math.round(h0._map.height/3));hS?fo(6004):null});C.on(hZ.children[0].children[0],"mouseover",function(){h0._panBtnContainer.style.backgroundPosition="0 -44px"});C.on(hZ.children[0].children[1],"mouseover",function(){h0._panBtnContainer.style.backgroundPosition="0 -176px"});C.on(hZ.children[0].children[2],"mouseover",function(){h0._panBtnContainer.style.backgroundPosition="0 -88px"});C.on(hZ.children[0].children[3],"mouseover",function(){h0._panBtnContainer.style.backgroundPosition="0 -132px"});C.on(h0._panBtnContainer,"mouseout",function(){h0._panBtnContainer.style.backgroundPosition="0 0"});var hY=hZ.children[1].children;C.on(hY[0],"click",function(){var i=h0._map;if(i.mapType===BMAP_EARTH_MAP){if(i._earth){if(i._earth.getLock()){return}i._earth.zoomIn({from:"control"});i._earth.fire(new bb("onzoominclick"))}}else{hS?fo(6005):null;if(i.config.isModernBrowser){h0._deepZoomIn()}else{h0._zoomIn()}i.fire(new bb("onzoominclick"))}});C.on(hY[1],"click",function(){var i=h0._map;if(i.mapType===BMAP_EARTH_MAP){if(i._earth){if(i._earth.getLock()){return}i._earth.zoomOut({from:"control"});i._earth.fire(new bb("onzoomoutclick"))}}else{hS?fo(6005):null;if(i.config.isModernBrowser){h0._deepZoomOut()}else{h0._zoomOut()}i.fire(new bb("onzoomoutclick"))}});for(var hT=1;hT<6;hT++){C.on(hZ.children[0].children[hT],"mouseup",function(i){if(h0._map.currentOperation!==dU.dragging&&h0._map.currentOperation!==dU.stdMapCtrlDrag){h(i)}});C.on(hZ.children[0].children[hT],"contextmenu",function(i){bU(i)});C.on(hZ.children[0].children[hT],"click",function(i){bU(i)})}C.on(hY[0],"mouseup",function(i){if(h0._map.currentOperation!==dU.dragging&&h0._map.currentOperation!==dU.stdMapCtrlDrag){h(i)}});C.on(hY[1],"mouseup",function(i){if(h0._map.currentOperation!==dU.dragging&&h0._map.currentOperation!==dU.stdMapCtrlDrag){h(i)}});C.on(hY[0],"contextmenu",function(i){bU(i)});C.on(hY[1],"contextmenu",function(i){bU(i)});var h1=hZ.children[1].children[2].children[2];C.on(h1,"mouseup",function(i){if(h0._map.currentOperation!==dU.dragging&&h0._map.currentOperation!==dU.stdMapCtrlDrag){h(i)}});C.on(hY[0],"click",function(i){h(i)});C.on(hY[1],"click",function(i){h(i)});C.on(h1,"click",function(i){h(i)});var hX=hZ.children[1].children[2].children[3];C.on(hX,"mouseup",function(i){if(i.button==2){h(i)}});C.on(hX,"contextmenu",function(i){bU(i)});C.on(this._zoomDom.children[3].children[0],"click",function(i){h0._map.zoomTo(18)});C.on(this._zoomDom.children[3].children[1],"click",function(i){h0._map.zoomTo(12)});C.on(this._zoomDom.children[3].children[2],"click",function(i){h0._map.zoomTo(8)});C.on(this._zoomDom.children[3].children[3],"click",function(i){h0._map.zoomTo(4)});C.on(h1,"mousedown",function(h2){h2=window.event||h2;var i=h2.offsetY||h2.layerY||0;var h3=0;h3=(h0._maxZoomLevel+1)-Math.round(h0._totalZoomLv*parseFloat(i/(h0._totalZoomLv*h0._sliderInterval)));h0._map.zoomTo(h3);hS?fo(6006):null});C.on(hX,"mouseover",function(){C.ac(hX,"h")});C.on(hX,"mouseout",function(){if(h0._map.currentOperation!==dU.stdMapCtrlDrag){C.rc(hX,"h")}});var hW=function(i){var i=window.event||i;if(i.button==2){return}if((C.Browser.ie&&i.button!=1)){return}if(hX.setCapture){hX.setCapture()}h0._map.currentOperation=dU.stdMapCtrlDrag;h0._bind.my=i.pageY||i.clientY||0;if(!C.Browser.opera){h0._setSliderBarCursor(e3.draggingCursor)}C.on(document,"mousemove",e);C.on(document,"mouseup",T);h(i);return bU(i)};var e=function(h2){if(h0._map.currentOperation===dU.stdMapCtrlDrag){var h2=window.event||h2;var h3=h2.pageY||h2.clientY;var i=h0._curBarY-h3+h0._bind.my;if(i<h0._minBarY){i=h0._minBarY}else{if(i>h0._maxBarY){i=h0._maxBarY}}hX.style.top=(h0._sliderHeight-i-15)+"px";h0._sliderBotDom.style.height=i+"px"}};var T=function(h2){if(h0._map.currentOperation===dU.stdMapCtrlDrag){var i=C.G(hX);h0._curBarY=parseInt(i.style.top);C.rc(hX,"h");h0._map.currentOperation=dU.idle;if(hZ&&hX&&hX.releaseCapture){hX.releaseCapture()}if(!C.Browser.opera){h0._setSliderBarCursor(e3.defaultCursor)}var h3=(h0._maxZoomLevel+1)-Math.round(parseFloat(h0._curBarY-h0._minBarY)/parseFloat(h0._maxBarY-h0._minBarY)*(h0._totalZoomLv-1)+1);h0._map.zoomTo(h3);hS?fo(6006):null;C.un(document,"mousemove",e);C.un(document,"mouseup",T)}};C.on(hX,"mousedown",hW)},_setSliderBarCursor:function(e){this._container.children[1].children[2].children[3].style.cursor=e},_panBy:function(i,e){this._map.panBy(i,e)},_zoomIn:function(){this._map.zoomIn()},_zoomOut:function(){this._map.zoomOut()},_deepZoomOut:function(){this._map.deepZoomMedia(-1)},_deepZoomIn:function(){this._map.deepZoomMedia(1)},_setSliderZoomLv:function(i){if(!this._container||(this.getType()!=BMAP_NAVIGATION_CONTROL_LARGE&&this.getType()!=BMAP_NAVIGATION_CONTROL_ANIM)){return}var e=(i-this._minZoomLevel)*this._sliderInterval+this._minBarY;this._curBarY=e>this._maxBarY?this._maxBarY:e<this._minBarY?this._minBarY:e;this._container.children[1].children[2].children[3].style.top=(this._sliderHeight-this._curBarY-15)+"px";this._sliderBotDom.style.height=this._curBarY+"px"},_hideLevelHint:function(e){if(this._opts.type==BMAP_NAVIGATION_CONTROL_LARGE||this._opts.type==BMAP_NAVIGATION_CONTROL_ANIM){if(this._container){C.rc(this._container.children[1].children[3],"hvr")}}if(e&&this._hideTimerId){clearTimeout(this._hideTimerId);this._hideTimerId=null}},_showLevelHint:function(){if(this._opts.type==BMAP_NAVIGATION_CONTROL_LARGE||this._opts.type==BMAP_NAVIGATION_CONTROL_ANIM){if(this._container){C.ac(this._container.children[1].children[3],"hvr")}}},_expandSlider:function(){},_shrinkSlider:function(){},show:function(){a7.prototype.show.call(this);if(C.Browser.ie<8){var e=this;setTimeout(function(){e.setType(e._opts.type)},1)}}});C.extend(hg.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(e){a7.prototype.initialize.call(this,e);this._render(e);this._setParam();this._updateScale();this._bind(e);return this._container},_setParam:function(){this._numberArray={us:[5280*5000,5280*2500,5280*2000,5280*1000,5280*500,5280*200,5280*100,5280*50,5280*25,5280*20,5280*10,5280*5,5280*2,5280,2000,1000,500,200,100,50,20,10,5],metric:[10000000,5000000,2000000,1000000,500000,200000,100000,50000,25000,20000,10000,5000,2000,1000,500,200,100,50,20,10,5,2,1]}},_bind:function(i){var e=this;i.addEventListener("zoomend",function(T){e._updateScale()});i.addEventListener("load",function(T){e._updateScale()});i.addEventListener("moveend",function(T){e._updateScale()})},_render:function(e){a7.prototype._render.call(this,e);C.ac(this._container,"BMap_scaleCtrl");this._container.innerHTML=this._generateHTML();this._container.style.WebkitTextSizeAdjust="none";this._scaleText=this._container.children[0];a7.prototype._setPosition.call(this);if(this.sateMapStyle){this.addSateMapStyle()}},_generateHTML:function(){var e=\'<div class="BMap_scaleTxt" style="white-space:nowrap;overflow:visible;text-align:center"></div><div class="BMap_scaleBarBG BMap_scaleHBarBG"></div><div class="BMap_scaleBarBG BMap_scaleRBarBG"></div><div class="BMap_scaleBarBG BMap_scaleLBarBG"></div><div class="BMap_scaleBar BMap_scaleHBar"></div><div class="BMap_scaleBar BMap_scaleLBar"></div><div class="BMap_scaleBar BMap_scaleRBar"></div>\';return e},setUnit:function(e){this._opts.unit=this._units[e]&&this._units[e].name||this._opts.unit;if(!this._map){return}this._updateScale()},_setScaleText:function(i,e){this._scaleText.innerHTML=i+"&nbsp;"+e},_updateScale:function(){if(!this._map||!this._container||!this._map.isLoaded()){return}var T=this._map;var hX=new ej(Math.round(T.width/2-50),Math.round(T.height/2));var hT=new ej(Math.round(T.width/2+50),Math.round(T.height/2));var hQ=T.pixelToPointIn(hX,{heading:0});var hW=T.pixelToPointIn(hT,{heading:0});var hS=en.getDistanceByMC(hQ,hW)/100;if(hS===0||isNaN(hS)){return}var i=this._convertUnit(hS,this._opts.unit);var e=0;var hR=this._units[this._opts.unit].incon;var hV=Math.round(this._map.getZoom());var hU=this._numberArray[this._opts.unit][hV-1];e=hU/i;if(f4()&&e>100){hU=this._numberArray[this._opts.unit][hV];e=hU/i}if(e>300){return}var hY=hU>=hR?this._units[this._opts.unit].u2:this._units[this._opts.unit].u1;if(hU>=hR){hU=Math.round(hU/hR)}this._setScaleText(hU,hY);this._container.style.width=Math.round(e)+"px"},_convertUnit:function(e,i){i=i||"metric";if(this._units[i]){return e*this._units[i].conv}return e}});C.extend(eb.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(i){this._map=i;var e=this;if(this.canCheckSize&&!this._checkSize(i)){return null}a7.prototype.initialize.call(this,i);a7.prototype._render.call(this);this.getMapCenter(function(){e._draw();a7.prototype._setPosition.call(e);e._bind(i)});return this._container},each:function(hR,T){for(var hQ=0,e=hR.length;hQ<e;hQ++){T(hQ,hR[hQ])}},delegate:function(hQ,T,i,e){var hR=this;if(!i.matchs){i.matchs=[];i.handle={}}i.matchs.push({filter:e,fn:T});if(!i.handle[hQ]){i.addEventListener(hQ,function(hT){var hS=hT.target;while(hS!=i){hR.each(i.matchs,function(hU,hW){var hV=new RegExp(hW.filter);if(hV.test(hS.getAttribute("filter"))){hW.fn.call(hS,hT,hS.getAttribute("filter"))}});hS=hS.parentNode}},false);i.handle.type=true}},_draw:function(){var hY=this;var hX=hY._cityBtn=S("div",{"class":"ui_city_change"});var hV=hY._opts.anchor;var h1="";var e=false;switch(hV){case BMAP_ANCHOR_TOP_LEFT:h1="float: left";break;case BMAP_ANCHOR_TOP_RIGHT:h1="float: right";break;case BMAP_ANCHOR_BOTTOM_LEFT:h1="float: left";e=true;break;case BMAP_ANCHOR_BOTTOM_RIGHT:h1="float: right";e=true;break;default:break}hX.innerHTML=\'<a href="javascript:void(0)" onclick="return false" class="ui_city_change_inner" style="\'+h1+\'"><span id="cur_city_name" class="cur_city_name">\'+hY._map.cityName+"</span><i><em></em></i></a>";hX.style.position="relative";hX.style.height=34+"px";if(!e){C.ac(hX,"ui_city_change_top");hY._container.appendChild(hX)}var hQ=hY._cityListWrap=S("div",{"class":"citylist_popup_main"});var h0=\'<div class="citylist_ctr_title">城市列表</div>\';dI(hQ,h0);var h3=S("div",{"class":"citylist_ctr_content"});var hU=S("div",{"class":"city_content_top"});hU.innerHTML=\'<p class="cur_city_info">当前城市：<span id="cur_city_spn">\'+hY._map.cityName+"</span</p>";var hR=\'<form id="city_ctrl_form" onsubmit="Instance("\'+this.guid+\'").search(this);return false"><input type="text" class="sel_city_input" id="selCityWd" name="wd" placeholder="请输入城市名" autocomplete="off"><span id="selCitySubmit">搜索</span><div id="selCityTip" style="display:none;height:20px;line-height:20px;color:#AE6842;border:1px solid #E8AA6C;background:#FEFAF1;width:121px;text-align:center">请输入正确的城市</div></form>\';var T=dI(hU,hR);h3.appendChild(hU);var i=S("div",{"class":"city_content_medium"});var hW=\'<div id="hot_city_ids" class="sel_city_hotcity">\'+this._geneHotCityHtml()+"</div>";var h2=\'<div id="sel_city_letter_list" class="sel_city_letterbar">\'+this._geneCityLetter()+"</div>";dI(i,hW+h2);h3.appendChild(i);var hT=S("div",{"class":"city_content_bottom",id:"city_detail_tpl"});var hS=this._geneCitiesDetailHtml();hT.innerHTML=hS;h3.appendChild(hT);hQ.appendChild(h3);var hZ=hY._closeBtn=S("button",{id:"popup_close"});hQ.appendChild(hZ);if(hY._opts.expand){hY.showListWrap(true)}else{hY.showListWrap(false)}if(hV==BMAP_ANCHOR_TOP_RIGHT||hV==BMAP_ANCHOR_BOTTOM_RIGHT){hQ.style.left="-2px"}hY._container.appendChild(hQ);if(e){C.ac(hX,"ui_city_change_bottom");hY._container.appendChild(hX)}C.ac(hY._container,"BMap_CityListCtrl")},_checkSize:function(e){if(e.width&&e.width>400&&e.height&&e.height>350){return true}return false},_bind:function(e){var hZ=this;var hT=hZ.onChangeBefore||[];var h2=function(h8,h5){var h8=h8||window.event;var h6=h8.target||h8.srcElement;var h3=h6.getAttribute("name");h(h8);var h9=true;switch(h5){case"cityHotIds":for(var h4=0;h4<hT.length;h4++){hT[h4]&&hT[h4]()}hZ.changeCity(h3);break;case"cityLetters":if(h3=="other"){h3="Z"}var h7=C.G("ctr_tr_"+h3);hZ._listDetailTbl.scrollTop=h7.offsetTop;h9=false;break;case"cityName":for(var h4=0;h4<hT.length;h4++){hT[h4]&&hT[h4]()}hZ.changeCity(h3);break;default:break}if(h9){setTimeout(function(){hZ.showListWrap(false)},200)}};var hY=function(){hZ._toggleList()};var hW=function(h9){db(h9);var h6=(Math.ceil(h9.wheelDelta/120)||-h9.detail/3);var h4=h6>0?1:-1;var h5=hZ._listDetailTable.clientHeight||hZ._listDetailTable.offsetHeight;var h3=hZ._listDetailTbl.clientHeight||hZ._listDetailTbl.offsetHeight;var h7=0;var h8=h5-(h3-20);if(h4>0){hZ._listDetailTbl.scrollTop-=20;if(hZ._listDetailTbl.scrollTop<=h7){hZ._listDetailTbl.scrollTop=0}}else{hZ._listDetailTbl.scrollTop+=20;if(hZ._listDetailTbl.scrollTop>=h8){hZ._listDetailTbl.scrollTop=h8}}};if(hZ._container){var hU=hZ._cityBtn;var h0=hZ._closeBtn;var h1=C.G("hot_city_ids");var hX=C.G("sel_city_letter_list");var hR=C.G("city_detail_table");var hS=C.G("cur_city_name");var i=C.G("cur_city_spn");hZ.delegate("click",h2,h1,"cityHotIds");hZ.delegate("click",h2,hX,"cityLetters");hZ.delegate("click",h2,hR,"cityName");C.on(hU,"click",hY);C.on(h0,"click",function(){hZ.showListWrap(false)});hZ._map.addEventListener("citychange",function(h3){hZ.getMapCenter(function(){hZ.curCityName=hZ._map.cityName;if(hZ._map.cityName=="中国"){hZ.curCityName="全国"}hZ.curCityCode=hZ._map.cCode;hS.innerHTML=hZ.curCityName;i.innerHTML=hZ.curCityName})});C.on(hZ._cityListWrap,"mousewheel",function(h3){db(h3)});if(window.addEventListener){hZ._cityListWrap.addEventListener("DOMMouseScroll",function(h3){db(h3)},false)}var hQ=hZ._listDetailTbl=C.G("city_detail_tpl");var T=hZ._listDetailTable=C.G("city_detail_table");C.on(hQ,"mousewheel",hW);if(window.addEventListener){hQ.addEventListener("DOMMouseScroll",hW,false)}var hV=C.G("selCitySubmit");hV.addEventListener("click",function(h5){db(h5);for(var h3=0;h3<hT.length;h3++){hT[h3]&&hT[h3]()}var h4=C.G("selCityWd").value;if(h4.length>0&&h4.length<20){h4=h4.replace(/(\s)/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;");hZ.changeCity(h4,true)}else{C.G("selCityTip").style.display="block";return}});C.on(hZ._cityListWrap,"click",function(h3){C.G("selCityTip").style.display="none"})}},_geneHotCityHtml:function(){var hS=this;var hR=hS.getHotCities();var hQ="";var T="";for(var e=0;e<hR.length;e++){if(e==0){T="font-weight:bold"}hQ+=\'<a href="javascript:void(0)" filter="cityHotIds" name="\'+hR[e]+\'" style="margin-right:7px;*margin-right:1px;\'+T+\'">\'+hR[e]+"</a>";T=""}return hQ},_geneCityLetter:function(){var hR=["A","F","G","H","J","L","N","Q","S","T","X","Y","Z","其他"];var hQ="";var e="";for(var T=0;T<hR.length;T++){if(T==hR.length-1){e="other"}else{e=hR[T]}hQ+=\'<a href="javascript:void(0)" filter="cityLetters" name="\'+e+\'">\'+hR[T]+"</a>"}return hQ},_geneCitiesDetailHtml:function(){var hV=this.getCitiesNames();var hT=\'<table id="city_detail_table" style="border-collapse:collapse;border-spacing:0" cellpadding="0" cellspacing="0">\';for(var hS in hV){var e=false;if(hS=="特别行政区"){hT+=\'<tr><td class="sel_city_letter"><div></div></td>\';hT+=\'<td class="sel_city_other sel_city_sf"><a href="javascript:void(0)" class="sel_city_name">\'+hS+"</a></td>";hT+=\'<td><div class="bmap-clearfix city_names_wrap">\';for(var T=0;T<hV[hS].length;T++){hT+=\'<a class="sel_city_name" href="javascript:void(0)" filter="cityName" name="\'+hV[hS][T]+\'">\'+hV[hS][T]+"</a>"}hT+="</div></td></tr>"}else{for(var hR in hV[hS]){if(!e){hT+=\'<tr id="ctr_tr_\'+hS+\'"><td class="sel_city_letter"><div>\'+hS+"</div></td>";e=true}else{hT+=\'<tr><td class="sel_city_letter"><div></div></td>\'}hT+=\'<td class="sel_city_sf"><a href="javascript:void(0)" filter="cityName" name="\'+hR+\'">\'+hR+":</a></td>";hT+=\'<td><div class="bmap-clearfix city_names_wrap">\';var hU=hV[hS][hR];for(var hQ=0;hQ<hU.length;hQ++){hT+=\'<a class="sel_city_name" href="javascript:void(0)" filter="cityName" name="\'+hV[hS][hR][hQ]+\'">\'+hV[hS][hR][hQ]+"</a>"}hT+="</div></td></tr>"}}}hT+="</table>";return hT},showListWrap:function(e){var i=this;if(i._cityListWrap){e?i._cityListWrap.style.display="block":i._cityListWrap.style.display="none";if(e){i._container.style.width=400+"px"}else{i._container.style.width="auto";i._container.style.height="auto"}}if(i._cityBtn){e?C.ac(i._cityBtn,"ui_city_change_click"):C.rc(i._cityBtn,"ui_city_change_click")}},changeCity:function(e,hR){var T=this;if(T._container&&T._cityBtn){var hQ=C.G("cur_city_name");var i=C.G("cur_city_spn");cB.request(function(hT){var hU=T.onChangeAfter||[];var hV=T.onChangeSuccess||[];setTimeout(function(){for(var hZ=0;hZ<hU.length;hZ++){hU[hZ]&&hU[hZ]()}},300);if(hT&&hT.result&&hT.result["type"]==go){if(hT.content.hasOwnProperty("error")||hT.err_msg.length>0){if(hR){C.G("selCityTip").style.display="block"}return}var hY=hT.content;if(hY){var hX={title:hY.cname||"",uid:hY.uid||"",point:O.parseGeo(hY.geo,true).point||"",city:hY.cname||"",code:hY.code||"",level:hY.level||T._map.getZoom()};var hY=hX.point;var hW=O.getBestLevel(hX.level,T._map);if(isNaN(hW)){hW=T._map.getZoom()}if(hT.content["code"]==1){hW=5}if(hR){setTimeout(function(){T.showListWrap(false)},200)}T._map.centerAndZoom(hY,hW);hQ.innerHTML=hX.city;i.innerHTML=hX.city;for(var hS=0;hS<hV.length;hS++){hV[hS]&&hV[hS](hX)}}}},{qt:eF,wd:e,dtype:1})}},_toggleList:function(){var i=this;if(i._cityListWrap){var e=i._cityListWrap.style.display=="none"?false:true;i.showListWrap(!e)}},getHotCities:function(){return["全国","北京","上海","广州","深圳","成都","天津","南京","武汉","杭州","重庆"]},getCitiesNames:function(){return{A:{"安徽":["合肥","安庆","蚌埠","亳州","巢湖","池州","滁州","阜阳","淮北","黄山","六安","马鞍山","宿州","铜陵","芜湖","宣城","淮南"]},F:{"福建":["福州","龙岩","南平","宁德","莆田","泉州","三明","厦门","漳州"]},G:{"广东":["广州","潮州","东莞","佛山","河源","惠州","江门","揭阳","茂名","梅州","清远","汕头","汕尾","韶关","深圳","阳江","云浮","湛江","肇庆","中山","珠海"],"广西":["南宁","百色","北海","崇左","防城港","桂林","贵港","河池","贺州","来宾","柳州","钦州","梧州","玉林"],"贵州":["贵阳","安顺","毕节","六盘水","铜仁","遵义","黔西南州","黔东南州","黔南州"],"甘肃":["兰州","白银","定西","甘南州","嘉峪关","金昌","酒泉","临夏州","陇南","平凉","庆阳","天水","武威","张掖"]},H:{"海南":["海口","白沙黎族自治县","保亭黎族苗族自治县","昌江黎族自治县","儋州","澄迈","东方","定安","琼海","琼中黎族苗族自治县","乐东黎族自治县","临高","陵水黎族自治县","三亚","屯昌","万宁","文昌","五指山","三沙"],"河南":["郑州","安阳","鹤壁","焦作","开封","洛阳","漯河","南阳","平顶山","濮阳","三门峡","商丘","新乡","信阳","许昌","周口","驻马店","济源"],"黑龙江":["哈尔滨","大庆","大兴安岭地区","鹤岗","黑河","鸡西","佳木斯","牡丹江","七台河","齐齐哈尔","双鸭山","绥化","伊春"],"湖北":["武汉","鄂州","恩施","黄冈","黄石","荆门","荆州","潜江","神农架林区","十堰","随州","天门","仙桃","咸宁","襄阳","孝感","宜昌"],"湖南":["长沙","常德","郴州","衡阳","怀化","娄底","邵阳","湘潭","湘西州","益阳","永州","岳阳","张家界","株洲"],"河北":["石家庄","保定","沧州","承德","邯郸","衡水","廊坊","秦皇岛","唐山","邢台","张家口"]},J:{"江苏":["南京","常州","淮安","连云港","南通","苏州","宿迁","泰州","无锡","徐州","盐城","扬州","镇江"],"江西":["南昌","抚州","赣州","吉安","景德镇","九江","萍乡","上饶","新余","宜春","鹰潭"],"吉林":["长春","白城","白山","吉林市","辽源","四平","松原","通化","延边"]},L:{"辽宁":["沈阳","鞍山","本溪","朝阳","大连","丹东","抚顺","阜新","葫芦岛","锦州","辽阳","盘锦","铁岭","营口"]},N:{"宁夏":["银川","固原","石嘴山","吴忠","中卫"],"内蒙古":["呼和浩特","阿拉善盟","包头","巴彦淖尔","赤峰","鄂尔多斯","呼伦贝尔","通辽","乌海","乌兰察布","锡林郭勒盟","兴安盟"]},Q:{"青海":["西宁","果洛州","海东地区","海北州","海南州","海西州","黄南州","玉树州"]},S:{"山东":["济南","滨州","东营","德州","菏泽","济宁","莱芜","聊城","临沂","青岛","日照","泰安","威海","潍坊","烟台","枣庄","淄博"],"山西":["太原","长治","大同","晋城","晋中","临汾","吕梁","朔州","忻州","阳泉","运城"],"陕西":["西安","安康","宝鸡","汉中","商洛","铜川","渭南","咸阳","延安","榆林"],"四川":["成都","阿坝州","巴中","达州","德阳","甘孜州","广安","广元","乐山","凉山州","泸州","南充","眉山","绵阳","内江","攀枝花","遂宁","雅安","宜宾","资阳","自贡"]},T:{"台湾":["台北","高雄","台中","台南","新北","基隆","新竹","嘉义"]},X:{"西藏":["拉萨","阿里地区","昌都","林芝市","那曲","日喀则","山南"],"新疆":["乌鲁木齐","阿拉尔","阿克苏地区","阿勒泰地区","巴音郭楞蒙古自治州","博尔塔拉州","昌吉州","哈密","和田地区","喀什地区","克拉玛依","克孜勒苏州","石河子","塔城地区","图木舒克","吐鲁番","五家渠","伊犁州","北屯","铁门关","双河","可克达拉","昆玉"]},Y:{"云南":["昆明","保山","楚雄州","大理州","德宏州","迪庆州","红河州","丽江","临沧","怒江州","普洱","曲靖","昭通","文山","西双版纳傣族自治州","玉溪"]},Z:{"浙江":["杭州","湖州","嘉兴","金华","丽水","宁波","衢州","绍兴","台州","温州","舟山"]},"特别行政区":["香港","澳门"]}},getMapCenter:function(i){var hR=this._map;var T=hR.getBounds();var hS=hR.getZoom();var e=en.convertLL2MC(T.getSouthWest());var hQ=en.convertLL2MC(T.getNorthEast());cB.request(function(hV){if(hV&&hV.current_city&&hV.current_city["name"]){var hU=hV.current_city["name"];var hT=hV.current_city["code"];this.curCityName=hR.cityName=hU;this.curCityCode=hR.cCode=hT;if(i){i.call(this)}}},{qt:"cen",b:e.lng+","+e.lat+";"+hQ.lng+","+hQ.lat,l:hS},"","",true)}});var ft=new String(e3.imgPath+"maptype.png?20150903");ft.toCss=function(e,T){e=typeof e==="number"?e+"px ":"";T=typeof T==="number"?T+"px ":"";var i="transparent url("+this+") no-repeat "+e+T;return i};var bN=[[0,-138],[-11,-138]];bN.toCss=function(i){var e=this[Number(i)];return e[0]+"px "+e[1]+"px"};var aO={B_EARTH_MAP:{text:"3D地球",title:"显示3D地球",file:ft,x:0,y:-92,right:0},B_NORMAL_MAP:{text:"地图",title:"显示普通地图",file:ft,x:0,y:0,right:0}};var gI={B_NORMAL_MAP:{first:"B_EARTH_MAP",second:"B_NORMAL_MAP",showMenu:true},B_EARTH_MAP:{first:"B_NORMAL_MAP",second:"B_EARTH_MAP",showMenu:false}};var b7=["B_NORMAL_MAP","B_EARTH_MAP"];var aY={HIGHLIGHT:"#0c88e8",NORMAL:"#ffffff",HIGHLIGHT_TEXT:"#ffffff",NORMAL_TEXT:"#666666"};C.extend(bC.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(h5){a7.prototype.initialize.call(this,h5);a7.prototype._render.call(this);a7.prototype._setPosition.call(this);this.mapTypeButtons={};var hS=aY;var hQ={top:"0px",cursor:"pointer",width:"49px",height:"46px",zIndex:"800",display:"inline-block",position:"absolute",fontSize:"12px",backgroundColor:"#fff"};var T={width:"49px",height:"46px",position:"absolute"};var h6={position:"absolute",top:"28px",left:"2px",width:"45px",height:"16px",backgroundColor:hS.NORMAL,opacity:"0.8",filter:"Alpha(opacity=80);"};var hX={position:"absolute",top:"30px",left:"2px",width:"45px",color:"#666666",textAlign:"center",lineHeight:"12px"};if(C.isIE>0&&C.isIE<=8){hX.lineHeight="15px"}C.extend(this._container.style,{top:"10px",width:"49px",height:"98px"});this._container.style.background="url("+e3.imgPath+"blank.gif)";this._container.style.WebkitTransition=this._container.style.transition="top .3s ease-out";var e=S("div");this._menu=e;C.extend(e.style,{position:"absolute",width:"71px",height:"24px",border:"1px solid #ABAEB3",fontSize:"12px",bottom:"20px",right:"0",backgroundColor:"white",display:"none",cursor:"pointer"});var hV=S("span");hV._checked=this._map.isStreetLayerShow();var hT=bN[1];e._checkbox=hV;C.extend(hV.style,{background:ft.toCss(hT[0],hT[1]),width:"11px",height:"11px",position:"absolute",cssFloat:"left",top:"7px",left:"4px"});e.appendChild(hV);var hW=S("span");hW.innerHTML="显示路网";C.extend(hW.style,{position:"absolute",top:"5px",marginLeft:"18px"});e.appendChild(hW);hW.onmouseover=h;hW.onmouseout=h;e.onmouseover=h;e.onmouseout=h;this._container.appendChild(e);for(var hZ=0,h1=b7.length;hZ<h1;++hZ){var h7=b7[hZ];var hR=aO[h7];var h0=S("div");h0.title=hR.title;h0._name=h7;C.extend(h0.style,hR);C.extend(h0.style,hQ);var hY=S("div");hY.style.position="absolute";hY.style.width="49px";hY.style.height="46px";hY.style.left=hY.style.top="0";hY.style.zIndex="999";h0._mask=hY;h0.appendChild(hY);var hU=S("span");h0._captionBg=hU;C.extend(hU.style,h6);hU.onmouseover=h;hU.onmouseout=h;var h3=S("span");h0._innerBox=h3;C.extend(h3.style,T);var h4=ft.toCss(hR.x,hR.y);h3.style.background=h4;var h2=S("span");h0._caption=h2;h2.innerHTML=hR.text;C.extend(h2.style,hX);h0.appendChild(h3);h3.appendChild(hU);h3.appendChild(h2);h2.onmouseover=h;this._container.appendChild(h0);this.mapTypeButtons[h7]=h0}this._bind(h5);this.updateUI(this._map.mapType);return this._container},_bind:function(i){var e=this;this._container.ondblclick=h;this.mapTypeButtons.B_NORMAL_MAP._mask.onclick=function(){e._map.setMapType("B_NORMAL_MAP")};this.mapTypeButtons.B_EARTH_MAP._mask.onclick=function(){e._map.setMapType("B_EARTH_MAP")};this.mapTypeButtons.B_NORMAL_MAP._mask.onmouseover=function(){e._dehighlightAll();e._highlight(e.mapTypeButtons.B_NORMAL_MAP)};this.mapTypeButtons.B_EARTH_MAP._mask.onmouseover=function(){e._dehighlightAll();e._highlight(e.mapTypeButtons.B_EARTH_MAP)};this.mapTypeButtons.B_NORMAL_MAP._mask.onmouseout=this.mapTypeButtons.B_EARTH_MAP._mask.onmouseout=function(){e._dehighlightAll()};this._menu.onclick=function(T){e._map.showStreetLayer(!e._menu._checkbox._checked);h(T);return false};this._menu.ondblclick=h;i.addEventListener("onmaptypechange",function(T){e.updateUI(this.mapType)});i.addEventListener("onstreetlayer_show",function(T){e._menu._checkbox._checked=true;e._menu._checkbox.style.backgroundPosition=bN.toCss(true)});i.addEventListener("onstreetlayer_hide",function(T){e._menu._checkbox._checked=false;e._menu._checkbox.style.backgroundPosition=bN.toCss(false)});i.addEventListener("forceenableearth",function(T){if(this.config.enableEarth){e.showButton("B_EARTH_MAP");e.hideButton("B_NORMAL_MAP")}})},updateUI:function(T){this.hideButton(T);var hS=gI[T];var hQ=this.mapTypeButtons[hS.first];hQ.style.top="0";hQ.style.display="inline-block";this.showButton(hS.first);var e=this.mapTypeButtons[hS.second];e.style.display="none";this.showButton(hS.second);if(T!=="B_NORMAL_MAP"){var i=this._map.isStreetLayerShow();var hR=this._menu;hR._checkbox._checked=i;hR._checkbox.style.backgroundPosition=bN.toCss(i);hR.style.display=""}else{this._menu.style.display="none"}if(!this._map.config.enableEarth){this.hideButton("B_EARTH_MAP")}},remove:function(){var hQ=this.mapTypeButtons;for(var T=0,e=hQ.length;T<e;++T){hQ[T]=null}a7.prototype.remove.call(this)},hideButton:function(i){var e=this.mapTypeButtons[i];if(!e){return}if(e.style){e.style.visibility="hidden"}},showButton:function(i){var e=this.mapTypeButtons[i];if(!e){return}if(e.style){e.style.visibility="visible"}},isButtonVisible:function(i){var e=this.mapTypeButtons[i];if(!e){return}return e.style.visibility==="visible"},_highlight:function(e){if(!e){return}e._captionBg.style.backgroundColor=aY.HIGHLIGHT;e._captionBg.style.opacity="1";e._captionBg.style.filter="";e._caption.style.color=aY.HIGHLIGHT_TEXT},_dehighlight:function(e){if(!e){return}e._captionBg.style.backgroundColor=aY.NORMAL;e._captionBg.style.opacity="0.8";e._captionBg.style.filter="Alpha(opacity=80);";e._caption.style.color=aY.NORMAL_TEXT},_dehighlightAll:function(){this._dehighlight(this.mapTypeButtons.B_NORMAL_MAP);this._dehighlight(this.mapTypeButtons.B_EARTH_MAP);this._dehighlight(this.mapTypeButtons.B_SATELLITE_MAP)}});C.extend(cy.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(i){this._map=i;var hQ=this._container=document.createElement("div");hQ.style.cssText="box-shadow: 0 2px 6px 0 rgba(107,120,137,0.20), 0 4px 10px 0 rgba(91,98,107,0.08);background:rgba(255,255,255,1);";hQ.className="BMap_stdMpZoom";var e=this._zoomIn=document.createElement("div");e.className="BMap_button_new BMap_stdMpZoomIn";e.innerHTML=\'<div class="BMap_smcbg in" style="position: absolute"></div>\';var T=this._zoomOut=document.createElement("div");T.className="BMap_button_new BMap_stdMpZoomOut";T.innerHTML=\'<div class="BMap_smcbg out" style="position: absolute; top: 36px;"></div>\';hQ.appendChild(e);hQ.appendChild(T);i.getContainer().appendChild(hQ);this.bindEvt();return hQ},_generateZoomHtml:function(){var e=\'<div class="BMap_button_new BMap_stdMpZoomIn" title="放大一级"><div class="BMap_smcbg in"></div></div><div class="BMap_button_new BMap_stdMpZoomOut" title="缩小一级"><div class="BMap_smcbg out"></div></div>\';return e},bindEvt:function(){var e=this;var i=e._map;e._zoomIn.onclick=function(){i.zoomIn();e._zoomInTapped=false;this.style.background=""};e._zoomOut.onclick=function(){i.zoomOut();e._zoomOutTapped=false;this.style.background=""};e._zoomIn.ontouchstart=function(T){if(e._zoomInDisabled){return}e._zoomInTapped=true;this.style.background="#9b9b9b";T.preventDefault()};e._zoomIn.ontouchend=function(){if(!e._zoomInTapped){return}i.zoomIn();e.updateUI();e._zoomInTapped=false;this.style.background=""};e._zoomOut.ontouchstart=function(T){if(e._zoomOutDisabled){return}e._zoomOutTapped=true;this.style.background="#9b9b9b";T.preventDefault()};e._zoomOut.ontouchend=function(){if(!e._zoomOutTapped){return}i.zoomOut();e.updateUI();e._zoomOutTapped=false;this.style.background=""};e.zoomChangeHandler=function(){};i.addEventListener("zoomend",e.zoomChangeHandler);i.addEventListener("load",e.zoomChangeHandler)},updateUI:function(){var e=this._map;if(e.getZoom()>=e.getMaxZoom()){this._zoomInDisabled=true}else{this._zoomInDisabled=false;this._zoomIn.childNodes[0].style.backgroundPosition="0px 0px"}if(e.getZoom()<=e.getMinZoom()){this._zoomOutDisabled=true}else{this._zoomOutDisabled=false;this._zoomOut.childNodes[0].style.backgroundPosition="-8px 0"}}});C.extend(bA.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}if(this._startLocationCalled){this.startLocation();this._startLocationCalled=false}},initialize:function(e){a7.prototype.initialize.call(this,e);this._render(e);this._bind(e);return this._container},startLocation:function(){var T=this;var e=true;if(T.onLocationStart){function hQ(hS){T._onLocSuccess(hS,true)}function hR(){T._onLocFailure()}e=T.onLocationStart(hQ,hR)}if(e===false){return}if(!navigator.geolocation){return}var i={enableHighAccuracy:false,maximumAge:1000,timeout:30000};this.watchId&&navigator.geolocation.clearWatch(this.watchId);this.watchId=null;navigator.geolocation.getCurrentPosition(function(hS){T._onLocSuccess(hS,true)},function(hS){T._onLocFailure(hS)},i);if(this.watchPosition){this.watchId=navigator.geolocation.watchPosition(function(hS){T._onLocSuccess(hS,false)},function(hS){},i)}},stopLocationTrace:function(){if(navigator.geolocation){this.watchId&&navigator.geolocation.clearWatch(this.watchId)}},_render:function(T){var i=this._container=document.createElement("div");i.style.cssText="width:39px;height:39px;box-shadow: 0 2px 6px 0 rgba(107,120,137,0.20), 0 4px 10px 0 rgba(91,98,107,0.08);background:#fff;cursor:pointer;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;border-radius: 4px;";var hQ=this._locBtn=document.createElement("div");hQ.style.cssText=\'position: absolute;left: 50%;top: 50%;margin-left: -10px;margin-top: -10px;width: 20px;height: 20px;background: url("\'+e3.imgResources.locNewPng+\'") 0 0;background-size: 48px 116px;\';i.appendChild(hQ);var e=this._locFailTip=document.createElement("div");e.innerHTML="定位失败";e.style.cssText="display:none;position:absolute;left:45px;top:50%;width: 52px;height:20px;line-height:20px;margin-top:-10px;font-size:12px;box-shadow:1px 1px 2px rgba(0,0,0,.4);background:rgba(255,255,255,1);border-radius:3px;padding-left:5px;";i.appendChild(e);T.getContainer().appendChild(i);return i},_bind:function(){var e=this;function T(){e._buttonTapped=true;this.style.background="#9b9b9b"}function i(){if(e._buttonTapped===false){return}e._buttonTapped=false;e.startLocation();this.style.background="#fff"}if(!f4()){e._container.addEventListener("mousedown",T,false);e._container.addEventListener("mouseup",i,false)}else{e._container.addEventListener("touchstart",T,false);e._container.addEventListener("touchend",i,false)}},_onLocSuccess:function(hT,hW){var hS=this;var hU=hT.coords.longitude;var hR=hT.coords.latitude;if(hT.coordsType==="bd09mc"){var i=new hr(hU,hR);if(!hS.locMarker){hS._addLocOverlay(i)}else{hS._refreshLocOverlayPosition(i,hW)}return}var hV=1;if(hT.coordsType==="bd09ll"){hV=5}var T=hU+","+hR;var hQ="locCbk"+Math.floor(Math.random()*10000000000);bo[hQ]=function(hY){if(hY&&hY.result&&hY.result.length>0){var hX=hY.result[0];var hZ=new hr(hX.x,hX.y);if(!hS.locMarker){hS._addLocOverlay(hZ)}else{hS._refreshLocOverlayPosition(hZ,hW)}}delete bo[hQ]};var e="//api.map.baidu.com/geoconv/v1/?coords="+T+"&from="+hV+"&to=6&ak=1biSUTC4Lo4hgpK3GQoytX3t&callback="+eA+"."+hQ;hl.load(e)},_onLocFailure:function(){var e=this._locFailTip;e.style.display="block";setTimeout(function(){e.style.display="none"},1000)},_addLocOverlay:function(i){var T=this._map;var e=new ha(e3.imgResources.locNewPng,new d9(48,48),{imageSize:new d9(48,116),imageOffset:new d9(0,20)});var hQ=this.locMarker=new dr(i,{icon:e,baseZIndex:999999,enableMassClear:false,clickable:false});T.addOverlay(hQ);if(this._opts.autoViewport){if(this._opts.autoZoom){T.centerAndZoomIn(i,this.locLevel)}else{T.setCenterIn(i)}}if(this.useCompass&&this._isSupportCompass()){this.switchToCompassState()}},_refreshLocOverlayPosition:function(i,e){this.locMarker.setPositionIn(i);if(this.headingMarker){this.headingMarker.setPositionIn(i)}if(e&&this._opts.autoViewport){if(this._opts.autoZoom){this._map.centerAndZoomIn(i,this.locLevel)}else{this._map.setCenterIn(i)}}},_isSupportCompass:function(){var e=navigator.userAgent.toLowerCase();if(e.indexOf("android")>-1||!window.DeviceOrientationEvent||(e.indexOf("ucweb")>-1&&e.indexOf("linux")>-1)){return false}return true},switchToCompassState:function(){var T=this;var i=new ha(e3.imgResources.locNewPng,new d9(48,48),{imageSize:new d9(48,116),imageOffset:new d9(0,68),anchor:new d9(24,24)});this.headingMarker=new dr(this.locMarker.getPositionIn(),{icon:i,baseZIndex:999998,enableMassClear:false,clickable:false});this._map.addOverlay(this.headingMarker);var e=0;var hQ=window.orientation;window.addEventListener("deviceorientation",function(hT){var hS;if(!hT.webkitCompassHeading){hS=Math.round(hT.alpha)}else{hS=Math.round(0-hT.webkitCompassHeading)}hS=hS-hQ;var hR=Math.abs(e-hS);if(hR>1){T.headingMarker.setRotation(0-hS);e=hS}},true);window.addEventListener("orientationchange",function(){hQ=window.orientation},true)}});');


_jsload&&_jsload('hotspot', 'function dh(e){this._map=e;this._enableSpot=true;this.bindMapEvent()}dh.prototype.enable=function(){this._enableSpot=true};dh.prototype.disable=function(){this._enableSpot=false};dh.prototype.bindMapEvent=function(){var hS=this._map;var hQ=this;function i(){hQ.disable()}function e(){hQ.enable()}hS.addEventListener("movestart",i);hS.addEventListener("moveend",e);hS.addEventListener("zoomstart",i);hS.addEventListener("zoomend",function(){setTimeout(e,10)});function T(){hQ.reset()}hS.addEventListener("load",T);hS.addEventListener("moveend",T);hS.addEventListener("zoomend",T);hS.addEventListener("dragend",function(){this.temp.__dragged=true});hS.addEventListener("mousemove",function hR(h2){if(hS.currentOperation!==dU.idle||hQ._enableSpot===false){return}if(h2.overlay&&!(h2.overlay instanceof w)||h2.infoWindow){return}var h7=this.temp;if(h7.spottimer){clearTimeout(h7.spottimer);h7.spottimer=null}if(hS.spotsPool){var hT=hS.temp.curSpots.slice(0);hS.temp.curSpots=[];var h3=hQ.getSpotsByScreenPosition(h2.pixel);if(h3.length>0){hS.platform.style.cursor="pointer"}hS.temp.curSpotsArray=[];for(var h0=hS.temp.curSpots.length-1;h0>=0;h0--){if(hS.temp.curSpots[h0]&&hS.temp.curSpots[h0].spots&&hS.temp.curSpots[h0].spots.length>0){hS.temp.curSpotsArray=hS.temp.curSpots[h0].spots;break}}var h4=hS.temp.curSpotsArray.slice(0);var hV=[];var h6=h0;for(var h0=hT.length-1;h0>=0;h0--){if(h0===h6){hV=hT[h6]&&hT[h6].spots||[];for(var hZ=0,hX=hV.length;hZ<hX;hZ++){for(var hY=0,hU=0,hW=hS.temp.curSpotsArray.length;hY<hW;hY++,hU++){if(hV[hZ]===hS.temp.curSpotsArray[hY]){hV.splice(hZ,1);hZ--;h4.splice(hU,1);hU--}}}}else{if(hT[h0]&&hT[h0].spots&&hT[h0].spots.length>0){for(var hZ=0;hZ<hT[h0].spots.length;hZ++){hV.push(hT[h0].spots[hZ])}}}}if(hV.length>0){var h1=new bb("onspotmouseout");h1.spots=hV.slice(0);hS.dispatchEvent(h1)}if(hS.temp.curSpotsArray.length===0){var h5=null;if(hS.getZoom()>=17){h5=hQ.checkAreaSpot(h2.point)}if(h5){if(hS.platform.style.cursor!=="pointer"){hS.platform.style.cursor="pointer"}hS.temp.curAreaSpot=h5}else{if(hS.platform.style.cursor!==hS.config.defaultCursor){hS.platform.style.cursor=hS.config.defaultCursor}hS.temp.curAreaSpot=null}}else{if(h4.length>0){var h1=new bb("onspotmouseover");if(hS.temp.curSpots[hS.temp.curSpots.length-1].enableMultiResponse){h1.spots=h4.slice(0)}else{h4.sort(function(h9,h8){return h9._distance-h8._distance});h1.spots=h4.slice(0,1)}if(h2.point){h1.point=new hr(h2.point.lng,h2.point.lat)}h1.pixel=new ej(h2.pixel.x,h2.pixel.y);hS.dispatchEvent(h1)}}}});hS.addEventListener("click",function(hZ){var hX=this.temp;if(hZ.overlay&&!(hZ.overlay instanceof aR)){return}if(!hZ.point){return}if(C.Platform.iphone||C.Platform.ipad||C.Platform.android){hX.curSpotsArray=hQ.getSpotsByScreenPosition(hZ.pixel)}var hY=new bb("onspotclick");hY.point=new hr(hZ.point.lng,hZ.point.lat);hY.pixel=new ej(hZ.pixel.x,hZ.pixel.y);if(hX.curSpotsArray.length>0){for(var hW=0,hT=hX.curSpots.length;hW<hT;hW++){if(hX.curSpots[hW].spots&&hX.curSpots[hW].spots.length>0){if(hX.curSpots[hW].enableMultiResponse){hY.spots=hX.curSpotsArray.slice(0)}else{hX.curSpotsArray.sort(function(h2,h1){return h2._distance-h1._distance});hY.spots=hX.curSpotsArray.slice(0,1)}break}}}var hV=hY.spots||[];for(var hW=0;hW<hV.length;hW++){var hU=hV[hW].pt;var h0=hQ.checkAreaSpot(hU);if(h0){hX.curAreaSpot=h0}}hY.curAreaSpot=hX.curAreaSpot;this.dispatchEvent(hY)});hS.addEventListener("rightclick",function(hU){if(hU.overlay&&!(hU.overlay instanceof aR)){return}if(!hU.point){return}var hT=new bb("onhotspotrightclick");hT.point=new hr(hU.latlng.lng,hU.latlng.lat);hT.mct=new hr(hU.point.lng,hU.point.lat);hT.pixel=new ej(hU.pixel.x,hU.pixel.y);if(f.environment==="customEditor"){hT.styleIds=hQ.checkStyleAreaSpot(hU.point)}this.dispatchEvent(hT)})};dh.prototype.getSpotsByScreenPosition=function(hS){var hZ=[];var e=this._map;var hU=e.getTilt();if(!e.spotsPool){return hZ}for(var hQ in e.spotsPool){var hX=e.spotsPool[hQ];var hV=hX.spots.slice(0);if(hV[0]&&hV[0].userdata&&hV[0].userdata.mapPoi&&e._displayOptions.poi===false){continue}e.temp.curSpots[hX.zIndex]={spots:[],enableMultiResponse:hX.enableMultiResponse};for(var hT=0,hR=hV.length;hT<hR;hT++){var hY=hV[hT];if(hY.lr&&(e.getZoom()<hY.lr[0]||e.getZoom()>hY.lr[1])){continue}var T=hY.px||e.pointToPixelIn(hY.pt);if(T.x<e.width&&T.y<e.height){if((hS.x-T.x<hY.bd[2]&&hS.x-T.x>hY.bd[0])&&(T.y-hS.y<hY.bd[3]&&T.y-hS.y>hY.bd[1])){if(hU>55){var hW=e.pointToOverlayPixelIn(hY.pt);if(hW.outOfFrustum){continue}}e.temp.curSpots[hX.zIndex].spots.push(hY);hY._distance=gV(T,hS);hZ.push(hY)}}}}return hZ};dh.prototype.checkAreaSpot=function(e){if(!e){return null}var T=this._map;if(T._displayOptions.indoor===false){return null}for(var hQ in T.areaSpots){var i=T.areaSpots[hQ];if(dg([e.lng,e.lat],i.spot)){return hQ}}return null};dh.prototype.checkStyleAreaSpot=function(T){if(!T){return null}var hR=this._map;var i=[];for(var hS in hR.areaSpots){var hQ=hR.areaSpots[hS];var e=hQ.userData;if(e.type==="mapstyle"&&dg([T.lng,T.lat],hQ.spot)){i.push([e.styleId])}}return i};dh.prototype.reset=function(){var e=this._map;if(e.temp.__dragged==true){e.temp.__dragged=false}else{e.temp.curSpots=[];e.platform.style.cursor=e.config.defaultCursor}};dh.prototype.resetAreaSpot=function(){for(var T in this.areaSpots){var i=this.areaSpots[T];var e=i.userData;if(e.type==="mapstyle"){delete this.areaSpots[T]}}};bo.register(function(e){e._spotsMgr=new dh(e)});');
﻿_jsload&&_jsload('infowindow', '(function(i){var hR=i.Utils;var hQ=hR.format;var e={DEBUG:true,PREFIX:"BMap_bubble",WINDOWOFFSET:[25,-8],POPSTYLE:"padding:0 8px; position:absolute; display:none; cursor:default; border:1px solid #ddd;background-color:#fff;border-radius:10px;",TOPSTYLE:"height:31px",TITLESTYLE:"line-height:30px;display:block;overflow:hidden;height:30px;white-space:nowrap;color:#333;",BUTTONSSTYLE:"float:right;position:absolute;top:-2px;right:0px;height:30px;",CENTERSTYLE:"z-index:3; position:relative;",CONTENTSTYLE:"display:block; font-size:14px; line-height: 24px; position:absolute; top: 2px; color:#555",BOTTOMSTYLE:"display:block; z-index:2; position:absolute;"};var hS="";e.closeButtonImg=e3.imgPath+"iw_close.gif";e.tailImg=bd_map_cfg.host_dir+"img/iw_tail.png";e.plusImg=e3.imgPath+"iw_plus.gif";e.minusImg=e3.imgPath+"iw_minus.gif";e.blankImg=e3.imgPath+"blank.gif";e.popWindowShadowImg=bd_map_cfg.host_dir+"img/iws3.png";e.infoWindowDomTemplate=hQ([\'<div class="{PREFIX}_pop" style="{POPSTYLE}">\',\'<div class="{PREFIX}_top" style="{TOPSTYLE}">\',\'<div class="{PREFIX}_title" style="{TITLESTYLE}">\',"</div>",\'<div class="{PREFIX}_buttons" style="{BUTTONSSTYLE}">\',"</div>","</div>",\'<div class="{PREFIX}_center" style="{CENTERSTYLE}">\',\'<div class="{PREFIX}_content" style="{CONTENTSTYLE}">\',"</div>","</div>",\'<div class="{PREFIX}_bottom" style="{BOTTOMSTYLE}">\',"</div>","</div>"],e);function T(hW,hU){for(var hV=0,hT=hW.length;hV<hT;++hV){if(hW[hV].className===e.PREFIX+"_"+hU){return hW[hV]}}throw Error("Fatal Error:"+hU+" is not exists in InfoWindow DOM!")}e.infoWindowShadowDomTemplate=(function(){var hT=11;var hV=[\'<div class="shadow" style="position: absolute;display:none" type="infowindow_shadow">\'];for(var hU=0;hU<hT;++hU){hV.push(\'<div><img onmousedown="{onmousedown}" style="{shadowDim};position:absolute;{s\'+hU+\'}" src="{src}"/></div>\')}hV.push("</div>");return hQ(hV,{onmousedown:"return false;",shadowDim:"width:1144px;height:370px"})})();C.extend(an.prototype,{initialize:function(hU){var hV=this.map=hU.map;hV._asyncRegister();this.overlay=hU;this.render();this._bind();if(this._config.enableMaximize){this.enableMaximize()}else{this.disableMaximize()}this.setTitle();this.setContent();if(this._config.ifMaxScene){this.setMaxScene(true)}this.redraw(null,true);var hT=hV.infoWindowDoms;if(hT){if(hU.toString()==="Marker"){hT.marker=hU}else{hT.marker=null}}},render:function(){var hV=this.map;var h2=this;var hZ=hV.infoWindowDoms;if(!hZ){hZ=hV.infoWindowDoms={};hV.infoWindow=hV.infoWindowDoms;var hY=[hQ(e.infoWindowShadowDomTemplate,{src:e.popWindowShadowImg,s0:"left:-323px;top:0px;",s1:"left:-393px;top:0px;",s2:"left:-1033px;top:0px;",s3:"top:-30px;",s4:"left:-360px;top:-30px;",s5:"top:-30px;",s6:"left:-14px;top:-310px;",s7:"left:-255px;top:-310px;",s8:"left:-440px;top:-310px;",s9:"left:-255px;top:-310px;",s10:"left:-754px;top:-310px;"}),e.infoWindowDomTemplate].join("");dI(hV.platform,hY);if(hV.platform.lastChild.className===""){hV.platform.removeChild(hV.platform.lastChild)}hZ.popDom=hV.platform.lastChild;hZ.shadowDom=hZ.popDom.previousSibling;var hU=hZ.popDivs=hZ.popDom.getElementsByTagName("DIV");hZ.shadowDivs=hZ.shadowDom.getElementsByTagName("DIV");hZ.contentMain=T(hU,"content");hZ.contentDiv=T(hU,"content");hZ.centerDiv=T(hU,"center");hZ.buttonsDiv=T(hU,"buttons");hZ.titleDiv=T(hU,"title");hZ.bottomDiv=T(hU,"bottom");hZ.maxContentDiv=dI(hZ.contentMain,\'<div class="BMap_bubble_max_content" style="display:none;position:relative"></div>\');var h4=hZ.buttonsDiv;var h3=hQ([\'<div style="cursor:pointer">\',\'<div style="position:absolute;top:{top};width:{width};height:{height};\',\'-moz-user-select:none;cursor:pointer;z-index:10000;display:none"/>&times</div>\',"</div>"],{top:"9px",right:"24px",width:"10px",height:"10px",src:e.plusImg});hZ.maxButton=dI(h4,h3);var h1=20;var h5=hQ([\'<div style="cursor:pointer;width:{width};height:{height};color:{color}">\',\'<div style="position:absolute;top:{top};right:{right};text-align:center;line-height:{height};\',\'-moz-user-select:none;cursor:pointer;z-index:10000;font-size:{fontSize}"/>&times</div>\',"</div>"],{top:"2px",right:"12px",width:"32px",height:"30px",fontSize:h1+"px",color:"#ccc"});hZ.closeButton=dI(h4,h5);var hW="";var hT=e.tailImg;var hX=hQ(["<img ",\'style="z-index:1;position:absolute;\',"width:{width};height:{height};left:{left};bottom:{bottom};",\'{filter}" src="{src}" />\'],{src:hT,left:"107px",bottom:"-30px",width:"58px",height:"31px",filter:hW});var h0=hZ.tail=dI(hZ.popDom,hX)}hZ.hashCode=hZ.popDom.hashCode=this.hashCode},_bind:function(){var h0=this;var hT=h0.map;var hY=hT.infoWindowDoms;var hU=hY.closeButton;var h2=hY.popDom;var hV=function(h3){if(h0.hide()===true){h0.dispatchEvent(new bb("onclickclose"))}db(h3)};hU.addEventListener("touchstart",function(h3){db(h3)});hU.addEventListener("click",hV);var h1=function(h3){this.style.color="#ccc"};var hX=function(h3){this.style.color="#6DA1EA"};hU.onmouseover=hX;hU.onmouseout=h1;var hW=["mousedown","mouseout","mouseover","click","keydown","selectstart"];C.each(hW,function(h3){C.on(h2,h3,h)});C.on(h2,"dblclick",db);C.on(h2,"contextmenu",db);if(window.addEventListener){h2.addEventListener("DOMMouseScroll",h,false)}var hZ=function(h4){var h3=h0.map.infoWindowDoms.maxButton;if(!h0.isWinMax){h0.maximize()}else{h0.restore()}db(h4)};hY.maxButton.onclick=hZ;if(C.Platform.iphone||C.Platform.ipad||C.Platform.android){C.on(hU,"touchend",hV);C.on(hY.maxButton,"touchend",hZ)}h2=hU=hY=null},_setWinSize:function(h2,h1){var ic=this._config;h2=h2||ic.width;h1=h1||ic.height;if(h1<0){h1=0}var hW=ic.offset.width;var h0=ic.offset.height;var ib=[25,-1,25,-1,25,-1,25,34];var hV=[25,-1,25,-1,25,-1,25,50];ib[1]=h2-ib[0]-ib[2];if(C.isIE&&document.compatMode!=="CSS1Compat"){ib[3]=h2}else{ib[3]=h2-2}ib[5]=h2-ib[4]-ib[6];hV[1]=hV[0];hV[3]=h1-hV[0]-hV[4];if(C.isIE&&document.compatMode!=="CSS1Compat"){hV[5]=hV[4]}else{hV[5]=hV[4]-1}var id=[0,ib[0],h2-ib[2],0,0,ib[4],h2-ib[6],Math.ceil((h2-ib[7])/2)];var h8=[0,0,0,ib[0],h1-ib[4],h1-ib[4],h1-ib[4],h1-ib[4]];var hU=this._allPopLeft=hW-Math.round((h2-ib[7])/2);var h9=this._allPopTop=h0-h1-24;var ie=Math.floor((h1+hV[7])/2.03)+30;var hY=[70,-1,70,-1,-1,-1,50,-1,140,-1,70];var h6=[30,30,30,25,25,25,60,60,60,60,60];hY[7]=Math.round((h2+80-(hY[6]+hY[8]+hY[10])-50)/2);hY[9]=hY[7]+50;var ia=hY[6]+hY[7]+hY[8]+hY[9]+hY[10];hY[1]=ia-hY[0]-hY[2]-29;hY[5]=hY[3]=ie-h6[0]-h6[6]+70;h6[3]=h6[4]=h6[5]=ie-h6[0]-h6[6];hY[4]=(hY[0]+hY[1]+hY[2]+h6[3]+29)-hY[5]-hY[3];var hT=[ie-60-1,ie-60-1+hY[0],ie-60-1+hY[0]+hY[1],29,29+hY[3],29+hY[3]+hY[4],0,hY[6],hY[6]+hY[7],hY[6]+hY[7]+hY[8],hY[6]+hY[7]+hY[8]+hY[9]];var h5=[0,0,0,h6[0],h6[0],h6[0],h6[0]+h6[3],h6[0]+h6[3],h6[0]+h6[3],h6[0]+h6[3],h6[0]+h6[3]];this._allShadowLeft=hW-hY[6]-hY[7]-70;this._allShadowTop=h0-ie+30;var hX=323-ie+90;var h7=740+hX;var h3=function(ig){return"overflow: hidden; z-index: 1; position: absolute;left:"+hT[ig]+"px;top:"+h5[ig]+"px;width:"+hY[ig]+"px;height:"+h6[ig]+"px;"};var hZ=this.map.infoWindowDoms;if(hZ&&hZ.shadowDivs){for(var h4=0;h4<hZ.shadowDivs.length;h4++){hZ.shadowDivs[h4].style.cssText=h3(h4)}hZ.shadowDivs[3].firstChild.style.left="-"+hX+"px";hZ.shadowDivs[5].firstChild.style.left="-"+h7+"px"}this.setPosition()},setWidth:function(hT){hT=hT*1;if(!hT&&hT!==0||isNaN(hT)||hT<0){return}if(hT!==0){if(hT<220){hT=220}if(hT>730){hT=730}}this._config.width=hT;if(this._isMyDom()&&this.isOpen()){var hU=this;this.redraw(function(){hU.setPanToWithDelay()})}},setHeight:function(hT){hT=hT*1;if(!hT&&hT!==0||isNaN(hT)||hT<0){return}if(hT!==0){if(hT<60){hT=60}if(hT>650){hT=650}}this._config.height=hT;var hV=this.map;if(this._isMyDom()&&this.isOpen()){if(this._config.width!==0){hV.infoWindowDoms.contentDiv.style.width=this._config.width+"px"}var hU=this;this.redraw(function(){hU.setPanToWithDelay()})}},setMaxWidth:function(hT){hT=hT*1;if(!hT&&hT!==0||isNaN(hT)||hT<0){return}if(hT!==0){if(hT<220){hT=220}if(hT>730){hT=730}}this._config.maxWidth=hT;if(this.isWinMax){this.redraw()}},setTitle:function(hV){var hU=this.map;if(hV===""){this._config.title=""}hV=hV||this._config.title;if(!this._isMyDom()){return}var hT=hU.infoWindowDoms.titleDiv;hT.innerHTML=hV;C.show(hT)},setContent:function(hV){hV=hV||this.content;var hW=this.map;this.content=hV;if(!this._isMyDom()){return}if(this.isWinMax){return}var hU=hW.infoWindowDoms.contentDiv;var hT=hW.infoWindowDoms.maxContentDiv;if("[object String]"===Object.prototype.toString.call(hV)){hU.innerHTML=hV}else{hU.innerHTML="";hU.appendChild(hV)}if(this._config.width!==0){hU.style.width=this._config.width+"px"}hT.style.display="none";hU.style.display=""},setMaxContent:function(hU){if(!hU){hU=this._config.maxContent}else{this._config.maxContent=hU}var hV=this.map;if(!this._isMyDom()){return}var hT=hV.infoWindowDoms;hT.maxContentDiv.innerHTML=hU;if(!this.isWinMax){return}hT.contentDiv.style.display="none";hT.maxContentDiv.style.display=""},redraw:function(h5,h1){if(!this._isMyDom()){return}if(!h1&&!this.isOpen()){return}h5=h5||function(){};var hX=this;var h0=100;var hY=hX.map.infoWindowDoms;var hW=0;var hZ=7;var h4=20;if(C.Platform.iphone||C.Platform.android){hZ=-1;h4=25}if(this.isWinMax){var h3=hX._config.maxWidth;function hT(){var h8=hW+hY.maxContentDiv.scrollHeight;h8=h8>hX.map.height?hX.map.height-60:h8;h3=h3<220?220:h3;h3=h3>600?600:h3;h8=h8<55?55:h8;h8=h8>440?440:h8;hX._setWinSize(h3+32,h8+32);hY.contentMain.style.width=h3+"px";hY.contentMain.style.height=h8+"px";hY.closeButton.style.left=h3+hZ+"px";hY.maxButton.style.left=h3-h4+hZ+"px";hY.contentMain.style.overflow="hidden";hY.titleDiv.style.width=h3+"px";hY.centerDiv.style.width=h3+"px";hY.popDom.style.width=h3+"px";hY.centerDiv.style.height=h8+"px";hY.tail.style.left=(Math.round(h3/2)-parseInt(hY.tail.style.width,10)/2)+"px";hY.bottomDiv.style.width=h3+"px";hX.dispatchEvent(new bb("onresize"));hX.setPanToWithDelay();h5()}if(this.isOpen()){hT()}else{setTimeout(hT,h0)}}else{var h7=hY.contentDiv.style;var h2=hY.titleDiv.style;var hU=hY.contentMain.style;h7.width=hU.width="auto";h7.height=hU.height="auto";h7.whiteSpace="nowrap";if(hY.popDom.style.display==="none"){hY.popDom.style.visibility="hidden";hY.shadowDom.style.visibility="hidden";this.show()}var h3=hY.contentMain.scrollWidth||0;h3=hX._config.width===0?h3:hX._config.width;h3=h3<220?220:h3;h3=h3>600?600:h3;hU.width=(h3-12)+"px";var hV;hV=hY.contentMain.scrollHeight||0;hV=hX._config.height===0?hV:hX._config.height;hX._setWinSize(h3+32,hV+32);function h6(){h7.whiteSpace="";hU.overflowX=(hX._config.width===0)?"hidden":"auto";hU.overflowY=(hX._config.height===0)?"hidden":"auto";hV=hY.contentMain.scrollHeight||0;hV=hX._config.height===0?hV:hX._config.height;hV=hV<55?55:hV;hV=hV>440?440:hV;hX._setWinSize(h3+32,hV+32);hY.popDom.style.visibility="";hY.shadowDom.style.visibility="";hU.height=hV+"px";hY.centerDiv.style.height=hV+"px";hY.tail.style.left=(Math.round(h3/2)-parseInt(hY.tail.style.width,10)/2)+"px";hY.tail.style.top=hV+32+"px";hY.bottomDiv.style.width=h3+"px";hY.titleDiv.style.width=h3+"px";hY.centerDiv.style.width=h3+"px";hY.popDom.style.width=h3+"px";hX.dispatchEvent(new bb("onresize"));hX.setPanToWithDelay();h5()}if(this.isOpen()){h6()}else{setTimeout(h6,h0)}}},setPosition:function(hX,hY){if(!this._isMyDom()){return}var hT=this.map.infoWindowDoms;var hU=this.overlay;var hW=this.map.pointToOverlayPixelIn(hU.getPoint(),{zoom:hY,center:hX});var hV=hU.getIcon();var hZ=new ej(hW.x-hV.offset.width+hV.infoWindowOffset.width+hU.getOffset().width,hW.y-hV.offset.height+hV.infoWindowOffset.height+hU.getOffset().height);hT.popDom.style.left=this._allPopLeft+hZ.x+e.WINDOWOFFSET[0]+"px";hT.popDom.style.top=this._allPopTop+hZ.y+e.WINDOWOFFSET[1]+"px";hT.shadowDom.style.left=this._allShadowLeft+hZ.x-2+"px";hT.shadowDom.style.top=this._allShadowTop+hZ.y-15+"px"},setPanToWithDelay:function(hT){var hU=this;setTimeout(function(){hU.setPanTo()},hT||200)},setPanTo:function(){if(!this.overlay||!this.overlay.getPoint()||!this._config.enableAutoPan||!this._isMyDom()){return}var h9=this.map;var h1=h9.infoWindowDoms;var hV=h1.popDivs;var ia=h1.popDom;if(!hV||!ia){return}var hW=parseInt(T(hV,"content").style.width,10)+2;var h6=parseInt(C.Dom.getComputedStyle(T(hV,"top"),"height"),10)+parseInt(C.Dom.getComputedStyle(T(hV,"center"),"height"),10)+parseInt(C.Dom.getComputedStyle(T(hV,"bottom"),"height"),10);var h4=parseFloat(ia.style.left,10);var hY=parseFloat(ia.style.top,10);if(this.map._renderType==="webgl"){h4+=parseInt(this.map.platform.style.left,10);hY+=parseInt(this.map.platform.style.top,10)}else{h4+=this.map.offsetX;hY+=this.map.offsetY}var h0=new ej(h4,hY);var hZ=new ej(hW+h4,h6+hY);var h7;var h5;if(this._config.height!==0&&document.all){if(!h9.temp.infoKey){h9.temp.infoKey=-1}h7=-h9.temp.infoKey;h9.temp.infoKey=-h9.temp.infoKey}h7=0;h5=0;var hT=10;var hU=this._config.margin[0];var hX=this._config.margin[1];var h8=this._config.margin[2];var h2=this._config.margin[3];if(h0.x<h2){h7=-h0.x+h2}if(h0.y<hU){h5=-h0.y+hU}if(hZ.x>h9.width-hX){h7=h9.width-hZ.x-hX}if(hZ.y>h9.height-h8){h5=h9.height-hZ.y-h8}this._loadCollisions();var h3=this._config.collisions;if(h0.x<h3[0][0]&&h0.y<h3[0][1]){if(Math.abs(-h0.x+h3[0][0])<Math.abs(-h0.y+h3[0][1])){h7=-h0.x+h3[0][0]}else{if(h9.height-h3[0][1]-h3[3][1]<h6){h7=-h0.x+h3[0][0]}else{h5=-h0.y+h3[0][1]}}if(h9.width-h3[0][0]-h3[1][0]<hW&&h0.y<h3[1][1]){h5=-h0.y+h3[1][1]}}if(hZ.x>h9.width-h3[1][0]&&h0.y<h3[1][1]){if(Math.abs(-hZ.x+h9.width-h3[1][0])<Math.abs(-h0.y+h3[1][1])&&h9.width-h3[0][0]-h3[1][0]>=hW){h7=-hZ.x+h9.width-h3[1][0]}else{h5=-h0.y+h3[1][1];if(h9.width-h3[0][0]-h3[1][0]<hW&&h9.width-h3[0][0]<hW){h7=-h0.x+h3[0][0]}}}if(h0.x<h3[3][0]&&hZ.y>h9.height-h3[3][1]){if(Math.abs(-h0.x+h3[3][0])<Math.abs(-hZ.y+h9.height-h3[3][1])&&(Math.abs(-h0.x+h3[3][0])<Math.abs(h5)&&h5!==0||h5===0)&&h9.width-h3[3][0]>=hW){h7=-h0.x+h3[3][0]}else{h5=-hZ.y+h9.height-h3[3][1]}if(h9.height-h3[0][1]-h3[3][1]<h6&&h0.x<h3[0][0]){h7=-h0.x+h3[0][0]}}if(hZ.x>h9.width-h3[2][0]&&hZ.y>h9.height-h3[2][1]){if(Math.abs(-hZ.x+h9.width-h3[2][0])<Math.abs(-hZ.y+h9.height-h3[2][1])&&(Math.abs(-hZ.x+h9.width-h3[2][0])<Math.abs(h5)&&h5!==0||h5===0)&&h9.width-h3[0][0]-h3[1][0]>=hW){h7=-hZ.x+h9.width-h3[2][0]}else{if(h9.height-h3[1][1]-h3[2][1]>=h6){h5=-hZ.y+h9.height-h3[2][1]}else{h5=-h0.y+h3[1][1]}if(h9.width-h3[0][0]-h3[2][0]<hW){h7=-h0.x+h3[0][0]}}}if(h7!==0||h5!==0){h9.panBy(h7,h5,{point:this.getPointIn()})}},_loadCollisions:function(){if(!this.map){return}var hU=this.map;this._config.collisions=[[10,10],[10,10],[10,10],[10,10]];var h3=this.map.container;for(var h1=0,hV=h3.children.length;h1<hV;h1++){var hY;var h4;var h7=!!(typeof h3.children[h1]._anchor!=="undefined"&&h3.children[h1]._offset);if(h3.children[h1]._jsobj&&h3.children[h1]._jsobj instanceof a7&&h3.children[h1]._jsobj.blockInfoWindow===true){hY=h3.children[h1]}else{if(h7){hY=h3.children[h1]}else{continue}}var h5=hY.offsetWidth;var h2=hY.offsetHeight;var hT=hY._jsobj;var hX;var h0;if(!hT||h7){if(typeof hY._anchor!=="undefined"&&hY._offset&&fY(hY).display!=="none"&&fY(hY).visibility!=="hidden"){hX=hY._offset;h0=hY._anchor}else{continue}}else{if(hT.isVisible()===false){continue}hX=hT.getOffset();h0=hT.getAnchor()}switch(h0){case BMAP_ANCHOR_TOP_LEFT:h4=0;break;case BMAP_ANCHOR_TOP_RIGHT:h4=1;break;case BMAP_ANCHOR_BOTTOM_LEFT:h4=3;break;case BMAP_ANCHOR_BOTTOM_RIGHT:h4=2;break;default:break}var hZ=h5+hX.width+10;var hW=h2+hX.height+10;var h6=this._config.collisions[h4];this._config.collisions[h4]=[hZ>h6[0]?hZ:h6[0],hW>h6[1]?hW:h6[1]]}},enableMaximize:function(){this._config.enableMaximize=true;if(this._isMyDom()){this.map.infoWindowDoms.maxButton.style.display="block"}},disableMaximize:function(){this._config.enableMaximize=false;if(this._isMyDom()){this.map.infoWindowDoms.maxButton.style.display="none"}},show:function(){if(!this._isMyDom()){return}var hU=this.map.infoWindowDoms;if(hU.popDom.style.display!=="none"){return}C.show(hU.popDom);C.show(hU.shadowDom);var hT=new bb("onopen");hT.point=this.getPoint();this.dispatchEvent(hT);this.redraw()},hide:function(){if(!this._isMyDom()){return false}var hU=this.map.infoWindowDoms;if(hU.popDom.style.display==="none"){return false}if(this._config.onClosing()===false){return false}C.hide(hU.popDom);C.hide(hU.shadowDom);if(this.isWinMax){this.isWinMax=false;hU.maxContentDiv.style.display="none";hU.contentDiv.style.display="";hU.maxButton.src=e.plusImg}var hT=new bb("onclose");hT.point=this.getPoint();this.dispatchEvent(hT);this.map.removeEventListener("click",this.map.temp._clickCloseHandler);this.map.temp._clickCloseBinded=false;this.decontrol();return true},maximize:function(){if(!this.map||!this.isOpen()||!this._config.enableMaximize||this.isWinMax){return}if(!this._isMyDom()){return}var hU=this.map.infoWindowDoms.maxButton;var hT=this;hT.isWinMax=true;hU.src=e.minusImg;hT.setMaxContent();hT.map.infoWindowDoms.maxContentDiv.style.display="block";hT.redraw();hT.dispatchEvent(new bb("onmaximize"));hT.setPanToWithDelay()},restore:function(){if(!this.map||!this.isOpen()||!this.isWinMax){return}if(!this._isMyDom()){return}this.isWinMax=false;var hT=this;var hU=hT.map.infoWindowDoms.maxButton;hU.src=e.plusImg;hT.setContent();hT.map.infoWindowDoms.maxContentDiv.style.display="none";hT.redraw();hT.dispatchEvent(new bb("onrestore"));hT.setPanToWithDelay()},_revert:function(){if(!this._isMyDom()){return}this.isWinMax=false;var hT=this.map.infoWindowDoms;hT.titleDiv.innerHTML="";hT.contentDiv.innerHTML="";hT.maxContentDiv.innerHTML="";hT.maxButton.src=e.plusImg},_setOverflow:function(){var hV=this.map;if(!this._isMyDom()){return}var hU=hV.infoWindowDoms;var hT=hU.contentMain.style;hU._overflowX=hT.overflowX;hU._overflowY=hT.overflowY;hT.overflowX="hidden";hT.overflowY="hidden"},_resetOverflow:function(){var hV=this.map;if(!this._isMyDom()||!hV.infoWindowDoms._overflowX||!hV.infoWindowDoms._overflowY){return}var hU=hV.infoWindowDoms;var hT=hU.contentMain.style;hT.overflowX=hU._overflowX;hT.overflowY=hU._overflowY;delete hU._overflowX;delete hU._overflowY},isOpen:function(){if(!this.map){return false}var hT=this.map.temp.infoWin;if(!hT){return false}if(!this._isMyDom()){return false}if(hT&&hT.overlay===this.overlay&&this.map.infoWindowDoms&&this.map.infoWindowDoms.popDom.style.display==="none"){return false}else{return true}},setMaxScene:function(hU){var hV=this;if(!this._isMyDom()){return}var hT=hV.map.infoWindowDoms;hT.maxButton.style.display="block";var hW=hT.maxButton;if(!!hU===!!this.isWinMax){return}if(hU){hV.isWinMax=true;hW.src=e.minusImg;hV.setMaxContent();hT.maxContentDiv.style.display="block"}else{hV.isWinMax=false;hW.src=e.plusImg;hV.setContent();hT.maxContentDiv.style.display="none"}this.redraw()},_draw:function(){if(this._visible===true&&this.overlay){this.overlay.openInfoWindow(this)}},_isMyDom:function(){return(this.map&&this.map.infoWindowDoms&&this.map.infoWindowDoms.hashCode===this.hashCode)}});cV.prototype.openInfoWindow=function(hW){if(this.map&&this.map.temp&&this.map.temp.infoWin instanceof i.SimpleInfoWindow){this.map.closeSimpleInfoWindow()}var hV=this.map;if(!hW||!this.map||!this.domElement||this.isVisible()===false||hW.toString()!=="InfoWindow"){return}var hU=hV.temp;if(hU.infoWin&&hU.infoWin.overlay&&hU.infoWin.overlay._fromMap){hV.closeInfoWindow()}if(hU.infoWin===hW&&hU.infoWin.isOpen()&&hU.infoWin.overlay===this){hW.setPanToWithDelay();return}hV.closeInfoWindow();this.infoWindow=hW;if(hU.infoWin==null||hU.infoWin!==hW){if(hV.infoWindowDoms){hV.infoWindowDoms.closeButton.onclick=null;hV.infoWindowDoms.maxButton.onclick=null}hU.infoWin=hW;hW.initialize(this)}else{hW.redraw(null,true)}C.BaseClass.call(hW,hW.hashCode);if(!hU._clickCloseHandler){hU._clickCloseHandler=function(hX){if(hX.overlay||(hX.spots&&hX.spots.length>0)){return}if(hV.temp.infoWin&&hV.temp.infoWin._config.enableCloseOnClick){hV.closeInfoWindow();hV.removeEventListener("spotclick",hU._clickCloseHandler);hU._clickCloseBinded=false}}}if(!hU._clickCloseBinded){setTimeout(function(){hV.addEventListener("spotclick",hU._clickCloseHandler);hU._clickCloseBinded=true},200)}if(hU._infoWin){delete hU._infoWin}hW.overlay=this;var hT=hV.infoWindowDoms;this.map.getPanes().floatPane.appendChild(hT.popDom);this.map.getPanes().floatShadow.appendChild(hT.shadowDom);hW.setPanToWithDelay();this.dispatchEvent(new bb("oninfowindowopen"))};cV.prototype.closeInfoWindow=function(){if(!this.map||!this.map.infoWindowDoms){return}var hU=this;if(hU.infoWindow&&hU.infoWindow.hashCode===hU.map.infoWindowDoms.hashCode){try{if(hU.infoWindow.hide()===true){hU.dispatchEvent(new bb("oninfowindowclose"));if(hU.map){hU.map.temp.infoWin=null}hU.infoWindow=null}}catch(hT){}}}})(bo);');